<!doctype html>
<!--
  Copyright © 2025 Martin Fish
  All Rights Reserved

  This software and associated documentation files are proprietary and confidential.
  Unauthorized copying, distribution, modification, or use of this software,
  via any medium, is strictly prohibited without express written permission.
-->
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#4c1d95" />
    <link rel="manifest" href="./manifest.webmanifest" />
    <link rel="apple-touch-icon" href="./icons/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="./icons/icon-192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="./icons/icon-512.png" />
    <title>ClassSeats — New UI</title>
    <script type="module" crossorigin>(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();function tg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ku={exports:{}},di={},Yu={exports:{}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bo=Symbol.for("react.element"),ng=Symbol.for("react.portal"),sg=Symbol.for("react.fragment"),rg=Symbol.for("react.strict_mode"),og=Symbol.for("react.profiler"),lg=Symbol.for("react.provider"),ig=Symbol.for("react.context"),ag=Symbol.for("react.forward_ref"),cg=Symbol.for("react.suspense"),dg=Symbol.for("react.memo"),ug=Symbol.for("react.lazy"),Sd=Symbol.iterator;function fg(e){return e===null||typeof e!="object"?null:(e=Sd&&e[Sd]||e["@@iterator"],typeof e=="function"?e:null)}var Qu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ju=Object.assign,Xu={};function Ar(e,t,n){this.props=e,this.context=t,this.refs=Xu,this.updater=n||Qu}Ar.prototype.isReactComponent={};Ar.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ar.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Zu(){}Zu.prototype=Ar.prototype;function ac(e,t,n){this.props=e,this.context=t,this.refs=Xu,this.updater=n||Qu}var cc=ac.prototype=new Zu;cc.constructor=ac;Ju(cc,Ar.prototype);cc.isPureReactComponent=!0;var Nd=Array.isArray,qu=Object.prototype.hasOwnProperty,dc={current:null},ef={key:!0,ref:!0,__self:!0,__source:!0};function tf(e,t,n){var r,o={},l=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(l=""+t.key),t)qu.call(t,r)&&!ef.hasOwnProperty(r)&&(o[r]=t[r]);var a=arguments.length-2;if(a===1)o.children=n;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)o[r]===void 0&&(o[r]=a[r]);return{$$typeof:Bo,type:e,key:l,ref:i,props:o,_owner:dc.current}}function pg(e,t){return{$$typeof:Bo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function uc(e){return typeof e=="object"&&e!==null&&e.$$typeof===Bo}function mg(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var jd=/\/+/g;function Ti(e,t){return typeof e=="object"&&e!==null&&e.key!=null?mg(""+e.key):t.toString(36)}function yl(e,t,n,r,o){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(l){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Bo:case ng:i=!0}}if(i)return i=e,o=o(i),e=r===""?"."+Ti(i,0):r,Nd(o)?(n="",e!=null&&(n=e.replace(jd,"$&/")+"/"),yl(o,t,n,"",function(u){return u})):o!=null&&(uc(o)&&(o=pg(o,n+(!o.key||i&&i.key===o.key?"":(""+o.key).replace(jd,"$&/")+"/")+e)),t.push(o)),1;if(i=0,r=r===""?".":r+":",Nd(e))for(var a=0;a<e.length;a++){l=e[a];var c=r+Ti(l,a);i+=yl(l,t,n,c,o)}else if(c=fg(e),typeof c=="function")for(e=c.call(e),a=0;!(l=e.next()).done;)l=l.value,c=r+Ti(l,a++),i+=yl(l,t,n,c,o);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function tl(e,t,n){if(e==null)return e;var r=[],o=0;return yl(e,r,"","",function(l){return t.call(n,l,o++)}),r}function gg(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Gt={current:null},wl={transition:null},hg={ReactCurrentDispatcher:Gt,ReactCurrentBatchConfig:wl,ReactCurrentOwner:dc};function nf(){throw Error("act(...) is not supported in production builds of React.")}Ue.Children={map:tl,forEach:function(e,t,n){tl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return tl(e,function(){t++}),t},toArray:function(e){return tl(e,function(t){return t})||[]},only:function(e){if(!uc(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ue.Component=Ar;Ue.Fragment=sg;Ue.Profiler=og;Ue.PureComponent=ac;Ue.StrictMode=rg;Ue.Suspense=cg;Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hg;Ue.act=nf;Ue.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Ju({},e.props),o=e.key,l=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,i=dc.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)qu.call(t,c)&&!ef.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Bo,type:e.type,key:o,ref:l,props:r,_owner:i}};Ue.createContext=function(e){return e={$$typeof:ig,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:lg,_context:e},e.Consumer=e};Ue.createElement=tf;Ue.createFactory=function(e){var t=tf.bind(null,e);return t.type=e,t};Ue.createRef=function(){return{current:null}};Ue.forwardRef=function(e){return{$$typeof:ag,render:e}};Ue.isValidElement=uc;Ue.lazy=function(e){return{$$typeof:ug,_payload:{_status:-1,_result:e},_init:gg}};Ue.memo=function(e,t){return{$$typeof:dg,type:e,compare:t===void 0?null:t}};Ue.startTransition=function(e){var t=wl.transition;wl.transition={};try{e()}finally{wl.transition=t}};Ue.unstable_act=nf;Ue.useCallback=function(e,t){return Gt.current.useCallback(e,t)};Ue.useContext=function(e){return Gt.current.useContext(e)};Ue.useDebugValue=function(){};Ue.useDeferredValue=function(e){return Gt.current.useDeferredValue(e)};Ue.useEffect=function(e,t){return Gt.current.useEffect(e,t)};Ue.useId=function(){return Gt.current.useId()};Ue.useImperativeHandle=function(e,t,n){return Gt.current.useImperativeHandle(e,t,n)};Ue.useInsertionEffect=function(e,t){return Gt.current.useInsertionEffect(e,t)};Ue.useLayoutEffect=function(e,t){return Gt.current.useLayoutEffect(e,t)};Ue.useMemo=function(e,t){return Gt.current.useMemo(e,t)};Ue.useReducer=function(e,t,n){return Gt.current.useReducer(e,t,n)};Ue.useRef=function(e){return Gt.current.useRef(e)};Ue.useState=function(e){return Gt.current.useState(e)};Ue.useSyncExternalStore=function(e,t,n){return Gt.current.useSyncExternalStore(e,t,n)};Ue.useTransition=function(){return Gt.current.useTransition()};Ue.version="18.3.1";Yu.exports=Ue;var d=Yu.exports;const uo=tg(d);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xg=d,vg=Symbol.for("react.element"),bg=Symbol.for("react.fragment"),yg=Object.prototype.hasOwnProperty,wg=xg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Sg={key:!0,ref:!0,__self:!0,__source:!0};function sf(e,t,n){var r,o={},l=null,i=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)yg.call(t,r)&&!Sg.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:vg,type:e,key:l,ref:i,props:o,_owner:wg.current}}di.Fragment=bg;di.jsx=sf;di.jsxs=sf;Ku.exports=di;var s=Ku.exports,da={},rf={exports:{}},on={},of={exports:{}},lf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(h,k){var _=h.length;h.push(k);e:for(;0<_;){var A=_-1>>>1,p=h[A];if(0<o(p,k))h[A]=k,h[_]=p,_=A;else break e}}function n(h){return h.length===0?null:h[0]}function r(h){if(h.length===0)return null;var k=h[0],_=h.pop();if(_!==k){h[0]=_;e:for(var A=0,p=h.length,P=p>>>1;A<P;){var w=2*(A+1)-1,b=h[w],C=w+1,I=h[C];if(0>o(b,_))C<p&&0>o(I,b)?(h[A]=I,h[C]=_,A=C):(h[A]=b,h[w]=_,A=w);else if(C<p&&0>o(I,_))h[A]=I,h[C]=_,A=C;else break e}}return k}function o(h,k){var _=h.sortIndex-k.sortIndex;return _!==0?_:h.id-k.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var i=Date,a=i.now();e.unstable_now=function(){return i.now()-a}}var c=[],u=[],m=1,E=null,S=3,j=!1,L=!1,N=!1,W=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(h){for(var k=n(u);k!==null;){if(k.callback===null)r(u);else if(k.startTime<=h)r(u),k.sortIndex=k.expirationTime,t(c,k);else break;k=n(u)}}function D(h){if(N=!1,v(h),!L)if(n(c)!==null)L=!0,ge(M);else{var k=n(u);k!==null&&ne(D,k.startTime-h)}}function M(h,k){L=!1,N&&(N=!1,x(U),U=-1),j=!0;var _=S;try{for(v(k),E=n(c);E!==null&&(!(E.expirationTime>k)||h&&!Y());){var A=E.callback;if(typeof A=="function"){E.callback=null,S=E.priorityLevel;var p=A(E.expirationTime<=k);k=e.unstable_now(),typeof p=="function"?E.callback=p:E===n(c)&&r(c),v(k)}else r(c);E=n(c)}if(E!==null)var P=!0;else{var w=n(u);w!==null&&ne(D,w.startTime-k),P=!1}return P}finally{E=null,S=_,j=!1}}var G=!1,J=null,U=-1,te=5,ae=-1;function Y(){return!(e.unstable_now()-ae<te)}function ce(){if(J!==null){var h=e.unstable_now();ae=h;var k=!0;try{k=J(!0,h)}finally{k?$e():(G=!1,J=null)}}else G=!1}var $e;if(typeof f=="function")$e=function(){f(ce)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,H=xe.port2;xe.port1.onmessage=ce,$e=function(){H.postMessage(null)}}else $e=function(){W(ce,0)};function ge(h){J=h,G||(G=!0,$e())}function ne(h,k){U=W(function(){h(e.unstable_now())},k)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(h){h.callback=null},e.unstable_continueExecution=function(){L||j||(L=!0,ge(M))},e.unstable_forceFrameRate=function(h){0>h||125<h?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):te=0<h?Math.floor(1e3/h):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(h){switch(S){case 1:case 2:case 3:var k=3;break;default:k=S}var _=S;S=k;try{return h()}finally{S=_}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(h,k){switch(h){case 1:case 2:case 3:case 4:case 5:break;default:h=3}var _=S;S=h;try{return k()}finally{S=_}},e.unstable_scheduleCallback=function(h,k,_){var A=e.unstable_now();switch(typeof _=="object"&&_!==null?(_=_.delay,_=typeof _=="number"&&0<_?A+_:A):_=A,h){case 1:var p=-1;break;case 2:p=250;break;case 5:p=1073741823;break;case 4:p=1e4;break;default:p=5e3}return p=_+p,h={id:m++,callback:k,priorityLevel:h,startTime:_,expirationTime:p,sortIndex:-1},_>A?(h.sortIndex=_,t(u,h),n(c)===null&&h===n(u)&&(N?(x(U),U=-1):N=!0,ne(D,_-A))):(h.sortIndex=p,t(c,h),L||j||(L=!0,ge(M))),h},e.unstable_shouldYield=Y,e.unstable_wrapCallback=function(h){var k=S;return function(){var _=S;S=k;try{return h.apply(this,arguments)}finally{S=_}}}})(lf);of.exports=lf;var Ng=of.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jg=d,rn=Ng;function ue(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var af=new Set,jo={};function Xs(e,t){Pr(e,t),Pr(e+"Capture",t)}function Pr(e,t){for(jo[e]=t,e=0;e<t.length;e++)af.add(t[e])}var qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ua=Object.prototype.hasOwnProperty,kg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,kd={},Cd={};function Cg(e){return ua.call(Cd,e)?!0:ua.call(kd,e)?!1:kg.test(e)?Cd[e]=!0:(kd[e]=!0,!1)}function Eg(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ig(e,t,n,r){if(t===null||typeof t>"u"||Eg(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ht(e,t,n,r,o,l,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=i}var Mt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Mt[e]=new Ht(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Mt[t]=new Ht(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Mt[e]=new Ht(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Mt[e]=new Ht(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Mt[e]=new Ht(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Mt[e]=new Ht(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Mt[e]=new Ht(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Mt[e]=new Ht(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Mt[e]=new Ht(e,5,!1,e.toLowerCase(),null,!1,!1)});var fc=/[\-:]([a-z])/g;function pc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(fc,pc);Mt[t]=new Ht(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(fc,pc);Mt[t]=new Ht(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(fc,pc);Mt[t]=new Ht(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Mt[e]=new Ht(e,1,!1,e.toLowerCase(),null,!1,!1)});Mt.xlinkHref=new Ht("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Mt[e]=new Ht(e,1,!1,e.toLowerCase(),null,!0,!0)});function mc(e,t,n,r){var o=Mt.hasOwnProperty(t)?Mt[t]:null;(o!==null?o.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ig(t,n,o,r)&&(n=null),r||o===null?Cg(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,r=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ss=jg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nl=Symbol.for("react.element"),dr=Symbol.for("react.portal"),ur=Symbol.for("react.fragment"),gc=Symbol.for("react.strict_mode"),fa=Symbol.for("react.profiler"),cf=Symbol.for("react.provider"),df=Symbol.for("react.context"),hc=Symbol.for("react.forward_ref"),pa=Symbol.for("react.suspense"),ma=Symbol.for("react.suspense_list"),xc=Symbol.for("react.memo"),cs=Symbol.for("react.lazy"),uf=Symbol.for("react.offscreen"),Ed=Symbol.iterator;function Kr(e){return e===null||typeof e!="object"?null:(e=Ed&&e[Ed]||e["@@iterator"],typeof e=="function"?e:null)}var xt=Object.assign,Di;function ro(e){if(Di===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Di=t&&t[1]||""}return`
`+Di+e}var Mi=!1;function Ri(e,t){if(!e||Mi)return"";Mi=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var o=u.stack.split(`
`),l=r.stack.split(`
`),i=o.length-1,a=l.length-1;1<=i&&0<=a&&o[i]!==l[a];)a--;for(;1<=i&&0<=a;i--,a--)if(o[i]!==l[a]){if(i!==1||a!==1)do if(i--,a--,0>a||o[i]!==l[a]){var c=`
`+o[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=a);break}}}finally{Mi=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ro(e):""}function Pg(e){switch(e.tag){case 5:return ro(e.type);case 16:return ro("Lazy");case 13:return ro("Suspense");case 19:return ro("SuspenseList");case 0:case 2:case 15:return e=Ri(e.type,!1),e;case 11:return e=Ri(e.type.render,!1),e;case 1:return e=Ri(e.type,!0),e;default:return""}}function ga(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ur:return"Fragment";case dr:return"Portal";case fa:return"Profiler";case gc:return"StrictMode";case pa:return"Suspense";case ma:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case df:return(e.displayName||"Context")+".Consumer";case cf:return(e._context.displayName||"Context")+".Provider";case hc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case xc:return t=e.displayName||null,t!==null?t:ga(e.type)||"Memo";case cs:t=e._payload,e=e._init;try{return ga(e(t))}catch{}}return null}function $g(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ga(t);case 8:return t===gc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function js(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ff(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Tg(e){var t=ff(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(i){r=""+i,l.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function sl(e){e._valueTracker||(e._valueTracker=Tg(e))}function pf(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ff(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function _l(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ha(e,t){var n=t.checked;return xt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Id(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=js(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function mf(e,t){t=t.checked,t!=null&&mc(e,"checked",t,!1)}function xa(e,t){mf(e,t);var n=js(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?va(e,t.type,n):t.hasOwnProperty("defaultValue")&&va(e,t.type,js(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Pd(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function va(e,t,n){(t!=="number"||_l(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var oo=Array.isArray;function Nr(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+js(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,r&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function ba(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ue(91));return xt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $d(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ue(92));if(oo(n)){if(1<n.length)throw Error(ue(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:js(n)}}function gf(e,t){var n=js(t.value),r=js(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Td(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function hf(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ya(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?hf(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var rl,xf=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(rl=rl||document.createElement("div"),rl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=rl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ko(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var fo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dg=["Webkit","ms","Moz","O"];Object.keys(fo).forEach(function(e){Dg.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fo[t]=fo[e]})});function vf(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||fo.hasOwnProperty(e)&&fo[e]?(""+t).trim():t+"px"}function bf(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=vf(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}var Mg=xt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wa(e,t){if(t){if(Mg[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ue(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ue(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ue(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ue(62))}}function Sa(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Na=null;function vc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ja=null,jr=null,kr=null;function Dd(e){if(e=Ho(e)){if(typeof ja!="function")throw Error(ue(280));var t=e.stateNode;t&&(t=gi(t),ja(e.stateNode,e.type,t))}}function yf(e){jr?kr?kr.push(e):kr=[e]:jr=e}function wf(){if(jr){var e=jr,t=kr;if(kr=jr=null,Dd(e),t)for(e=0;e<t.length;e++)Dd(t[e])}}function Sf(e,t){return e(t)}function Nf(){}var _i=!1;function jf(e,t,n){if(_i)return e(t,n);_i=!0;try{return Sf(e,t,n)}finally{_i=!1,(jr!==null||kr!==null)&&(Nf(),wf())}}function Co(e,t){var n=e.stateNode;if(n===null)return null;var r=gi(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ue(231,t,typeof n));return n}var ka=!1;if(qn)try{var Yr={};Object.defineProperty(Yr,"passive",{get:function(){ka=!0}}),window.addEventListener("test",Yr,Yr),window.removeEventListener("test",Yr,Yr)}catch{ka=!1}function Rg(e,t,n,r,o,l,i,a,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(m){this.onError(m)}}var po=!1,Al=null,Ll=!1,Ca=null,_g={onError:function(e){po=!0,Al=e}};function Ag(e,t,n,r,o,l,i,a,c){po=!1,Al=null,Rg.apply(_g,arguments)}function Lg(e,t,n,r,o,l,i,a,c){if(Ag.apply(this,arguments),po){if(po){var u=Al;po=!1,Al=null}else throw Error(ue(198));Ll||(Ll=!0,Ca=u)}}function Zs(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function kf(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Md(e){if(Zs(e)!==e)throw Error(ue(188))}function Og(e){var t=e.alternate;if(!t){if(t=Zs(e),t===null)throw Error(ue(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(o===null)break;var l=o.alternate;if(l===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===l.child){for(l=o.child;l;){if(l===n)return Md(o),e;if(l===r)return Md(o),t;l=l.sibling}throw Error(ue(188))}if(n.return!==r.return)n=o,r=l;else{for(var i=!1,a=o.child;a;){if(a===n){i=!0,n=o,r=l;break}if(a===r){i=!0,r=o,n=l;break}a=a.sibling}if(!i){for(a=l.child;a;){if(a===n){i=!0,n=l,r=o;break}if(a===r){i=!0,r=l,n=o;break}a=a.sibling}if(!i)throw Error(ue(189))}}if(n.alternate!==r)throw Error(ue(190))}if(n.tag!==3)throw Error(ue(188));return n.stateNode.current===n?e:t}function Cf(e){return e=Og(e),e!==null?Ef(e):null}function Ef(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ef(e);if(t!==null)return t;e=e.sibling}return null}var If=rn.unstable_scheduleCallback,Rd=rn.unstable_cancelCallback,Fg=rn.unstable_shouldYield,zg=rn.unstable_requestPaint,St=rn.unstable_now,Bg=rn.unstable_getCurrentPriorityLevel,bc=rn.unstable_ImmediatePriority,Pf=rn.unstable_UserBlockingPriority,Ol=rn.unstable_NormalPriority,Wg=rn.unstable_LowPriority,$f=rn.unstable_IdlePriority,ui=null,Bn=null;function Gg(e){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(ui,e,void 0,(e.current.flags&128)===128)}catch{}}var In=Math.clz32?Math.clz32:Vg,Hg=Math.log,Ug=Math.LN2;function Vg(e){return e>>>=0,e===0?32:31-(Hg(e)/Ug|0)|0}var ol=64,ll=4194304;function lo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Fl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,o=e.suspendedLanes,l=e.pingedLanes,i=n&268435455;if(i!==0){var a=i&~o;a!==0?r=lo(a):(l&=i,l!==0&&(r=lo(l)))}else i=n&~o,i!==0?r=lo(i):l!==0&&(r=lo(l));if(r===0)return 0;if(t!==0&&t!==r&&!(t&o)&&(o=r&-r,l=t&-t,o>=l||o===16&&(l&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-In(t),o=1<<n,r|=e[n],t&=~o;return r}function Kg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yg(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,l=e.pendingLanes;0<l;){var i=31-In(l),a=1<<i,c=o[i];c===-1?(!(a&n)||a&r)&&(o[i]=Kg(a,t)):c<=t&&(e.expiredLanes|=a),l&=~a}}function Ea(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Tf(){var e=ol;return ol<<=1,!(ol&4194240)&&(ol=64),e}function Ai(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Wo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-In(t),e[t]=n}function Qg(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-In(n),l=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~l}}function yc(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-In(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var tt=0;function Df(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Mf,wc,Rf,_f,Af,Ia=!1,il=[],hs=null,xs=null,vs=null,Eo=new Map,Io=new Map,fs=[],Jg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _d(e,t){switch(e){case"focusin":case"focusout":hs=null;break;case"dragenter":case"dragleave":xs=null;break;case"mouseover":case"mouseout":vs=null;break;case"pointerover":case"pointerout":Eo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Io.delete(t.pointerId)}}function Qr(e,t,n,r,o,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:l,targetContainers:[o]},t!==null&&(t=Ho(t),t!==null&&wc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function Xg(e,t,n,r,o){switch(t){case"focusin":return hs=Qr(hs,e,t,n,r,o),!0;case"dragenter":return xs=Qr(xs,e,t,n,r,o),!0;case"mouseover":return vs=Qr(vs,e,t,n,r,o),!0;case"pointerover":var l=o.pointerId;return Eo.set(l,Qr(Eo.get(l)||null,e,t,n,r,o)),!0;case"gotpointercapture":return l=o.pointerId,Io.set(l,Qr(Io.get(l)||null,e,t,n,r,o)),!0}return!1}function Lf(e){var t=Fs(e.target);if(t!==null){var n=Zs(t);if(n!==null){if(t=n.tag,t===13){if(t=kf(n),t!==null){e.blockedOn=t,Af(e.priority,function(){Rf(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Sl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Pa(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Na=r,n.target.dispatchEvent(r),Na=null}else return t=Ho(n),t!==null&&wc(t),e.blockedOn=n,!1;t.shift()}return!0}function Ad(e,t,n){Sl(e)&&n.delete(t)}function Zg(){Ia=!1,hs!==null&&Sl(hs)&&(hs=null),xs!==null&&Sl(xs)&&(xs=null),vs!==null&&Sl(vs)&&(vs=null),Eo.forEach(Ad),Io.forEach(Ad)}function Jr(e,t){e.blockedOn===t&&(e.blockedOn=null,Ia||(Ia=!0,rn.unstable_scheduleCallback(rn.unstable_NormalPriority,Zg)))}function Po(e){function t(o){return Jr(o,e)}if(0<il.length){Jr(il[0],e);for(var n=1;n<il.length;n++){var r=il[n];r.blockedOn===e&&(r.blockedOn=null)}}for(hs!==null&&Jr(hs,e),xs!==null&&Jr(xs,e),vs!==null&&Jr(vs,e),Eo.forEach(t),Io.forEach(t),n=0;n<fs.length;n++)r=fs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<fs.length&&(n=fs[0],n.blockedOn===null);)Lf(n),n.blockedOn===null&&fs.shift()}var Cr=ss.ReactCurrentBatchConfig,zl=!0;function qg(e,t,n,r){var o=tt,l=Cr.transition;Cr.transition=null;try{tt=1,Sc(e,t,n,r)}finally{tt=o,Cr.transition=l}}function eh(e,t,n,r){var o=tt,l=Cr.transition;Cr.transition=null;try{tt=4,Sc(e,t,n,r)}finally{tt=o,Cr.transition=l}}function Sc(e,t,n,r){if(zl){var o=Pa(e,t,n,r);if(o===null)Vi(e,t,r,Bl,n),_d(e,r);else if(Xg(o,e,t,n,r))r.stopPropagation();else if(_d(e,r),t&4&&-1<Jg.indexOf(e)){for(;o!==null;){var l=Ho(o);if(l!==null&&Mf(l),l=Pa(e,t,n,r),l===null&&Vi(e,t,r,Bl,n),l===o)break;o=l}o!==null&&r.stopPropagation()}else Vi(e,t,r,null,n)}}var Bl=null;function Pa(e,t,n,r){if(Bl=null,e=vc(r),e=Fs(e),e!==null)if(t=Zs(e),t===null)e=null;else if(n=t.tag,n===13){if(e=kf(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Bl=e,null}function Of(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Bg()){case bc:return 1;case Pf:return 4;case Ol:case Wg:return 16;case $f:return 536870912;default:return 16}default:return 16}}var ms=null,Nc=null,Nl=null;function Ff(){if(Nl)return Nl;var e,t=Nc,n=t.length,r,o="value"in ms?ms.value:ms.textContent,l=o.length;for(e=0;e<n&&t[e]===o[e];e++);var i=n-e;for(r=1;r<=i&&t[n-r]===o[l-r];r++);return Nl=o.slice(e,1<r?1-r:void 0)}function jl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function al(){return!0}function Ld(){return!1}function ln(e){function t(n,r,o,l,i){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=l,this.target=i,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(l):l[a]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?al:Ld,this.isPropagationStopped=Ld,this}return xt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=al)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=al)},persist:function(){},isPersistent:al}),t}var Lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jc=ln(Lr),Go=xt({},Lr,{view:0,detail:0}),th=ln(Go),Li,Oi,Xr,fi=xt({},Go,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xr&&(Xr&&e.type==="mousemove"?(Li=e.screenX-Xr.screenX,Oi=e.screenY-Xr.screenY):Oi=Li=0,Xr=e),Li)},movementY:function(e){return"movementY"in e?e.movementY:Oi}}),Od=ln(fi),nh=xt({},fi,{dataTransfer:0}),sh=ln(nh),rh=xt({},Go,{relatedTarget:0}),Fi=ln(rh),oh=xt({},Lr,{animationName:0,elapsedTime:0,pseudoElement:0}),lh=ln(oh),ih=xt({},Lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ah=ln(ih),ch=xt({},Lr,{data:0}),Fd=ln(ch),dh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ph(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=fh[e])?!!t[e]:!1}function kc(){return ph}var mh=xt({},Go,{key:function(e){if(e.key){var t=dh[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=jl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?uh[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kc,charCode:function(e){return e.type==="keypress"?jl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?jl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),gh=ln(mh),hh=xt({},fi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zd=ln(hh),xh=xt({},Go,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kc}),vh=ln(xh),bh=xt({},Lr,{propertyName:0,elapsedTime:0,pseudoElement:0}),yh=ln(bh),wh=xt({},fi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Sh=ln(wh),Nh=[9,13,27,32],Cc=qn&&"CompositionEvent"in window,mo=null;qn&&"documentMode"in document&&(mo=document.documentMode);var jh=qn&&"TextEvent"in window&&!mo,zf=qn&&(!Cc||mo&&8<mo&&11>=mo),Bd=" ",Wd=!1;function Bf(e,t){switch(e){case"keyup":return Nh.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wf(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var fr=!1;function kh(e,t){switch(e){case"compositionend":return Wf(t);case"keypress":return t.which!==32?null:(Wd=!0,Bd);case"textInput":return e=t.data,e===Bd&&Wd?null:e;default:return null}}function Ch(e,t){if(fr)return e==="compositionend"||!Cc&&Bf(e,t)?(e=Ff(),Nl=Nc=ms=null,fr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zf&&t.locale!=="ko"?null:t.data;default:return null}}var Eh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Eh[e.type]:t==="textarea"}function Gf(e,t,n,r){yf(r),t=Wl(t,"onChange"),0<t.length&&(n=new jc("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var go=null,$o=null;function Ih(e){ep(e,0)}function pi(e){var t=gr(e);if(pf(t))return e}function Ph(e,t){if(e==="change")return t}var Hf=!1;if(qn){var zi;if(qn){var Bi="oninput"in document;if(!Bi){var Hd=document.createElement("div");Hd.setAttribute("oninput","return;"),Bi=typeof Hd.oninput=="function"}zi=Bi}else zi=!1;Hf=zi&&(!document.documentMode||9<document.documentMode)}function Ud(){go&&(go.detachEvent("onpropertychange",Uf),$o=go=null)}function Uf(e){if(e.propertyName==="value"&&pi($o)){var t=[];Gf(t,$o,e,vc(e)),jf(Ih,t)}}function $h(e,t,n){e==="focusin"?(Ud(),go=t,$o=n,go.attachEvent("onpropertychange",Uf)):e==="focusout"&&Ud()}function Th(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return pi($o)}function Dh(e,t){if(e==="click")return pi(t)}function Mh(e,t){if(e==="input"||e==="change")return pi(t)}function Rh(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var $n=typeof Object.is=="function"?Object.is:Rh;function To(e,t){if($n(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!ua.call(t,o)||!$n(e[o],t[o]))return!1}return!0}function Vd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Kd(e,t){var n=Vd(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Vd(n)}}function Vf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Vf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Kf(){for(var e=window,t=_l();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=_l(e.document)}return t}function Ec(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function _h(e){var t=Kf(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Vf(n.ownerDocument.documentElement,n)){if(r!==null&&Ec(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,l=Math.min(r.start,o);r=r.end===void 0?l:Math.min(r.end,o),!e.extend&&l>r&&(o=r,r=l,l=o),o=Kd(n,l);var i=Kd(n,r);o&&i&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),l>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Ah=qn&&"documentMode"in document&&11>=document.documentMode,pr=null,$a=null,ho=null,Ta=!1;function Yd(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ta||pr==null||pr!==_l(r)||(r=pr,"selectionStart"in r&&Ec(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ho&&To(ho,r)||(ho=r,r=Wl($a,"onSelect"),0<r.length&&(t=new jc("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=pr)))}function cl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var mr={animationend:cl("Animation","AnimationEnd"),animationiteration:cl("Animation","AnimationIteration"),animationstart:cl("Animation","AnimationStart"),transitionend:cl("Transition","TransitionEnd")},Wi={},Yf={};qn&&(Yf=document.createElement("div").style,"AnimationEvent"in window||(delete mr.animationend.animation,delete mr.animationiteration.animation,delete mr.animationstart.animation),"TransitionEvent"in window||delete mr.transitionend.transition);function mi(e){if(Wi[e])return Wi[e];if(!mr[e])return e;var t=mr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Yf)return Wi[e]=t[n];return e}var Qf=mi("animationend"),Jf=mi("animationiteration"),Xf=mi("animationstart"),Zf=mi("transitionend"),qf=new Map,Qd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Es(e,t){qf.set(e,t),Xs(t,[e])}for(var Gi=0;Gi<Qd.length;Gi++){var Hi=Qd[Gi],Lh=Hi.toLowerCase(),Oh=Hi[0].toUpperCase()+Hi.slice(1);Es(Lh,"on"+Oh)}Es(Qf,"onAnimationEnd");Es(Jf,"onAnimationIteration");Es(Xf,"onAnimationStart");Es("dblclick","onDoubleClick");Es("focusin","onFocus");Es("focusout","onBlur");Es(Zf,"onTransitionEnd");Pr("onMouseEnter",["mouseout","mouseover"]);Pr("onMouseLeave",["mouseout","mouseover"]);Pr("onPointerEnter",["pointerout","pointerover"]);Pr("onPointerLeave",["pointerout","pointerover"]);Xs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var io="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fh=new Set("cancel close invalid load scroll toggle".split(" ").concat(io));function Jd(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Lg(r,t,void 0,e),e.currentTarget=null}function ep(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var l=void 0;if(t)for(var i=r.length-1;0<=i;i--){var a=r[i],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==l&&o.isPropagationStopped())break e;Jd(o,a,u),l=c}else for(i=0;i<r.length;i++){if(a=r[i],c=a.instance,u=a.currentTarget,a=a.listener,c!==l&&o.isPropagationStopped())break e;Jd(o,a,u),l=c}}}if(Ll)throw e=Ca,Ll=!1,Ca=null,e}function ut(e,t){var n=t[Aa];n===void 0&&(n=t[Aa]=new Set);var r=e+"__bubble";n.has(r)||(tp(t,e,2,!1),n.add(r))}function Ui(e,t,n){var r=0;t&&(r|=4),tp(n,e,r,t)}var dl="_reactListening"+Math.random().toString(36).slice(2);function Do(e){if(!e[dl]){e[dl]=!0,af.forEach(function(n){n!=="selectionchange"&&(Fh.has(n)||Ui(n,!1,e),Ui(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[dl]||(t[dl]=!0,Ui("selectionchange",!1,t))}}function tp(e,t,n,r){switch(Of(t)){case 1:var o=qg;break;case 4:o=eh;break;default:o=Sc}n=o.bind(null,t,n,e),o=void 0,!ka||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Vi(e,t,n,r,o){var l=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var a=r.stateNode.containerInfo;if(a===o||a.nodeType===8&&a.parentNode===o)break;if(i===4)for(i=r.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===o||c.nodeType===8&&c.parentNode===o))return;i=i.return}for(;a!==null;){if(i=Fs(a),i===null)return;if(c=i.tag,c===5||c===6){r=l=i;continue e}a=a.parentNode}}r=r.return}jf(function(){var u=l,m=vc(n),E=[];e:{var S=qf.get(e);if(S!==void 0){var j=jc,L=e;switch(e){case"keypress":if(jl(n)===0)break e;case"keydown":case"keyup":j=gh;break;case"focusin":L="focus",j=Fi;break;case"focusout":L="blur",j=Fi;break;case"beforeblur":case"afterblur":j=Fi;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=Od;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=sh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=vh;break;case Qf:case Jf:case Xf:j=lh;break;case Zf:j=yh;break;case"scroll":j=th;break;case"wheel":j=Sh;break;case"copy":case"cut":case"paste":j=ah;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=zd}var N=(t&4)!==0,W=!N&&e==="scroll",x=N?S!==null?S+"Capture":null:S;N=[];for(var f=u,v;f!==null;){v=f;var D=v.stateNode;if(v.tag===5&&D!==null&&(v=D,x!==null&&(D=Co(f,x),D!=null&&N.push(Mo(f,D,v)))),W)break;f=f.return}0<N.length&&(S=new j(S,L,null,n,m),E.push({event:S,listeners:N}))}}if(!(t&7)){e:{if(S=e==="mouseover"||e==="pointerover",j=e==="mouseout"||e==="pointerout",S&&n!==Na&&(L=n.relatedTarget||n.fromElement)&&(Fs(L)||L[es]))break e;if((j||S)&&(S=m.window===m?m:(S=m.ownerDocument)?S.defaultView||S.parentWindow:window,j?(L=n.relatedTarget||n.toElement,j=u,L=L?Fs(L):null,L!==null&&(W=Zs(L),L!==W||L.tag!==5&&L.tag!==6)&&(L=null)):(j=null,L=u),j!==L)){if(N=Od,D="onMouseLeave",x="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(N=zd,D="onPointerLeave",x="onPointerEnter",f="pointer"),W=j==null?S:gr(j),v=L==null?S:gr(L),S=new N(D,f+"leave",j,n,m),S.target=W,S.relatedTarget=v,D=null,Fs(m)===u&&(N=new N(x,f+"enter",L,n,m),N.target=v,N.relatedTarget=W,D=N),W=D,j&&L)t:{for(N=j,x=L,f=0,v=N;v;v=rr(v))f++;for(v=0,D=x;D;D=rr(D))v++;for(;0<f-v;)N=rr(N),f--;for(;0<v-f;)x=rr(x),v--;for(;f--;){if(N===x||x!==null&&N===x.alternate)break t;N=rr(N),x=rr(x)}N=null}else N=null;j!==null&&Xd(E,S,j,N,!1),L!==null&&W!==null&&Xd(E,W,L,N,!0)}}e:{if(S=u?gr(u):window,j=S.nodeName&&S.nodeName.toLowerCase(),j==="select"||j==="input"&&S.type==="file")var M=Ph;else if(Gd(S))if(Hf)M=Mh;else{M=Th;var G=$h}else(j=S.nodeName)&&j.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(M=Dh);if(M&&(M=M(e,u))){Gf(E,M,n,m);break e}G&&G(e,S,u),e==="focusout"&&(G=S._wrapperState)&&G.controlled&&S.type==="number"&&va(S,"number",S.value)}switch(G=u?gr(u):window,e){case"focusin":(Gd(G)||G.contentEditable==="true")&&(pr=G,$a=u,ho=null);break;case"focusout":ho=$a=pr=null;break;case"mousedown":Ta=!0;break;case"contextmenu":case"mouseup":case"dragend":Ta=!1,Yd(E,n,m);break;case"selectionchange":if(Ah)break;case"keydown":case"keyup":Yd(E,n,m)}var J;if(Cc)e:{switch(e){case"compositionstart":var U="onCompositionStart";break e;case"compositionend":U="onCompositionEnd";break e;case"compositionupdate":U="onCompositionUpdate";break e}U=void 0}else fr?Bf(e,n)&&(U="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(U="onCompositionStart");U&&(zf&&n.locale!=="ko"&&(fr||U!=="onCompositionStart"?U==="onCompositionEnd"&&fr&&(J=Ff()):(ms=m,Nc="value"in ms?ms.value:ms.textContent,fr=!0)),G=Wl(u,U),0<G.length&&(U=new Fd(U,e,null,n,m),E.push({event:U,listeners:G}),J?U.data=J:(J=Wf(n),J!==null&&(U.data=J)))),(J=jh?kh(e,n):Ch(e,n))&&(u=Wl(u,"onBeforeInput"),0<u.length&&(m=new Fd("onBeforeInput","beforeinput",null,n,m),E.push({event:m,listeners:u}),m.data=J))}ep(E,t)})}function Mo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wl(e,t){for(var n=t+"Capture",r=[];e!==null;){var o=e,l=o.stateNode;o.tag===5&&l!==null&&(o=l,l=Co(e,n),l!=null&&r.unshift(Mo(e,l,o)),l=Co(e,t),l!=null&&r.push(Mo(e,l,o))),e=e.return}return r}function rr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Xd(e,t,n,r,o){for(var l=t._reactName,i=[];n!==null&&n!==r;){var a=n,c=a.alternate,u=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&u!==null&&(a=u,o?(c=Co(n,l),c!=null&&i.unshift(Mo(n,c,a))):o||(c=Co(n,l),c!=null&&i.push(Mo(n,c,a)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var zh=/\r\n?/g,Bh=/\u0000|\uFFFD/g;function Zd(e){return(typeof e=="string"?e:""+e).replace(zh,`
`).replace(Bh,"")}function ul(e,t,n){if(t=Zd(t),Zd(e)!==t&&n)throw Error(ue(425))}function Gl(){}var Da=null,Ma=null;function Ra(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var _a=typeof setTimeout=="function"?setTimeout:void 0,Wh=typeof clearTimeout=="function"?clearTimeout:void 0,qd=typeof Promise=="function"?Promise:void 0,Gh=typeof queueMicrotask=="function"?queueMicrotask:typeof qd<"u"?function(e){return qd.resolve(null).then(e).catch(Hh)}:_a;function Hh(e){setTimeout(function(){throw e})}function Ki(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){e.removeChild(o),Po(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);Po(t)}function bs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function eu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Or=Math.random().toString(36).slice(2),zn="__reactFiber$"+Or,Ro="__reactProps$"+Or,es="__reactContainer$"+Or,Aa="__reactEvents$"+Or,Uh="__reactListeners$"+Or,Vh="__reactHandles$"+Or;function Fs(e){var t=e[zn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[es]||n[zn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=eu(e);e!==null;){if(n=e[zn])return n;e=eu(e)}return t}e=n,n=e.parentNode}return null}function Ho(e){return e=e[zn]||e[es],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function gr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ue(33))}function gi(e){return e[Ro]||null}var La=[],hr=-1;function Is(e){return{current:e}}function ft(e){0>hr||(e.current=La[hr],La[hr]=null,hr--)}function lt(e,t){hr++,La[hr]=e.current,e.current=t}var ks={},Ot=Is(ks),Yt=Is(!1),Hs=ks;function $r(e,t){var n=e.type.contextTypes;if(!n)return ks;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o={},l;for(l in n)o[l]=t[l];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Qt(e){return e=e.childContextTypes,e!=null}function Hl(){ft(Yt),ft(Ot)}function tu(e,t,n){if(Ot.current!==ks)throw Error(ue(168));lt(Ot,t),lt(Yt,n)}function np(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in t))throw Error(ue(108,$g(e)||"Unknown",o));return xt({},n,r)}function Ul(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ks,Hs=Ot.current,lt(Ot,e),lt(Yt,Yt.current),!0}function nu(e,t,n){var r=e.stateNode;if(!r)throw Error(ue(169));n?(e=np(e,t,Hs),r.__reactInternalMemoizedMergedChildContext=e,ft(Yt),ft(Ot),lt(Ot,e)):ft(Yt),lt(Yt,n)}var Qn=null,hi=!1,Yi=!1;function sp(e){Qn===null?Qn=[e]:Qn.push(e)}function Kh(e){hi=!0,sp(e)}function Ps(){if(!Yi&&Qn!==null){Yi=!0;var e=0,t=tt;try{var n=Qn;for(tt=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Qn=null,hi=!1}catch(o){throw Qn!==null&&(Qn=Qn.slice(e+1)),If(bc,Ps),o}finally{tt=t,Yi=!1}}return null}var xr=[],vr=0,Vl=null,Kl=0,dn=[],un=0,Us=null,Jn=1,Xn="";function As(e,t){xr[vr++]=Kl,xr[vr++]=Vl,Vl=e,Kl=t}function rp(e,t,n){dn[un++]=Jn,dn[un++]=Xn,dn[un++]=Us,Us=e;var r=Jn;e=Xn;var o=32-In(r)-1;r&=~(1<<o),n+=1;var l=32-In(t)+o;if(30<l){var i=o-o%5;l=(r&(1<<i)-1).toString(32),r>>=i,o-=i,Jn=1<<32-In(t)+o|n<<o|r,Xn=l+e}else Jn=1<<l|n<<o|r,Xn=e}function Ic(e){e.return!==null&&(As(e,1),rp(e,1,0))}function Pc(e){for(;e===Vl;)Vl=xr[--vr],xr[vr]=null,Kl=xr[--vr],xr[vr]=null;for(;e===Us;)Us=dn[--un],dn[un]=null,Xn=dn[--un],dn[un]=null,Jn=dn[--un],dn[un]=null}var sn=null,nn=null,pt=!1,Cn=null;function op(e,t){var n=fn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function su(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,sn=e,nn=bs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,sn=e,nn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Us!==null?{id:Jn,overflow:Xn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=fn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,sn=e,nn=null,!0):!1;default:return!1}}function Oa(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Fa(e){if(pt){var t=nn;if(t){var n=t;if(!su(e,t)){if(Oa(e))throw Error(ue(418));t=bs(n.nextSibling);var r=sn;t&&su(e,t)?op(r,n):(e.flags=e.flags&-4097|2,pt=!1,sn=e)}}else{if(Oa(e))throw Error(ue(418));e.flags=e.flags&-4097|2,pt=!1,sn=e}}}function ru(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;sn=e}function fl(e){if(e!==sn)return!1;if(!pt)return ru(e),pt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ra(e.type,e.memoizedProps)),t&&(t=nn)){if(Oa(e))throw lp(),Error(ue(418));for(;t;)op(e,t),t=bs(t.nextSibling)}if(ru(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ue(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){nn=bs(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}nn=null}}else nn=sn?bs(e.stateNode.nextSibling):null;return!0}function lp(){for(var e=nn;e;)e=bs(e.nextSibling)}function Tr(){nn=sn=null,pt=!1}function $c(e){Cn===null?Cn=[e]:Cn.push(e)}var Yh=ss.ReactCurrentBatchConfig;function Zr(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ue(309));var r=n.stateNode}if(!r)throw Error(ue(147,e));var o=r,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(i){var a=o.refs;i===null?delete a[l]:a[l]=i},t._stringRef=l,t)}if(typeof e!="string")throw Error(ue(284));if(!n._owner)throw Error(ue(290,e))}return e}function pl(e,t){throw e=Object.prototype.toString.call(t),Error(ue(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ou(e){var t=e._init;return t(e._payload)}function ip(e){function t(x,f){if(e){var v=x.deletions;v===null?(x.deletions=[f],x.flags|=16):v.push(f)}}function n(x,f){if(!e)return null;for(;f!==null;)t(x,f),f=f.sibling;return null}function r(x,f){for(x=new Map;f!==null;)f.key!==null?x.set(f.key,f):x.set(f.index,f),f=f.sibling;return x}function o(x,f){return x=Ns(x,f),x.index=0,x.sibling=null,x}function l(x,f,v){return x.index=v,e?(v=x.alternate,v!==null?(v=v.index,v<f?(x.flags|=2,f):v):(x.flags|=2,f)):(x.flags|=1048576,f)}function i(x){return e&&x.alternate===null&&(x.flags|=2),x}function a(x,f,v,D){return f===null||f.tag!==6?(f=ta(v,x.mode,D),f.return=x,f):(f=o(f,v),f.return=x,f)}function c(x,f,v,D){var M=v.type;return M===ur?m(x,f,v.props.children,D,v.key):f!==null&&(f.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===cs&&ou(M)===f.type)?(D=o(f,v.props),D.ref=Zr(x,f,v),D.return=x,D):(D=Tl(v.type,v.key,v.props,null,x.mode,D),D.ref=Zr(x,f,v),D.return=x,D)}function u(x,f,v,D){return f===null||f.tag!==4||f.stateNode.containerInfo!==v.containerInfo||f.stateNode.implementation!==v.implementation?(f=na(v,x.mode,D),f.return=x,f):(f=o(f,v.children||[]),f.return=x,f)}function m(x,f,v,D,M){return f===null||f.tag!==7?(f=Gs(v,x.mode,D,M),f.return=x,f):(f=o(f,v),f.return=x,f)}function E(x,f,v){if(typeof f=="string"&&f!==""||typeof f=="number")return f=ta(""+f,x.mode,v),f.return=x,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case nl:return v=Tl(f.type,f.key,f.props,null,x.mode,v),v.ref=Zr(x,null,f),v.return=x,v;case dr:return f=na(f,x.mode,v),f.return=x,f;case cs:var D=f._init;return E(x,D(f._payload),v)}if(oo(f)||Kr(f))return f=Gs(f,x.mode,v,null),f.return=x,f;pl(x,f)}return null}function S(x,f,v,D){var M=f!==null?f.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return M!==null?null:a(x,f,""+v,D);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case nl:return v.key===M?c(x,f,v,D):null;case dr:return v.key===M?u(x,f,v,D):null;case cs:return M=v._init,S(x,f,M(v._payload),D)}if(oo(v)||Kr(v))return M!==null?null:m(x,f,v,D,null);pl(x,v)}return null}function j(x,f,v,D,M){if(typeof D=="string"&&D!==""||typeof D=="number")return x=x.get(v)||null,a(f,x,""+D,M);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case nl:return x=x.get(D.key===null?v:D.key)||null,c(f,x,D,M);case dr:return x=x.get(D.key===null?v:D.key)||null,u(f,x,D,M);case cs:var G=D._init;return j(x,f,v,G(D._payload),M)}if(oo(D)||Kr(D))return x=x.get(v)||null,m(f,x,D,M,null);pl(f,D)}return null}function L(x,f,v,D){for(var M=null,G=null,J=f,U=f=0,te=null;J!==null&&U<v.length;U++){J.index>U?(te=J,J=null):te=J.sibling;var ae=S(x,J,v[U],D);if(ae===null){J===null&&(J=te);break}e&&J&&ae.alternate===null&&t(x,J),f=l(ae,f,U),G===null?M=ae:G.sibling=ae,G=ae,J=te}if(U===v.length)return n(x,J),pt&&As(x,U),M;if(J===null){for(;U<v.length;U++)J=E(x,v[U],D),J!==null&&(f=l(J,f,U),G===null?M=J:G.sibling=J,G=J);return pt&&As(x,U),M}for(J=r(x,J);U<v.length;U++)te=j(J,x,U,v[U],D),te!==null&&(e&&te.alternate!==null&&J.delete(te.key===null?U:te.key),f=l(te,f,U),G===null?M=te:G.sibling=te,G=te);return e&&J.forEach(function(Y){return t(x,Y)}),pt&&As(x,U),M}function N(x,f,v,D){var M=Kr(v);if(typeof M!="function")throw Error(ue(150));if(v=M.call(v),v==null)throw Error(ue(151));for(var G=M=null,J=f,U=f=0,te=null,ae=v.next();J!==null&&!ae.done;U++,ae=v.next()){J.index>U?(te=J,J=null):te=J.sibling;var Y=S(x,J,ae.value,D);if(Y===null){J===null&&(J=te);break}e&&J&&Y.alternate===null&&t(x,J),f=l(Y,f,U),G===null?M=Y:G.sibling=Y,G=Y,J=te}if(ae.done)return n(x,J),pt&&As(x,U),M;if(J===null){for(;!ae.done;U++,ae=v.next())ae=E(x,ae.value,D),ae!==null&&(f=l(ae,f,U),G===null?M=ae:G.sibling=ae,G=ae);return pt&&As(x,U),M}for(J=r(x,J);!ae.done;U++,ae=v.next())ae=j(J,x,U,ae.value,D),ae!==null&&(e&&ae.alternate!==null&&J.delete(ae.key===null?U:ae.key),f=l(ae,f,U),G===null?M=ae:G.sibling=ae,G=ae);return e&&J.forEach(function(ce){return t(x,ce)}),pt&&As(x,U),M}function W(x,f,v,D){if(typeof v=="object"&&v!==null&&v.type===ur&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case nl:e:{for(var M=v.key,G=f;G!==null;){if(G.key===M){if(M=v.type,M===ur){if(G.tag===7){n(x,G.sibling),f=o(G,v.props.children),f.return=x,x=f;break e}}else if(G.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===cs&&ou(M)===G.type){n(x,G.sibling),f=o(G,v.props),f.ref=Zr(x,G,v),f.return=x,x=f;break e}n(x,G);break}else t(x,G);G=G.sibling}v.type===ur?(f=Gs(v.props.children,x.mode,D,v.key),f.return=x,x=f):(D=Tl(v.type,v.key,v.props,null,x.mode,D),D.ref=Zr(x,f,v),D.return=x,x=D)}return i(x);case dr:e:{for(G=v.key;f!==null;){if(f.key===G)if(f.tag===4&&f.stateNode.containerInfo===v.containerInfo&&f.stateNode.implementation===v.implementation){n(x,f.sibling),f=o(f,v.children||[]),f.return=x,x=f;break e}else{n(x,f);break}else t(x,f);f=f.sibling}f=na(v,x.mode,D),f.return=x,x=f}return i(x);case cs:return G=v._init,W(x,f,G(v._payload),D)}if(oo(v))return L(x,f,v,D);if(Kr(v))return N(x,f,v,D);pl(x,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,f!==null&&f.tag===6?(n(x,f.sibling),f=o(f,v),f.return=x,x=f):(n(x,f),f=ta(v,x.mode,D),f.return=x,x=f),i(x)):n(x,f)}return W}var Dr=ip(!0),ap=ip(!1),Yl=Is(null),Ql=null,br=null,Tc=null;function Dc(){Tc=br=Ql=null}function Mc(e){var t=Yl.current;ft(Yl),e._currentValue=t}function za(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Er(e,t){Ql=e,Tc=br=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Kt=!0),e.firstContext=null)}function gn(e){var t=e._currentValue;if(Tc!==e)if(e={context:e,memoizedValue:t,next:null},br===null){if(Ql===null)throw Error(ue(308));br=e,Ql.dependencies={lanes:0,firstContext:e}}else br=br.next=e;return t}var zs=null;function Rc(e){zs===null?zs=[e]:zs.push(e)}function cp(e,t,n,r){var o=t.interleaved;return o===null?(n.next=n,Rc(t)):(n.next=o.next,o.next=n),t.interleaved=n,ts(e,r)}function ts(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ds=!1;function _c(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Zn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ys(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Je&2){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,ts(e,n)}return o=r.interleaved,o===null?(t.next=t,Rc(r)):(t.next=o.next,o.next=t),r.interleaved=t,ts(e,n)}function kl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,yc(e,n)}}function lu(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?o=l=i:l=l.next=i,n=n.next}while(n!==null);l===null?o=l=t:l=l.next=t}else o=l=t;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:l,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Jl(e,t,n,r){var o=e.updateQueue;ds=!1;var l=o.firstBaseUpdate,i=o.lastBaseUpdate,a=o.shared.pending;if(a!==null){o.shared.pending=null;var c=a,u=c.next;c.next=null,i===null?l=u:i.next=u,i=c;var m=e.alternate;m!==null&&(m=m.updateQueue,a=m.lastBaseUpdate,a!==i&&(a===null?m.firstBaseUpdate=u:a.next=u,m.lastBaseUpdate=c))}if(l!==null){var E=o.baseState;i=0,m=u=c=null,a=l;do{var S=a.lane,j=a.eventTime;if((r&S)===S){m!==null&&(m=m.next={eventTime:j,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var L=e,N=a;switch(S=t,j=n,N.tag){case 1:if(L=N.payload,typeof L=="function"){E=L.call(j,E,S);break e}E=L;break e;case 3:L.flags=L.flags&-65537|128;case 0:if(L=N.payload,S=typeof L=="function"?L.call(j,E,S):L,S==null)break e;E=xt({},E,S);break e;case 2:ds=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,S=o.effects,S===null?o.effects=[a]:S.push(a))}else j={eventTime:j,lane:S,tag:a.tag,payload:a.payload,callback:a.callback,next:null},m===null?(u=m=j,c=E):m=m.next=j,i|=S;if(a=a.next,a===null){if(a=o.shared.pending,a===null)break;S=a,a=S.next,S.next=null,o.lastBaseUpdate=S,o.shared.pending=null}}while(!0);if(m===null&&(c=E),o.baseState=c,o.firstBaseUpdate=u,o.lastBaseUpdate=m,t=o.shared.interleaved,t!==null){o=t;do i|=o.lane,o=o.next;while(o!==t)}else l===null&&(o.shared.lanes=0);Ks|=i,e.lanes=i,e.memoizedState=E}}function iu(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(ue(191,o));o.call(r)}}}var Uo={},Wn=Is(Uo),_o=Is(Uo),Ao=Is(Uo);function Bs(e){if(e===Uo)throw Error(ue(174));return e}function Ac(e,t){switch(lt(Ao,t),lt(_o,e),lt(Wn,Uo),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ya(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ya(t,e)}ft(Wn),lt(Wn,t)}function Mr(){ft(Wn),ft(_o),ft(Ao)}function up(e){Bs(Ao.current);var t=Bs(Wn.current),n=ya(t,e.type);t!==n&&(lt(_o,e),lt(Wn,n))}function Lc(e){_o.current===e&&(ft(Wn),ft(_o))}var gt=Is(0);function Xl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qi=[];function Oc(){for(var e=0;e<Qi.length;e++)Qi[e]._workInProgressVersionPrimary=null;Qi.length=0}var Cl=ss.ReactCurrentDispatcher,Ji=ss.ReactCurrentBatchConfig,Vs=0,ht=null,jt=null,Et=null,Zl=!1,xo=!1,Lo=0,Qh=0;function _t(){throw Error(ue(321))}function Fc(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!$n(e[n],t[n]))return!1;return!0}function zc(e,t,n,r,o,l){if(Vs=l,ht=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Cl.current=e===null||e.memoizedState===null?qh:ex,e=n(r,o),xo){l=0;do{if(xo=!1,Lo=0,25<=l)throw Error(ue(301));l+=1,Et=jt=null,t.updateQueue=null,Cl.current=tx,e=n(r,o)}while(xo)}if(Cl.current=ql,t=jt!==null&&jt.next!==null,Vs=0,Et=jt=ht=null,Zl=!1,t)throw Error(ue(300));return e}function Bc(){var e=Lo!==0;return Lo=0,e}function Ln(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?ht.memoizedState=Et=e:Et=Et.next=e,Et}function hn(){if(jt===null){var e=ht.alternate;e=e!==null?e.memoizedState:null}else e=jt.next;var t=Et===null?ht.memoizedState:Et.next;if(t!==null)Et=t,jt=e;else{if(e===null)throw Error(ue(310));jt=e,e={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},Et===null?ht.memoizedState=Et=e:Et=Et.next=e}return Et}function Oo(e,t){return typeof t=="function"?t(e):t}function Xi(e){var t=hn(),n=t.queue;if(n===null)throw Error(ue(311));n.lastRenderedReducer=e;var r=jt,o=r.baseQueue,l=n.pending;if(l!==null){if(o!==null){var i=o.next;o.next=l.next,l.next=i}r.baseQueue=o=l,n.pending=null}if(o!==null){l=o.next,r=r.baseState;var a=i=null,c=null,u=l;do{var m=u.lane;if((Vs&m)===m)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var E={lane:m,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=E,i=r):c=c.next=E,ht.lanes|=m,Ks|=m}u=u.next}while(u!==null&&u!==l);c===null?i=r:c.next=a,$n(r,t.memoizedState)||(Kt=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){o=e;do l=o.lane,ht.lanes|=l,Ks|=l,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Zi(e){var t=hn(),n=t.queue;if(n===null)throw Error(ue(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,l=t.memoizedState;if(o!==null){n.pending=null;var i=o=o.next;do l=e(l,i.action),i=i.next;while(i!==o);$n(l,t.memoizedState)||(Kt=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,r]}function fp(){}function pp(e,t){var n=ht,r=hn(),o=t(),l=!$n(r.memoizedState,o);if(l&&(r.memoizedState=o,Kt=!0),r=r.queue,Wc(hp.bind(null,n,r,e),[e]),r.getSnapshot!==t||l||Et!==null&&Et.memoizedState.tag&1){if(n.flags|=2048,Fo(9,gp.bind(null,n,r,o,t),void 0,null),It===null)throw Error(ue(349));Vs&30||mp(n,t,o)}return o}function mp(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ht.updateQueue,t===null?(t={lastEffect:null,stores:null},ht.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function gp(e,t,n,r){t.value=n,t.getSnapshot=r,xp(t)&&vp(e)}function hp(e,t,n){return n(function(){xp(t)&&vp(e)})}function xp(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!$n(e,n)}catch{return!0}}function vp(e){var t=ts(e,1);t!==null&&Pn(t,e,1,-1)}function au(e){var t=Ln();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oo,lastRenderedState:e},t.queue=e,e=e.dispatch=Zh.bind(null,ht,e),[t.memoizedState,e]}function Fo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=ht.updateQueue,t===null?(t={lastEffect:null,stores:null},ht.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function bp(){return hn().memoizedState}function El(e,t,n,r){var o=Ln();ht.flags|=e,o.memoizedState=Fo(1|t,n,void 0,r===void 0?null:r)}function xi(e,t,n,r){var o=hn();r=r===void 0?null:r;var l=void 0;if(jt!==null){var i=jt.memoizedState;if(l=i.destroy,r!==null&&Fc(r,i.deps)){o.memoizedState=Fo(t,n,l,r);return}}ht.flags|=e,o.memoizedState=Fo(1|t,n,l,r)}function cu(e,t){return El(8390656,8,e,t)}function Wc(e,t){return xi(2048,8,e,t)}function yp(e,t){return xi(4,2,e,t)}function wp(e,t){return xi(4,4,e,t)}function Sp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Np(e,t,n){return n=n!=null?n.concat([e]):null,xi(4,4,Sp.bind(null,t,e),n)}function Gc(){}function jp(e,t){var n=hn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Fc(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function kp(e,t){var n=hn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Fc(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Cp(e,t,n){return Vs&21?($n(n,t)||(n=Tf(),ht.lanes|=n,Ks|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Kt=!0),e.memoizedState=n)}function Jh(e,t){var n=tt;tt=n!==0&&4>n?n:4,e(!0);var r=Ji.transition;Ji.transition={};try{e(!1),t()}finally{tt=n,Ji.transition=r}}function Ep(){return hn().memoizedState}function Xh(e,t,n){var r=Ss(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ip(e))Pp(t,n);else if(n=cp(e,t,n,r),n!==null){var o=Wt();Pn(n,e,r,o),$p(n,t,r)}}function Zh(e,t,n){var r=Ss(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ip(e))Pp(t,o);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var i=t.lastRenderedState,a=l(i,n);if(o.hasEagerState=!0,o.eagerState=a,$n(a,i)){var c=t.interleaved;c===null?(o.next=o,Rc(t)):(o.next=c.next,c.next=o),t.interleaved=o;return}}catch{}finally{}n=cp(e,t,o,r),n!==null&&(o=Wt(),Pn(n,e,r,o),$p(n,t,r))}}function Ip(e){var t=e.alternate;return e===ht||t!==null&&t===ht}function Pp(e,t){xo=Zl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function $p(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,yc(e,n)}}var ql={readContext:gn,useCallback:_t,useContext:_t,useEffect:_t,useImperativeHandle:_t,useInsertionEffect:_t,useLayoutEffect:_t,useMemo:_t,useReducer:_t,useRef:_t,useState:_t,useDebugValue:_t,useDeferredValue:_t,useTransition:_t,useMutableSource:_t,useSyncExternalStore:_t,useId:_t,unstable_isNewReconciler:!1},qh={readContext:gn,useCallback:function(e,t){return Ln().memoizedState=[e,t===void 0?null:t],e},useContext:gn,useEffect:cu,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,El(4194308,4,Sp.bind(null,t,e),n)},useLayoutEffect:function(e,t){return El(4194308,4,e,t)},useInsertionEffect:function(e,t){return El(4,2,e,t)},useMemo:function(e,t){var n=Ln();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ln();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Xh.bind(null,ht,e),[r.memoizedState,e]},useRef:function(e){var t=Ln();return e={current:e},t.memoizedState=e},useState:au,useDebugValue:Gc,useDeferredValue:function(e){return Ln().memoizedState=e},useTransition:function(){var e=au(!1),t=e[0];return e=Jh.bind(null,e[1]),Ln().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ht,o=Ln();if(pt){if(n===void 0)throw Error(ue(407));n=n()}else{if(n=t(),It===null)throw Error(ue(349));Vs&30||mp(r,t,n)}o.memoizedState=n;var l={value:n,getSnapshot:t};return o.queue=l,cu(hp.bind(null,r,l,e),[e]),r.flags|=2048,Fo(9,gp.bind(null,r,l,n,t),void 0,null),n},useId:function(){var e=Ln(),t=It.identifierPrefix;if(pt){var n=Xn,r=Jn;n=(r&~(1<<32-In(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Lo++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Qh++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ex={readContext:gn,useCallback:jp,useContext:gn,useEffect:Wc,useImperativeHandle:Np,useInsertionEffect:yp,useLayoutEffect:wp,useMemo:kp,useReducer:Xi,useRef:bp,useState:function(){return Xi(Oo)},useDebugValue:Gc,useDeferredValue:function(e){var t=hn();return Cp(t,jt.memoizedState,e)},useTransition:function(){var e=Xi(Oo)[0],t=hn().memoizedState;return[e,t]},useMutableSource:fp,useSyncExternalStore:pp,useId:Ep,unstable_isNewReconciler:!1},tx={readContext:gn,useCallback:jp,useContext:gn,useEffect:Wc,useImperativeHandle:Np,useInsertionEffect:yp,useLayoutEffect:wp,useMemo:kp,useReducer:Zi,useRef:bp,useState:function(){return Zi(Oo)},useDebugValue:Gc,useDeferredValue:function(e){var t=hn();return jt===null?t.memoizedState=e:Cp(t,jt.memoizedState,e)},useTransition:function(){var e=Zi(Oo)[0],t=hn().memoizedState;return[e,t]},useMutableSource:fp,useSyncExternalStore:pp,useId:Ep,unstable_isNewReconciler:!1};function jn(e,t){if(e&&e.defaultProps){t=xt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Ba(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:xt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var vi={isMounted:function(e){return(e=e._reactInternals)?Zs(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Wt(),o=Ss(e),l=Zn(r,o);l.payload=t,n!=null&&(l.callback=n),t=ys(e,l,o),t!==null&&(Pn(t,e,o,r),kl(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Wt(),o=Ss(e),l=Zn(r,o);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=ys(e,l,o),t!==null&&(Pn(t,e,o,r),kl(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Wt(),r=Ss(e),o=Zn(n,r);o.tag=2,t!=null&&(o.callback=t),t=ys(e,o,r),t!==null&&(Pn(t,e,r,n),kl(t,e,r))}};function du(e,t,n,r,o,l,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,l,i):t.prototype&&t.prototype.isPureReactComponent?!To(n,r)||!To(o,l):!0}function Tp(e,t,n){var r=!1,o=ks,l=t.contextType;return typeof l=="object"&&l!==null?l=gn(l):(o=Qt(t)?Hs:Ot.current,r=t.contextTypes,l=(r=r!=null)?$r(e,o):ks),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=vi,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=l),t}function uu(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&vi.enqueueReplaceState(t,t.state,null)}function Wa(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},_c(e);var l=t.contextType;typeof l=="object"&&l!==null?o.context=gn(l):(l=Qt(t)?Hs:Ot.current,o.context=$r(e,l)),o.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(Ba(e,t,l,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&vi.enqueueReplaceState(o,o.state,null),Jl(e,n,o,r),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Rr(e,t){try{var n="",r=t;do n+=Pg(r),r=r.return;while(r);var o=n}catch(l){o=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:o,digest:null}}function qi(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Ga(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var nx=typeof WeakMap=="function"?WeakMap:Map;function Dp(e,t,n){n=Zn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ti||(ti=!0,qa=r),Ga(e,t)},n}function Mp(e,t,n){n=Zn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){Ga(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){Ga(e,t),typeof r!="function"&&(ws===null?ws=new Set([this]):ws.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function fu(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new nx;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=hx.bind(null,e,t,n),t.then(e,e))}function pu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function mu(e,t,n,r,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Zn(-1,1),t.tag=2,ys(n,t,1))),n.lanes|=1),e)}var sx=ss.ReactCurrentOwner,Kt=!1;function Bt(e,t,n,r){t.child=e===null?ap(t,null,n,r):Dr(t,e.child,n,r)}function gu(e,t,n,r,o){n=n.render;var l=t.ref;return Er(t,o),r=zc(e,t,n,r,l,o),n=Bc(),e!==null&&!Kt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,ns(e,t,o)):(pt&&n&&Ic(t),t.flags|=1,Bt(e,t,r,o),t.child)}function hu(e,t,n,r,o){if(e===null){var l=n.type;return typeof l=="function"&&!Xc(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,Rp(e,t,l,r,o)):(e=Tl(n.type,null,r,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&o)){var i=l.memoizedProps;if(n=n.compare,n=n!==null?n:To,n(i,r)&&e.ref===t.ref)return ns(e,t,o)}return t.flags|=1,e=Ns(l,r),e.ref=t.ref,e.return=t,t.child=e}function Rp(e,t,n,r,o){if(e!==null){var l=e.memoizedProps;if(To(l,r)&&e.ref===t.ref)if(Kt=!1,t.pendingProps=r=l,(e.lanes&o)!==0)e.flags&131072&&(Kt=!0);else return t.lanes=e.lanes,ns(e,t,o)}return Ha(e,t,n,r,o)}function _p(e,t,n){var r=t.pendingProps,o=r.children,l=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},lt(wr,tn),tn|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,lt(wr,tn),tn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:n,lt(wr,tn),tn|=r}else l!==null?(r=l.baseLanes|n,t.memoizedState=null):r=n,lt(wr,tn),tn|=r;return Bt(e,t,o,n),t.child}function Ap(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ha(e,t,n,r,o){var l=Qt(n)?Hs:Ot.current;return l=$r(t,l),Er(t,o),n=zc(e,t,n,r,l,o),r=Bc(),e!==null&&!Kt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,ns(e,t,o)):(pt&&r&&Ic(t),t.flags|=1,Bt(e,t,n,o),t.child)}function xu(e,t,n,r,o){if(Qt(n)){var l=!0;Ul(t)}else l=!1;if(Er(t,o),t.stateNode===null)Il(e,t),Tp(t,n,r),Wa(t,n,r,o),r=!0;else if(e===null){var i=t.stateNode,a=t.memoizedProps;i.props=a;var c=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=gn(u):(u=Qt(n)?Hs:Ot.current,u=$r(t,u));var m=n.getDerivedStateFromProps,E=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function";E||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==r||c!==u)&&uu(t,i,r,u),ds=!1;var S=t.memoizedState;i.state=S,Jl(t,r,i,o),c=t.memoizedState,a!==r||S!==c||Yt.current||ds?(typeof m=="function"&&(Ba(t,n,m,r),c=t.memoizedState),(a=ds||du(t,n,a,r,S,c,u))?(E||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=u,r=a):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,dp(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:jn(t.type,a),i.props=u,E=t.pendingProps,S=i.context,c=n.contextType,typeof c=="object"&&c!==null?c=gn(c):(c=Qt(n)?Hs:Ot.current,c=$r(t,c));var j=n.getDerivedStateFromProps;(m=typeof j=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==E||S!==c)&&uu(t,i,r,c),ds=!1,S=t.memoizedState,i.state=S,Jl(t,r,i,o);var L=t.memoizedState;a!==E||S!==L||Yt.current||ds?(typeof j=="function"&&(Ba(t,n,j,r),L=t.memoizedState),(u=ds||du(t,n,u,r,S,L,c)||!1)?(m||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,L,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,L,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=L),i.props=r,i.state=L,i.context=c,r=u):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),r=!1)}return Ua(e,t,n,r,l,o)}function Ua(e,t,n,r,o,l){Ap(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return o&&nu(t,n,!1),ns(e,t,l);r=t.stateNode,sx.current=t;var a=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=Dr(t,e.child,null,l),t.child=Dr(t,null,a,l)):Bt(e,t,a,l),t.memoizedState=r.state,o&&nu(t,n,!0),t.child}function Lp(e){var t=e.stateNode;t.pendingContext?tu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&tu(e,t.context,!1),Ac(e,t.containerInfo)}function vu(e,t,n,r,o){return Tr(),$c(o),t.flags|=256,Bt(e,t,n,r),t.child}var Va={dehydrated:null,treeContext:null,retryLane:0};function Ka(e){return{baseLanes:e,cachePool:null,transitions:null}}function Op(e,t,n){var r=t.pendingProps,o=gt.current,l=!1,i=(t.flags&128)!==0,a;if((a=i)||(a=e!==null&&e.memoizedState===null?!1:(o&2)!==0),a?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),lt(gt,o&1),e===null)return Fa(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,l?(r=t.mode,l=t.child,i={mode:"hidden",children:i},!(r&1)&&l!==null?(l.childLanes=0,l.pendingProps=i):l=wi(i,r,0,null),e=Gs(e,r,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=Ka(n),t.memoizedState=Va,e):Hc(t,i));if(o=e.memoizedState,o!==null&&(a=o.dehydrated,a!==null))return rx(e,t,i,r,a,o,n);if(l){l=r.fallback,i=t.mode,o=e.child,a=o.sibling;var c={mode:"hidden",children:r.children};return!(i&1)&&t.child!==o?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Ns(o,c),r.subtreeFlags=o.subtreeFlags&14680064),a!==null?l=Ns(a,l):(l=Gs(l,i,n,null),l.flags|=2),l.return=t,r.return=t,r.sibling=l,t.child=r,r=l,l=t.child,i=e.child.memoizedState,i=i===null?Ka(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},l.memoizedState=i,l.childLanes=e.childLanes&~n,t.memoizedState=Va,r}return l=e.child,e=l.sibling,r=Ns(l,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Hc(e,t){return t=wi({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ml(e,t,n,r){return r!==null&&$c(r),Dr(t,e.child,null,n),e=Hc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function rx(e,t,n,r,o,l,i){if(n)return t.flags&256?(t.flags&=-257,r=qi(Error(ue(422))),ml(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=r.fallback,o=t.mode,r=wi({mode:"visible",children:r.children},o,0,null),l=Gs(l,o,i,null),l.flags|=2,r.return=t,l.return=t,r.sibling=l,t.child=r,t.mode&1&&Dr(t,e.child,null,i),t.child.memoizedState=Ka(i),t.memoizedState=Va,l);if(!(t.mode&1))return ml(e,t,i,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var a=r.dgst;return r=a,l=Error(ue(419)),r=qi(l,r,void 0),ml(e,t,i,r)}if(a=(i&e.childLanes)!==0,Kt||a){if(r=It,r!==null){switch(i&-i){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|i)?0:o,o!==0&&o!==l.retryLane&&(l.retryLane=o,ts(e,o),Pn(r,e,o,-1))}return Jc(),r=qi(Error(ue(421))),ml(e,t,i,r)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=xx.bind(null,e),o._reactRetry=t,null):(e=l.treeContext,nn=bs(o.nextSibling),sn=t,pt=!0,Cn=null,e!==null&&(dn[un++]=Jn,dn[un++]=Xn,dn[un++]=Us,Jn=e.id,Xn=e.overflow,Us=t),t=Hc(t,r.children),t.flags|=4096,t)}function bu(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),za(e.return,t,n)}function ea(e,t,n,r,o){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=o)}function Fp(e,t,n){var r=t.pendingProps,o=r.revealOrder,l=r.tail;if(Bt(e,t,r.children,n),r=gt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&bu(e,n,t);else if(e.tag===19)bu(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(lt(gt,r),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&Xl(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),ea(t,!1,o,n,l);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&Xl(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}ea(t,!0,n,null,l);break;case"together":ea(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Il(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ns(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ks|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ue(153));if(t.child!==null){for(e=t.child,n=Ns(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ns(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function ox(e,t,n){switch(t.tag){case 3:Lp(t),Tr();break;case 5:up(t);break;case 1:Qt(t.type)&&Ul(t);break;case 4:Ac(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;lt(Yl,r._currentValue),r._currentValue=o;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(lt(gt,gt.current&1),t.flags|=128,null):n&t.child.childLanes?Op(e,t,n):(lt(gt,gt.current&1),e=ns(e,t,n),e!==null?e.sibling:null);lt(gt,gt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Fp(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),lt(gt,gt.current),r)break;return null;case 22:case 23:return t.lanes=0,_p(e,t,n)}return ns(e,t,n)}var zp,Ya,Bp,Wp;zp=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ya=function(){};Bp=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Bs(Wn.current);var l=null;switch(n){case"input":o=ha(e,o),r=ha(e,r),l=[];break;case"select":o=xt({},o,{value:void 0}),r=xt({},r,{value:void 0}),l=[];break;case"textarea":o=ba(e,o),r=ba(e,r),l=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Gl)}wa(n,r);var i;n=null;for(u in o)if(!r.hasOwnProperty(u)&&o.hasOwnProperty(u)&&o[u]!=null)if(u==="style"){var a=o[u];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(jo.hasOwnProperty(u)?l||(l=[]):(l=l||[]).push(u,null));for(u in r){var c=r[u];if(a=o!=null?o[u]:void 0,r.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(i in a)!a.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&a[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(l||(l=[]),l.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(l=l||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(l=l||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(jo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ut("scroll",e),l||a===c||(l=[])):(l=l||[]).push(u,c))}n&&(l=l||[]).push("style",n);var u=l;(t.updateQueue=u)&&(t.flags|=4)}};Wp=function(e,t,n,r){n!==r&&(t.flags|=4)};function qr(e,t){if(!pt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function At(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function lx(e,t,n){var r=t.pendingProps;switch(Pc(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(t),null;case 1:return Qt(t.type)&&Hl(),At(t),null;case 3:return r=t.stateNode,Mr(),ft(Yt),ft(Ot),Oc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(fl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Cn!==null&&(nc(Cn),Cn=null))),Ya(e,t),At(t),null;case 5:Lc(t);var o=Bs(Ao.current);if(n=t.type,e!==null&&t.stateNode!=null)Bp(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ue(166));return At(t),null}if(e=Bs(Wn.current),fl(t)){r=t.stateNode,n=t.type;var l=t.memoizedProps;switch(r[zn]=t,r[Ro]=l,e=(t.mode&1)!==0,n){case"dialog":ut("cancel",r),ut("close",r);break;case"iframe":case"object":case"embed":ut("load",r);break;case"video":case"audio":for(o=0;o<io.length;o++)ut(io[o],r);break;case"source":ut("error",r);break;case"img":case"image":case"link":ut("error",r),ut("load",r);break;case"details":ut("toggle",r);break;case"input":Id(r,l),ut("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},ut("invalid",r);break;case"textarea":$d(r,l),ut("invalid",r)}wa(n,l),o=null;for(var i in l)if(l.hasOwnProperty(i)){var a=l[i];i==="children"?typeof a=="string"?r.textContent!==a&&(l.suppressHydrationWarning!==!0&&ul(r.textContent,a,e),o=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(l.suppressHydrationWarning!==!0&&ul(r.textContent,a,e),o=["children",""+a]):jo.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&ut("scroll",r)}switch(n){case"input":sl(r),Pd(r,l,!0);break;case"textarea":sl(r),Td(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=Gl)}r=o,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=hf(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(n,{is:r.is}):(e=i.createElement(n),n==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,n),e[zn]=t,e[Ro]=r,zp(e,t,!1,!1),t.stateNode=e;e:{switch(i=Sa(n,r),n){case"dialog":ut("cancel",e),ut("close",e),o=r;break;case"iframe":case"object":case"embed":ut("load",e),o=r;break;case"video":case"audio":for(o=0;o<io.length;o++)ut(io[o],e);o=r;break;case"source":ut("error",e),o=r;break;case"img":case"image":case"link":ut("error",e),ut("load",e),o=r;break;case"details":ut("toggle",e),o=r;break;case"input":Id(e,r),o=ha(e,r),ut("invalid",e);break;case"option":o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=xt({},r,{value:void 0}),ut("invalid",e);break;case"textarea":$d(e,r),o=ba(e,r),ut("invalid",e);break;default:o=r}wa(n,o),a=o;for(l in a)if(a.hasOwnProperty(l)){var c=a[l];l==="style"?bf(e,c):l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&xf(e,c)):l==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ko(e,c):typeof c=="number"&&ko(e,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(jo.hasOwnProperty(l)?c!=null&&l==="onScroll"&&ut("scroll",e):c!=null&&mc(e,l,c,i))}switch(n){case"input":sl(e),Pd(e,r,!1);break;case"textarea":sl(e),Td(e);break;case"option":r.value!=null&&e.setAttribute("value",""+js(r.value));break;case"select":e.multiple=!!r.multiple,l=r.value,l!=null?Nr(e,!!r.multiple,l,!1):r.defaultValue!=null&&Nr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Gl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return At(t),null;case 6:if(e&&t.stateNode!=null)Wp(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ue(166));if(n=Bs(Ao.current),Bs(Wn.current),fl(t)){if(r=t.stateNode,n=t.memoizedProps,r[zn]=t,(l=r.nodeValue!==n)&&(e=sn,e!==null))switch(e.tag){case 3:ul(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ul(r.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[zn]=t,t.stateNode=r}return At(t),null;case 13:if(ft(gt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(pt&&nn!==null&&t.mode&1&&!(t.flags&128))lp(),Tr(),t.flags|=98560,l=!1;else if(l=fl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!l)throw Error(ue(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(ue(317));l[zn]=t}else Tr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;At(t),l=!1}else Cn!==null&&(nc(Cn),Cn=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||gt.current&1?kt===0&&(kt=3):Jc())),t.updateQueue!==null&&(t.flags|=4),At(t),null);case 4:return Mr(),Ya(e,t),e===null&&Do(t.stateNode.containerInfo),At(t),null;case 10:return Mc(t.type._context),At(t),null;case 17:return Qt(t.type)&&Hl(),At(t),null;case 19:if(ft(gt),l=t.memoizedState,l===null)return At(t),null;if(r=(t.flags&128)!==0,i=l.rendering,i===null)if(r)qr(l,!1);else{if(kt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Xl(e),i!==null){for(t.flags|=128,qr(l,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)l=n,e=r,l.flags&=14680066,i=l.alternate,i===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,l.type=i.type,e=i.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return lt(gt,gt.current&1|2),t.child}e=e.sibling}l.tail!==null&&St()>_r&&(t.flags|=128,r=!0,qr(l,!1),t.lanes=4194304)}else{if(!r)if(e=Xl(i),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),qr(l,!0),l.tail===null&&l.tailMode==="hidden"&&!i.alternate&&!pt)return At(t),null}else 2*St()-l.renderingStartTime>_r&&n!==1073741824&&(t.flags|=128,r=!0,qr(l,!1),t.lanes=4194304);l.isBackwards?(i.sibling=t.child,t.child=i):(n=l.last,n!==null?n.sibling=i:t.child=i,l.last=i)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=St(),t.sibling=null,n=gt.current,lt(gt,r?n&1|2:n&1),t):(At(t),null);case 22:case 23:return Qc(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?tn&1073741824&&(At(t),t.subtreeFlags&6&&(t.flags|=8192)):At(t),null;case 24:return null;case 25:return null}throw Error(ue(156,t.tag))}function ix(e,t){switch(Pc(t),t.tag){case 1:return Qt(t.type)&&Hl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Mr(),ft(Yt),ft(Ot),Oc(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Lc(t),null;case 13:if(ft(gt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ue(340));Tr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ft(gt),null;case 4:return Mr(),null;case 10:return Mc(t.type._context),null;case 22:case 23:return Qc(),null;case 24:return null;default:return null}}var gl=!1,Lt=!1,ax=typeof WeakSet=="function"?WeakSet:Set,Se=null;function yr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){yt(e,t,r)}else n.current=null}function Qa(e,t,n){try{n()}catch(r){yt(e,t,r)}}var yu=!1;function cx(e,t){if(Da=zl,e=Kf(),Ec(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var i=0,a=-1,c=-1,u=0,m=0,E=e,S=null;t:for(;;){for(var j;E!==n||o!==0&&E.nodeType!==3||(a=i+o),E!==l||r!==0&&E.nodeType!==3||(c=i+r),E.nodeType===3&&(i+=E.nodeValue.length),(j=E.firstChild)!==null;)S=E,E=j;for(;;){if(E===e)break t;if(S===n&&++u===o&&(a=i),S===l&&++m===r&&(c=i),(j=E.nextSibling)!==null)break;E=S,S=E.parentNode}E=j}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ma={focusedElem:e,selectionRange:n},zl=!1,Se=t;Se!==null;)if(t=Se,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Se=e;else for(;Se!==null;){t=Se;try{var L=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(L!==null){var N=L.memoizedProps,W=L.memoizedState,x=t.stateNode,f=x.getSnapshotBeforeUpdate(t.elementType===t.type?N:jn(t.type,N),W);x.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ue(163))}}catch(D){yt(t,t.return,D)}if(e=t.sibling,e!==null){e.return=t.return,Se=e;break}Se=t.return}return L=yu,yu=!1,L}function vo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var l=o.destroy;o.destroy=void 0,l!==void 0&&Qa(t,n,l)}o=o.next}while(o!==r)}}function bi(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Ja(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Gp(e){var t=e.alternate;t!==null&&(e.alternate=null,Gp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[zn],delete t[Ro],delete t[Aa],delete t[Uh],delete t[Vh])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Hp(e){return e.tag===5||e.tag===3||e.tag===4}function wu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Hp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Xa(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Gl));else if(r!==4&&(e=e.child,e!==null))for(Xa(e,t,n),e=e.sibling;e!==null;)Xa(e,t,n),e=e.sibling}function Za(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Za(e,t,n),e=e.sibling;e!==null;)Za(e,t,n),e=e.sibling}var Tt=null,kn=!1;function ls(e,t,n){for(n=n.child;n!==null;)Up(e,t,n),n=n.sibling}function Up(e,t,n){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(ui,n)}catch{}switch(n.tag){case 5:Lt||yr(n,t);case 6:var r=Tt,o=kn;Tt=null,ls(e,t,n),Tt=r,kn=o,Tt!==null&&(kn?(e=Tt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Tt.removeChild(n.stateNode));break;case 18:Tt!==null&&(kn?(e=Tt,n=n.stateNode,e.nodeType===8?Ki(e.parentNode,n):e.nodeType===1&&Ki(e,n),Po(e)):Ki(Tt,n.stateNode));break;case 4:r=Tt,o=kn,Tt=n.stateNode.containerInfo,kn=!0,ls(e,t,n),Tt=r,kn=o;break;case 0:case 11:case 14:case 15:if(!Lt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var l=o,i=l.destroy;l=l.tag,i!==void 0&&(l&2||l&4)&&Qa(n,t,i),o=o.next}while(o!==r)}ls(e,t,n);break;case 1:if(!Lt&&(yr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){yt(n,t,a)}ls(e,t,n);break;case 21:ls(e,t,n);break;case 22:n.mode&1?(Lt=(r=Lt)||n.memoizedState!==null,ls(e,t,n),Lt=r):ls(e,t,n);break;default:ls(e,t,n)}}function Su(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new ax),t.forEach(function(r){var o=vx.bind(null,e,r);n.has(r)||(n.add(r),r.then(o,o))})}}function wn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var l=e,i=t,a=i;e:for(;a!==null;){switch(a.tag){case 5:Tt=a.stateNode,kn=!1;break e;case 3:Tt=a.stateNode.containerInfo,kn=!0;break e;case 4:Tt=a.stateNode.containerInfo,kn=!0;break e}a=a.return}if(Tt===null)throw Error(ue(160));Up(l,i,o),Tt=null,kn=!1;var c=o.alternate;c!==null&&(c.return=null),o.return=null}catch(u){yt(o,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Vp(t,e),t=t.sibling}function Vp(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(wn(t,e),An(e),r&4){try{vo(3,e,e.return),bi(3,e)}catch(N){yt(e,e.return,N)}try{vo(5,e,e.return)}catch(N){yt(e,e.return,N)}}break;case 1:wn(t,e),An(e),r&512&&n!==null&&yr(n,n.return);break;case 5:if(wn(t,e),An(e),r&512&&n!==null&&yr(n,n.return),e.flags&32){var o=e.stateNode;try{ko(o,"")}catch(N){yt(e,e.return,N)}}if(r&4&&(o=e.stateNode,o!=null)){var l=e.memoizedProps,i=n!==null?n.memoizedProps:l,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&l.type==="radio"&&l.name!=null&&mf(o,l),Sa(a,i);var u=Sa(a,l);for(i=0;i<c.length;i+=2){var m=c[i],E=c[i+1];m==="style"?bf(o,E):m==="dangerouslySetInnerHTML"?xf(o,E):m==="children"?ko(o,E):mc(o,m,E,u)}switch(a){case"input":xa(o,l);break;case"textarea":gf(o,l);break;case"select":var S=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!l.multiple;var j=l.value;j!=null?Nr(o,!!l.multiple,j,!1):S!==!!l.multiple&&(l.defaultValue!=null?Nr(o,!!l.multiple,l.defaultValue,!0):Nr(o,!!l.multiple,l.multiple?[]:"",!1))}o[Ro]=l}catch(N){yt(e,e.return,N)}}break;case 6:if(wn(t,e),An(e),r&4){if(e.stateNode===null)throw Error(ue(162));o=e.stateNode,l=e.memoizedProps;try{o.nodeValue=l}catch(N){yt(e,e.return,N)}}break;case 3:if(wn(t,e),An(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Po(t.containerInfo)}catch(N){yt(e,e.return,N)}break;case 4:wn(t,e),An(e);break;case 13:wn(t,e),An(e),o=e.child,o.flags&8192&&(l=o.memoizedState!==null,o.stateNode.isHidden=l,!l||o.alternate!==null&&o.alternate.memoizedState!==null||(Kc=St())),r&4&&Su(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(Lt=(u=Lt)||m,wn(t,e),Lt=u):wn(t,e),An(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!m&&e.mode&1)for(Se=e,m=e.child;m!==null;){for(E=Se=m;Se!==null;){switch(S=Se,j=S.child,S.tag){case 0:case 11:case 14:case 15:vo(4,S,S.return);break;case 1:yr(S,S.return);var L=S.stateNode;if(typeof L.componentWillUnmount=="function"){r=S,n=S.return;try{t=r,L.props=t.memoizedProps,L.state=t.memoizedState,L.componentWillUnmount()}catch(N){yt(r,n,N)}}break;case 5:yr(S,S.return);break;case 22:if(S.memoizedState!==null){ju(E);continue}}j!==null?(j.return=S,Se=j):ju(E)}m=m.sibling}e:for(m=null,E=e;;){if(E.tag===5){if(m===null){m=E;try{o=E.stateNode,u?(l=o.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(a=E.stateNode,c=E.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=vf("display",i))}catch(N){yt(e,e.return,N)}}}else if(E.tag===6){if(m===null)try{E.stateNode.nodeValue=u?"":E.memoizedProps}catch(N){yt(e,e.return,N)}}else if((E.tag!==22&&E.tag!==23||E.memoizedState===null||E===e)&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===e)break e;for(;E.sibling===null;){if(E.return===null||E.return===e)break e;m===E&&(m=null),E=E.return}m===E&&(m=null),E.sibling.return=E.return,E=E.sibling}}break;case 19:wn(t,e),An(e),r&4&&Su(e);break;case 21:break;default:wn(t,e),An(e)}}function An(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Hp(n)){var r=n;break e}n=n.return}throw Error(ue(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(ko(o,""),r.flags&=-33);var l=wu(e);Za(e,l,o);break;case 3:case 4:var i=r.stateNode.containerInfo,a=wu(e);Xa(e,a,i);break;default:throw Error(ue(161))}}catch(c){yt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function dx(e,t,n){Se=e,Kp(e)}function Kp(e,t,n){for(var r=(e.mode&1)!==0;Se!==null;){var o=Se,l=o.child;if(o.tag===22&&r){var i=o.memoizedState!==null||gl;if(!i){var a=o.alternate,c=a!==null&&a.memoizedState!==null||Lt;a=gl;var u=Lt;if(gl=i,(Lt=c)&&!u)for(Se=o;Se!==null;)i=Se,c=i.child,i.tag===22&&i.memoizedState!==null?ku(o):c!==null?(c.return=i,Se=c):ku(o);for(;l!==null;)Se=l,Kp(l),l=l.sibling;Se=o,gl=a,Lt=u}Nu(e)}else o.subtreeFlags&8772&&l!==null?(l.return=o,Se=l):Nu(e)}}function Nu(e){for(;Se!==null;){var t=Se;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Lt||bi(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Lt)if(n===null)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:jn(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&iu(t,l,r);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}iu(t,i,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var m=u.memoizedState;if(m!==null){var E=m.dehydrated;E!==null&&Po(E)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ue(163))}Lt||t.flags&512&&Ja(t)}catch(S){yt(t,t.return,S)}}if(t===e){Se=null;break}if(n=t.sibling,n!==null){n.return=t.return,Se=n;break}Se=t.return}}function ju(e){for(;Se!==null;){var t=Se;if(t===e){Se=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Se=n;break}Se=t.return}}function ku(e){for(;Se!==null;){var t=Se;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{bi(4,t)}catch(c){yt(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var o=t.return;try{r.componentDidMount()}catch(c){yt(t,o,c)}}var l=t.return;try{Ja(t)}catch(c){yt(t,l,c)}break;case 5:var i=t.return;try{Ja(t)}catch(c){yt(t,i,c)}}}catch(c){yt(t,t.return,c)}if(t===e){Se=null;break}var a=t.sibling;if(a!==null){a.return=t.return,Se=a;break}Se=t.return}}var ux=Math.ceil,ei=ss.ReactCurrentDispatcher,Uc=ss.ReactCurrentOwner,mn=ss.ReactCurrentBatchConfig,Je=0,It=null,Nt=null,Dt=0,tn=0,wr=Is(0),kt=0,zo=null,Ks=0,yi=0,Vc=0,bo=null,Vt=null,Kc=0,_r=1/0,Yn=null,ti=!1,qa=null,ws=null,hl=!1,gs=null,ni=0,yo=0,ec=null,Pl=-1,$l=0;function Wt(){return Je&6?St():Pl!==-1?Pl:Pl=St()}function Ss(e){return e.mode&1?Je&2&&Dt!==0?Dt&-Dt:Yh.transition!==null?($l===0&&($l=Tf()),$l):(e=tt,e!==0||(e=window.event,e=e===void 0?16:Of(e.type)),e):1}function Pn(e,t,n,r){if(50<yo)throw yo=0,ec=null,Error(ue(185));Wo(e,n,r),(!(Je&2)||e!==It)&&(e===It&&(!(Je&2)&&(yi|=n),kt===4&&ps(e,Dt)),Jt(e,r),n===1&&Je===0&&!(t.mode&1)&&(_r=St()+500,hi&&Ps()))}function Jt(e,t){var n=e.callbackNode;Yg(e,t);var r=Fl(e,e===It?Dt:0);if(r===0)n!==null&&Rd(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Rd(n),t===1)e.tag===0?Kh(Cu.bind(null,e)):sp(Cu.bind(null,e)),Gh(function(){!(Je&6)&&Ps()}),n=null;else{switch(Df(r)){case 1:n=bc;break;case 4:n=Pf;break;case 16:n=Ol;break;case 536870912:n=$f;break;default:n=Ol}n=tm(n,Yp.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Yp(e,t){if(Pl=-1,$l=0,Je&6)throw Error(ue(327));var n=e.callbackNode;if(Ir()&&e.callbackNode!==n)return null;var r=Fl(e,e===It?Dt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=si(e,r);else{t=r;var o=Je;Je|=2;var l=Jp();(It!==e||Dt!==t)&&(Yn=null,_r=St()+500,Ws(e,t));do try{mx();break}catch(a){Qp(e,a)}while(!0);Dc(),ei.current=l,Je=o,Nt!==null?t=0:(It=null,Dt=0,t=kt)}if(t!==0){if(t===2&&(o=Ea(e),o!==0&&(r=o,t=tc(e,o))),t===1)throw n=zo,Ws(e,0),ps(e,r),Jt(e,St()),n;if(t===6)ps(e,r);else{if(o=e.current.alternate,!(r&30)&&!fx(o)&&(t=si(e,r),t===2&&(l=Ea(e),l!==0&&(r=l,t=tc(e,l))),t===1))throw n=zo,Ws(e,0),ps(e,r),Jt(e,St()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(ue(345));case 2:Ls(e,Vt,Yn);break;case 3:if(ps(e,r),(r&130023424)===r&&(t=Kc+500-St(),10<t)){if(Fl(e,0)!==0)break;if(o=e.suspendedLanes,(o&r)!==r){Wt(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=_a(Ls.bind(null,e,Vt,Yn),t);break}Ls(e,Vt,Yn);break;case 4:if(ps(e,r),(r&4194240)===r)break;for(t=e.eventTimes,o=-1;0<r;){var i=31-In(r);l=1<<i,i=t[i],i>o&&(o=i),r&=~l}if(r=o,r=St()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ux(r/1960))-r,10<r){e.timeoutHandle=_a(Ls.bind(null,e,Vt,Yn),r);break}Ls(e,Vt,Yn);break;case 5:Ls(e,Vt,Yn);break;default:throw Error(ue(329))}}}return Jt(e,St()),e.callbackNode===n?Yp.bind(null,e):null}function tc(e,t){var n=bo;return e.current.memoizedState.isDehydrated&&(Ws(e,t).flags|=256),e=si(e,t),e!==2&&(t=Vt,Vt=n,t!==null&&nc(t)),e}function nc(e){Vt===null?Vt=e:Vt.push.apply(Vt,e)}function fx(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],l=o.getSnapshot;o=o.value;try{if(!$n(l(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ps(e,t){for(t&=~Vc,t&=~yi,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-In(t),r=1<<n;e[n]=-1,t&=~r}}function Cu(e){if(Je&6)throw Error(ue(327));Ir();var t=Fl(e,0);if(!(t&1))return Jt(e,St()),null;var n=si(e,t);if(e.tag!==0&&n===2){var r=Ea(e);r!==0&&(t=r,n=tc(e,r))}if(n===1)throw n=zo,Ws(e,0),ps(e,t),Jt(e,St()),n;if(n===6)throw Error(ue(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ls(e,Vt,Yn),Jt(e,St()),null}function Yc(e,t){var n=Je;Je|=1;try{return e(t)}finally{Je=n,Je===0&&(_r=St()+500,hi&&Ps())}}function Ys(e){gs!==null&&gs.tag===0&&!(Je&6)&&Ir();var t=Je;Je|=1;var n=mn.transition,r=tt;try{if(mn.transition=null,tt=1,e)return e()}finally{tt=r,mn.transition=n,Je=t,!(Je&6)&&Ps()}}function Qc(){tn=wr.current,ft(wr)}function Ws(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Wh(n)),Nt!==null)for(n=Nt.return;n!==null;){var r=n;switch(Pc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Hl();break;case 3:Mr(),ft(Yt),ft(Ot),Oc();break;case 5:Lc(r);break;case 4:Mr();break;case 13:ft(gt);break;case 19:ft(gt);break;case 10:Mc(r.type._context);break;case 22:case 23:Qc()}n=n.return}if(It=e,Nt=e=Ns(e.current,null),Dt=tn=t,kt=0,zo=null,Vc=yi=Ks=0,Vt=bo=null,zs!==null){for(t=0;t<zs.length;t++)if(n=zs[t],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,l=n.pending;if(l!==null){var i=l.next;l.next=o,r.next=i}n.pending=r}zs=null}return e}function Qp(e,t){do{var n=Nt;try{if(Dc(),Cl.current=ql,Zl){for(var r=ht.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Zl=!1}if(Vs=0,Et=jt=ht=null,xo=!1,Lo=0,Uc.current=null,n===null||n.return===null){kt=1,zo=t,Nt=null;break}e:{var l=e,i=n.return,a=n,c=t;if(t=Dt,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,m=a,E=m.tag;if(!(m.mode&1)&&(E===0||E===11||E===15)){var S=m.alternate;S?(m.updateQueue=S.updateQueue,m.memoizedState=S.memoizedState,m.lanes=S.lanes):(m.updateQueue=null,m.memoizedState=null)}var j=pu(i);if(j!==null){j.flags&=-257,mu(j,i,a,l,t),j.mode&1&&fu(l,u,t),t=j,c=u;var L=t.updateQueue;if(L===null){var N=new Set;N.add(c),t.updateQueue=N}else L.add(c);break e}else{if(!(t&1)){fu(l,u,t),Jc();break e}c=Error(ue(426))}}else if(pt&&a.mode&1){var W=pu(i);if(W!==null){!(W.flags&65536)&&(W.flags|=256),mu(W,i,a,l,t),$c(Rr(c,a));break e}}l=c=Rr(c,a),kt!==4&&(kt=2),bo===null?bo=[l]:bo.push(l),l=i;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var x=Dp(l,c,t);lu(l,x);break e;case 1:a=c;var f=l.type,v=l.stateNode;if(!(l.flags&128)&&(typeof f.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ws===null||!ws.has(v)))){l.flags|=65536,t&=-t,l.lanes|=t;var D=Mp(l,a,t);lu(l,D);break e}}l=l.return}while(l!==null)}Zp(n)}catch(M){t=M,Nt===n&&n!==null&&(Nt=n=n.return);continue}break}while(!0)}function Jp(){var e=ei.current;return ei.current=ql,e===null?ql:e}function Jc(){(kt===0||kt===3||kt===2)&&(kt=4),It===null||!(Ks&268435455)&&!(yi&268435455)||ps(It,Dt)}function si(e,t){var n=Je;Je|=2;var r=Jp();(It!==e||Dt!==t)&&(Yn=null,Ws(e,t));do try{px();break}catch(o){Qp(e,o)}while(!0);if(Dc(),Je=n,ei.current=r,Nt!==null)throw Error(ue(261));return It=null,Dt=0,kt}function px(){for(;Nt!==null;)Xp(Nt)}function mx(){for(;Nt!==null&&!Fg();)Xp(Nt)}function Xp(e){var t=em(e.alternate,e,tn);e.memoizedProps=e.pendingProps,t===null?Zp(e):Nt=t,Uc.current=null}function Zp(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=ix(n,t),n!==null){n.flags&=32767,Nt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{kt=6,Nt=null;return}}else if(n=lx(n,t,tn),n!==null){Nt=n;return}if(t=t.sibling,t!==null){Nt=t;return}Nt=t=e}while(t!==null);kt===0&&(kt=5)}function Ls(e,t,n){var r=tt,o=mn.transition;try{mn.transition=null,tt=1,gx(e,t,n,r)}finally{mn.transition=o,tt=r}return null}function gx(e,t,n,r){do Ir();while(gs!==null);if(Je&6)throw Error(ue(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ue(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(Qg(e,l),e===It&&(Nt=It=null,Dt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||hl||(hl=!0,tm(Ol,function(){return Ir(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=mn.transition,mn.transition=null;var i=tt;tt=1;var a=Je;Je|=4,Uc.current=null,cx(e,n),Vp(n,e),_h(Ma),zl=!!Da,Ma=Da=null,e.current=n,dx(n),zg(),Je=a,tt=i,mn.transition=l}else e.current=n;if(hl&&(hl=!1,gs=e,ni=o),l=e.pendingLanes,l===0&&(ws=null),Gg(n.stateNode),Jt(e,St()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(ti)throw ti=!1,e=qa,qa=null,e;return ni&1&&e.tag!==0&&Ir(),l=e.pendingLanes,l&1?e===ec?yo++:(yo=0,ec=e):yo=0,Ps(),null}function Ir(){if(gs!==null){var e=Df(ni),t=mn.transition,n=tt;try{if(mn.transition=null,tt=16>e?16:e,gs===null)var r=!1;else{if(e=gs,gs=null,ni=0,Je&6)throw Error(ue(331));var o=Je;for(Je|=4,Se=e.current;Se!==null;){var l=Se,i=l.child;if(Se.flags&16){var a=l.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(Se=u;Se!==null;){var m=Se;switch(m.tag){case 0:case 11:case 15:vo(8,m,l)}var E=m.child;if(E!==null)E.return=m,Se=E;else for(;Se!==null;){m=Se;var S=m.sibling,j=m.return;if(Gp(m),m===u){Se=null;break}if(S!==null){S.return=j,Se=S;break}Se=j}}}var L=l.alternate;if(L!==null){var N=L.child;if(N!==null){L.child=null;do{var W=N.sibling;N.sibling=null,N=W}while(N!==null)}}Se=l}}if(l.subtreeFlags&2064&&i!==null)i.return=l,Se=i;else e:for(;Se!==null;){if(l=Se,l.flags&2048)switch(l.tag){case 0:case 11:case 15:vo(9,l,l.return)}var x=l.sibling;if(x!==null){x.return=l.return,Se=x;break e}Se=l.return}}var f=e.current;for(Se=f;Se!==null;){i=Se;var v=i.child;if(i.subtreeFlags&2064&&v!==null)v.return=i,Se=v;else e:for(i=f;Se!==null;){if(a=Se,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:bi(9,a)}}catch(M){yt(a,a.return,M)}if(a===i){Se=null;break e}var D=a.sibling;if(D!==null){D.return=a.return,Se=D;break e}Se=a.return}}if(Je=o,Ps(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(ui,e)}catch{}r=!0}return r}finally{tt=n,mn.transition=t}}return!1}function Eu(e,t,n){t=Rr(n,t),t=Dp(e,t,1),e=ys(e,t,1),t=Wt(),e!==null&&(Wo(e,1,t),Jt(e,t))}function yt(e,t,n){if(e.tag===3)Eu(e,e,n);else for(;t!==null;){if(t.tag===3){Eu(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ws===null||!ws.has(r))){e=Rr(n,e),e=Mp(t,e,1),t=ys(t,e,1),e=Wt(),t!==null&&(Wo(t,1,e),Jt(t,e));break}}t=t.return}}function hx(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Wt(),e.pingedLanes|=e.suspendedLanes&n,It===e&&(Dt&n)===n&&(kt===4||kt===3&&(Dt&130023424)===Dt&&500>St()-Kc?Ws(e,0):Vc|=n),Jt(e,t)}function qp(e,t){t===0&&(e.mode&1?(t=ll,ll<<=1,!(ll&130023424)&&(ll=4194304)):t=1);var n=Wt();e=ts(e,t),e!==null&&(Wo(e,t,n),Jt(e,n))}function xx(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),qp(e,n)}function vx(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ue(314))}r!==null&&r.delete(t),qp(e,n)}var em;em=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Yt.current)Kt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Kt=!1,ox(e,t,n);Kt=!!(e.flags&131072)}else Kt=!1,pt&&t.flags&1048576&&rp(t,Kl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Il(e,t),e=t.pendingProps;var o=$r(t,Ot.current);Er(t,n),o=zc(null,t,r,e,o,n);var l=Bc();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Qt(r)?(l=!0,Ul(t)):l=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,_c(t),o.updater=vi,t.stateNode=o,o._reactInternals=t,Wa(t,r,e,n),t=Ua(null,t,r,!0,l,n)):(t.tag=0,pt&&l&&Ic(t),Bt(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Il(e,t),e=t.pendingProps,o=r._init,r=o(r._payload),t.type=r,o=t.tag=yx(r),e=jn(r,e),o){case 0:t=Ha(null,t,r,e,n);break e;case 1:t=xu(null,t,r,e,n);break e;case 11:t=gu(null,t,r,e,n);break e;case 14:t=hu(null,t,r,jn(r.type,e),n);break e}throw Error(ue(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:jn(r,o),Ha(e,t,r,o,n);case 1:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:jn(r,o),xu(e,t,r,o,n);case 3:e:{if(Lp(t),e===null)throw Error(ue(387));r=t.pendingProps,l=t.memoizedState,o=l.element,dp(e,t),Jl(t,r,null,n);var i=t.memoizedState;if(r=i.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){o=Rr(Error(ue(423)),t),t=vu(e,t,r,n,o);break e}else if(r!==o){o=Rr(Error(ue(424)),t),t=vu(e,t,r,n,o);break e}else for(nn=bs(t.stateNode.containerInfo.firstChild),sn=t,pt=!0,Cn=null,n=ap(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Tr(),r===o){t=ns(e,t,n);break e}Bt(e,t,r,n)}t=t.child}return t;case 5:return up(t),e===null&&Fa(t),r=t.type,o=t.pendingProps,l=e!==null?e.memoizedProps:null,i=o.children,Ra(r,o)?i=null:l!==null&&Ra(r,l)&&(t.flags|=32),Ap(e,t),Bt(e,t,i,n),t.child;case 6:return e===null&&Fa(t),null;case 13:return Op(e,t,n);case 4:return Ac(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Dr(t,null,r,n):Bt(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:jn(r,o),gu(e,t,r,o,n);case 7:return Bt(e,t,t.pendingProps,n),t.child;case 8:return Bt(e,t,t.pendingProps.children,n),t.child;case 12:return Bt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,l=t.memoizedProps,i=o.value,lt(Yl,r._currentValue),r._currentValue=i,l!==null)if($n(l.value,i)){if(l.children===o.children&&!Yt.current){t=ns(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var a=l.dependencies;if(a!==null){i=l.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(l.tag===1){c=Zn(-1,n&-n),c.tag=2;var u=l.updateQueue;if(u!==null){u=u.shared;var m=u.pending;m===null?c.next=c:(c.next=m.next,m.next=c),u.pending=c}}l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),za(l.return,n,t),a.lanes|=n;break}c=c.next}}else if(l.tag===10)i=l.type===t.type?null:l.child;else if(l.tag===18){if(i=l.return,i===null)throw Error(ue(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),za(i,n,t),i=l.sibling}else i=l.child;if(i!==null)i.return=l;else for(i=l;i!==null;){if(i===t){i=null;break}if(l=i.sibling,l!==null){l.return=i.return,i=l;break}i=i.return}l=i}Bt(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,Er(t,n),o=gn(o),r=r(o),t.flags|=1,Bt(e,t,r,n),t.child;case 14:return r=t.type,o=jn(r,t.pendingProps),o=jn(r.type,o),hu(e,t,r,o,n);case 15:return Rp(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:jn(r,o),Il(e,t),t.tag=1,Qt(r)?(e=!0,Ul(t)):e=!1,Er(t,n),Tp(t,r,o),Wa(t,r,o,n),Ua(null,t,r,!0,e,n);case 19:return Fp(e,t,n);case 22:return _p(e,t,n)}throw Error(ue(156,t.tag))};function tm(e,t){return If(e,t)}function bx(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fn(e,t,n,r){return new bx(e,t,n,r)}function Xc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function yx(e){if(typeof e=="function")return Xc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===hc)return 11;if(e===xc)return 14}return 2}function Ns(e,t){var n=e.alternate;return n===null?(n=fn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Tl(e,t,n,r,o,l){var i=2;if(r=e,typeof e=="function")Xc(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case ur:return Gs(n.children,o,l,t);case gc:i=8,o|=8;break;case fa:return e=fn(12,n,t,o|2),e.elementType=fa,e.lanes=l,e;case pa:return e=fn(13,n,t,o),e.elementType=pa,e.lanes=l,e;case ma:return e=fn(19,n,t,o),e.elementType=ma,e.lanes=l,e;case uf:return wi(n,o,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case cf:i=10;break e;case df:i=9;break e;case hc:i=11;break e;case xc:i=14;break e;case cs:i=16,r=null;break e}throw Error(ue(130,e==null?e:typeof e,""))}return t=fn(i,n,t,o),t.elementType=e,t.type=r,t.lanes=l,t}function Gs(e,t,n,r){return e=fn(7,e,r,t),e.lanes=n,e}function wi(e,t,n,r){return e=fn(22,e,r,t),e.elementType=uf,e.lanes=n,e.stateNode={isHidden:!1},e}function ta(e,t,n){return e=fn(6,e,null,t),e.lanes=n,e}function na(e,t,n){return t=fn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function wx(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ai(0),this.expirationTimes=Ai(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ai(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Zc(e,t,n,r,o,l,i,a,c){return e=new wx(e,t,n,a,c),t===1?(t=1,l===!0&&(t|=8)):t=0,l=fn(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},_c(l),e}function Sx(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function nm(e){if(!e)return ks;e=e._reactInternals;e:{if(Zs(e)!==e||e.tag!==1)throw Error(ue(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Qt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ue(171))}if(e.tag===1){var n=e.type;if(Qt(n))return np(e,n,t)}return t}function sm(e,t,n,r,o,l,i,a,c){return e=Zc(n,r,!0,e,o,l,i,a,c),e.context=nm(null),n=e.current,r=Wt(),o=Ss(n),l=Zn(r,o),l.callback=t??null,ys(n,l,o),e.current.lanes=o,Wo(e,o,r),Jt(e,r),e}function Si(e,t,n,r){var o=t.current,l=Wt(),i=Ss(o);return n=nm(n),t.context===null?t.context=n:t.pendingContext=n,t=Zn(l,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ys(o,t,i),e!==null&&(Pn(e,o,i,l),kl(e,o,i)),i}function ri(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Iu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function qc(e,t){Iu(e,t),(e=e.alternate)&&Iu(e,t)}function Nx(){return null}var rm=typeof reportError=="function"?reportError:function(e){console.error(e)};function ed(e){this._internalRoot=e}Ni.prototype.render=ed.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ue(409));Si(e,t,null,null)};Ni.prototype.unmount=ed.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ys(function(){Si(null,e,null,null)}),t[es]=null}};function Ni(e){this._internalRoot=e}Ni.prototype.unstable_scheduleHydration=function(e){if(e){var t=_f();e={blockedOn:null,target:e,priority:t};for(var n=0;n<fs.length&&t!==0&&t<fs[n].priority;n++);fs.splice(n,0,e),n===0&&Lf(e)}};function td(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ji(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Pu(){}function jx(e,t,n,r,o){if(o){if(typeof r=="function"){var l=r;r=function(){var u=ri(i);l.call(u)}}var i=sm(t,r,e,0,null,!1,!1,"",Pu);return e._reactRootContainer=i,e[es]=i.current,Do(e.nodeType===8?e.parentNode:e),Ys(),i}for(;o=e.lastChild;)e.removeChild(o);if(typeof r=="function"){var a=r;r=function(){var u=ri(c);a.call(u)}}var c=Zc(e,0,!1,null,null,!1,!1,"",Pu);return e._reactRootContainer=c,e[es]=c.current,Do(e.nodeType===8?e.parentNode:e),Ys(function(){Si(t,c,n,r)}),c}function ki(e,t,n,r,o){var l=n._reactRootContainer;if(l){var i=l;if(typeof o=="function"){var a=o;o=function(){var c=ri(i);a.call(c)}}Si(t,i,e,o)}else i=jx(n,t,e,o,r);return ri(i)}Mf=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=lo(t.pendingLanes);n!==0&&(yc(t,n|1),Jt(t,St()),!(Je&6)&&(_r=St()+500,Ps()))}break;case 13:Ys(function(){var r=ts(e,1);if(r!==null){var o=Wt();Pn(r,e,1,o)}}),qc(e,1)}};wc=function(e){if(e.tag===13){var t=ts(e,134217728);if(t!==null){var n=Wt();Pn(t,e,134217728,n)}qc(e,134217728)}};Rf=function(e){if(e.tag===13){var t=Ss(e),n=ts(e,t);if(n!==null){var r=Wt();Pn(n,e,t,r)}qc(e,t)}};_f=function(){return tt};Af=function(e,t){var n=tt;try{return tt=e,t()}finally{tt=n}};ja=function(e,t,n){switch(t){case"input":if(xa(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=gi(r);if(!o)throw Error(ue(90));pf(r),xa(r,o)}}}break;case"textarea":gf(e,n);break;case"select":t=n.value,t!=null&&Nr(e,!!n.multiple,t,!1)}};Sf=Yc;Nf=Ys;var kx={usingClientEntryPoint:!1,Events:[Ho,gr,gi,yf,wf,Yc]},eo={findFiberByHostInstance:Fs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Cx={bundleType:eo.bundleType,version:eo.version,rendererPackageName:eo.rendererPackageName,rendererConfig:eo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ss.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Cf(e),e===null?null:e.stateNode},findFiberByHostInstance:eo.findFiberByHostInstance||Nx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xl.isDisabled&&xl.supportsFiber)try{ui=xl.inject(Cx),Bn=xl}catch{}}on.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kx;on.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!td(t))throw Error(ue(200));return Sx(e,t,null,n)};on.createRoot=function(e,t){if(!td(e))throw Error(ue(299));var n=!1,r="",o=rm;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=Zc(e,1,!1,null,null,n,!1,r,o),e[es]=t.current,Do(e.nodeType===8?e.parentNode:e),new ed(t)};on.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ue(188)):(e=Object.keys(e).join(","),Error(ue(268,e)));return e=Cf(t),e=e===null?null:e.stateNode,e};on.flushSync=function(e){return Ys(e)};on.hydrate=function(e,t,n){if(!ji(t))throw Error(ue(200));return ki(null,e,t,!0,n)};on.hydrateRoot=function(e,t,n){if(!td(e))throw Error(ue(405));var r=n!=null&&n.hydratedSources||null,o=!1,l="",i=rm;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=sm(t,null,e,1,n??null,o,!1,l,i),e[es]=t.current,Do(e),r)for(e=0;e<r.length;e++)n=r[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Ni(t)};on.render=function(e,t,n){if(!ji(t))throw Error(ue(200));return ki(null,e,t,!1,n)};on.unmountComponentAtNode=function(e){if(!ji(e))throw Error(ue(40));return e._reactRootContainer?(Ys(function(){ki(null,null,e,!1,function(){e._reactRootContainer=null,e[es]=null})}),!0):!1};on.unstable_batchedUpdates=Yc;on.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ji(n))throw Error(ue(200));if(e==null||e._reactInternals===void 0)throw Error(ue(38));return ki(e,t,n,!1,r)};on.version="18.3.1-next-f1338f8080-20240426";function om(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(om)}catch(e){console.error(e)}}om(),rf.exports=on;var Ex=rf.exports,$u=Ex;da.createRoot=$u.createRoot,da.hydrateRoot=$u.hydrateRoot;const lm="newui_app_state",sc=1;function Ix(e){const t=(e.seatIds??[]).slice(),n=Math.max(0,e.capacity||0);if(t.length<n)for(let r=t.length;r<n;r++)t[r]=String(e.id)+"_s"+r;else t.length>n&&(t.length=n);return{...e,seatIds:t}}function Px(e){return{...e,tables:e.tables.map(Ix)}}function im(e){const n=((e||{layouts:[]}).layouts||[]).map(Px);return{version:sc,layouts:n}}function $x(){try{const e=localStorage.getItem(lm);if(!e)return{version:sc,layouts:[]};const t=JSON.parse(e);return im(t)}catch{return{version:sc,layouts:[]}}}function Tx(e){localStorage.setItem(lm,JSON.stringify(e))}function $s(){return $x().layouts}function On(e){const t=im({layouts:e});Tx(t)}const am="newui_periods_state";function Tn(){try{const e=localStorage.getItem(am);if(!e)return{periods:[],currentId:null};const t=JSON.parse(e);return{periods:t.periods??[],currentId:t.currentId??null}}catch{return{periods:[],currentId:null}}}function Dn(e){localStorage.setItem(am,JSON.stringify(e))}function et(){return Tn()}function rc(e){const t=Tn();Dn({periods:e,currentId:e.length?t.currentId??e[0].id:null})}function lr(e){Dn({periods:e.periods||[],currentId:e.currentId??null})}function Ut(e){const t=Tn();Dn({periods:t.periods,currentId:e})}function Ci(e,t){const n=Tn(),r=n.periods.findIndex(l=>String(l.id)===String(e));if(r<0)return;const o=n.periods.slice();o[r]=t({...o[r]}),Dn({periods:o,currentId:n.currentId})}function Dx(e,t){Ci(e,n=>({...n,pointsEnabled:t,startingPoints:n.startingPoints??50,pointsByStudent:n.pointsByStudent||{},pointsHistory:n.pointsHistory||[]}))}function Mx(e,t){Ci(e,n=>({...n,startingPoints:Math.max(0,Math.floor(t||0))}))}function Rx(e){Ci(e,t=>({...t,pointsByStudent:{}}))}function _x(e){Ci(e,t=>({...t,pointsHistory:[]}))}function Ax(e){const t=Tn();if(!t.currentId)return;const n=t.periods.findIndex(o=>String(o.id)===String(t.currentId));if(n<0)return;const r=t.periods.slice();r[n]={...r[n],layoutId:e},Dn({periods:r,currentId:t.currentId})}function oi(e){const t=Tn();if(!t.currentId)return;const n=t.periods.findIndex(o=>String(o.id)===String(t.currentId));if(n<0)return;const r=t.periods.slice();r[n]={...r[n],tablePositions:e},Dn({periods:r,currentId:t.currentId})}function oc(e){const t=Tn();if(!t.currentId)return;const n=t.periods.findIndex(o=>String(o.id)===String(t.currentId));if(n<0)return;const r=t.periods.slice();r[n]={...r[n],tableDimensions:e},Dn({periods:r,currentId:t.currentId})}function sa(e){const t=Tn();if(!t.currentId)return;const n=t.periods.findIndex(o=>String(o.id)===String(t.currentId));if(n<0)return;const r=t.periods.slice();r[n]={...r[n],tableAssignments:e},Dn({periods:r,currentId:t.currentId})}function ra(e){const t=Tn();if(!t.currentId)return;const n=t.periods.findIndex(o=>String(o.id)===String(t.currentId));if(n<0)return;const r=t.periods.slice();r[n]={...r[n],activeGrouping:e},Dn({periods:r,currentId:t.currentId})}function Lx(e,t){const n=Tn(),r=n.periods.findIndex(l=>String(l.id)===String(e));if(r<0)return;const o=n.periods.slice();o[r]={...o[r],attendanceRotation:t},Dn({periods:o,currentId:n.currentId})}function oa(e,t,n){const r=Tn(),o=r.periods.findIndex(c=>String(c.id)===String(e));if(o<0)return;const l=r.periods.slice(),i={...l[o]},a=i.attendanceZoomByRotation||{};i.attendanceZoomByRotation={...a,[t]:n},l[o]=i,Dn({periods:l,currentId:r.currentId})}const cm="newui_tags_state_v1";function Ox(){try{const e=localStorage.getItem(cm);return e?{version:1,tags:JSON.parse(e).tags??[]}:{version:1,tags:[]}}catch{return{version:1,tags:[]}}}function Fx(e){localStorage.setItem(cm,JSON.stringify(e))}function pn(){return Ox().tags}function us(e){Fx({version:1,tags:e})}function zx(e){const t=Math.max(40,e.width||200),n=Math.max(40,e.height||100),r=Math.max(0,e.capacity||0);if(r===0)return[];const o=8,l=4,a=(e.rotation||0)%180===90,c=[];for(let x=1;x<=r;x++){const f=Math.ceil(r/x);c.push({rows:x,cols:f})}let u=null,m=Number.POSITIVE_INFINITY;for(const x of c){const v=x.rows*x.cols-r,D=Math.abs(x.cols-x.rows),M=a?x.rows>=x.cols?0:2:x.cols>=x.rows?0:2,G=v*10+D*2+M;G<m&&(m=G,u=x)}const E=u.rows,S=u.cols,j=Math.max(16,Math.floor((t-o*2-(S-1)*l)/S)),L=Math.max(16,Math.floor((n-o*2-(E-1)*l)/E)),N=[];let W=0;for(let x=0;x<E&&W<r;x++)for(let f=0;f<S&&W<r;f++){const v=o+f*(j+l),D=o+x*(L+l);N.push({x:v,y:D,width:j,height:L,index:W}),W++}return N}function ir(e,t=0){const n=Math.min(10,Math.max(1,Math.floor(e||1)));let r=240,o=160;return n===1?(r=160,o=160):n===2?(r=240,o=160):n<=4?(r=240,o=200):n<=6?(r=300,o=200):n<=8?(r=320,o=240):(r=360,o=240),(t??0)===90?{width:o,height:r}:{width:r,height:o}}function Bx({onCancel:e,onCreate:t}){const[n,r]=d.useState(1),[o,l]=d.useState("Room Layout"),[i,a]=d.useState(10),[c,u]=d.useState(2),m=()=>r(j=>Math.min(3,j+1)),E=()=>r(j=>Math.max(1,j-1)),S=()=>{const j=Date.now(),L=[],N=ir(c,0),W=Math.min(5,Math.max(1,Math.ceil(Math.sqrt(i)))),x=80,f=80,v=N.width+x,D=N.height+f;for(let G=0;G<i;G++){const J=Math.floor(G/W),U=G%W,te=j+G;L.push({id:te,name:`Table ${G+1}`,capacity:c,width:N.width,height:N.height,rotation:0,position:{x:50+U*v,y:50+J*D},seatIds:[],seatNumbers:[]})}t({id:j,name:o,tables:L})};return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[120]",onClick:e,children:s.jsxs("div",{className:"card p-6 w-[95vw] max-w-[600px] bg-white",onClick:j=>j.stopPropagation(),children:[s.jsx("h3",{className:"text-lg font-bold mb-3",children:"Create Layout"}),n===1&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Layout Name"}),s.jsx("input",{className:"w-full border rounded px-3 py-2",value:o,onChange:j=>l(j.target.value)})]}),n===2&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"How many tables?"}),s.jsx("input",{type:"number",min:1,max:50,className:"w-full border rounded px-3 py-2",value:i,onChange:j=>a(Math.min(50,Math.max(1,parseInt(j.target.value||"1",10))))})]}),n===3&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Capacity per table"}),s.jsx("input",{type:"number",min:1,max:10,className:"w-full border rounded px-3 py-2",value:c,onChange:j=>u(Math.min(10,Math.max(1,parseInt(j.target.value||"1",10))))})]}),s.jsxs("div",{className:"mt-4 flex justify-between",children:[s.jsx("button",{className:"btn",onClick:n===1?e:E,children:n===1?"Cancel":"Back"}),n<3?s.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 hover:bg-indigo-700 text-white font-semibold",onClick:m,children:"Next"}):s.jsx("button",{className:"px-3 py-2 rounded bg-emerald-600 hover:bg-emerald-700 text-white font-semibold",onClick:S,children:"Create"})]})]})})}const Rs="text-[10px] font-semibold tracking-wide uppercase text-slate-500",_s="w-full border border-slate-300 rounded bg-white px-2 py-1 text-xs shadow-sm focus:outline-none focus:ring-1 focus:ring-indigo-300 focus:border-indigo-400 transition",vl="px-2 py-1 border border-slate-300 rounded bg-white text-xs font-semibold shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-1 focus:ring-indigo-300 transition";function Wx({layout:e,onClose:t,onSave:n}){var _,A;const[r,o]=d.useState(()=>JSON.parse(JSON.stringify(e))),[l,i]=d.useState(null),[a,c]=d.useState(1),u=d.useRef(null),m=d.useRef(null),E=d.useRef([]),[S,j]=d.useState(!1),[L,N]=d.useState("1"),[W,x]=d.useState(!1),[f,v]=d.useState(!0),D=()=>{E.current.push(JSON.parse(JSON.stringify(r))),E.current.length>50&&E.current.shift()},M=()=>{const p=E.current.pop();p&&o(p)},G=p=>{const P=Math.max(0,p.capacity||0),w=(p.seatNumbers??[]).slice();w.length<P&&(w.length=P);for(let b=0;b<w.length;b++)w[b]===void 0&&(w[b]=null);return w},J=(p,P,w)=>{D(),o(b=>({...b,tables:b.tables.map(C=>{if(String(C.id)!==String(p))return C;const I=G(C);return I[P]=w===""||w===null?null:String(w),{...C,seatNumbers:I}})}))},U=d.useMemo(()=>r.tables.find(p=>String(p.id)===String(l))||null,[r,l]),te=(p,P)=>{o(w=>({...w,tables:w.tables.map(b=>String(b.id)===String(p)?{...b,...P}:b)}))},ae=()=>{const p=Date.now(),P=ir(2,0),w={id:p,name:`Table ${r.tables.length+1}`,capacity:2,width:P.width,height:P.height,rotation:0,position:{x:50,y:50},seatIds:[],seatNumbers:[]};o(b=>({...b,tables:[...b.tables,w]}))},Y=()=>{confirm("Clear all seat numbers in this layout?")&&(D(),o(p=>({...p,tables:p.tables.map(P=>({...P,seatNumbers:new Array(Math.max(0,P.capacity||0)).fill(null)}))})))},ce=()=>n(r),$e=p=>{const P=u.current;P&&(m.current={x:p.clientX,y:p.clientY,startLeft:P.scrollLeft,startTop:P.scrollTop},P.style.cursor="grabbing")},xe=p=>{const P=u.current;if(!P||!m.current)return;const w=p.clientX-m.current.x,b=p.clientY-m.current.y;P.scrollLeft=m.current.startLeft-w,P.scrollTop=m.current.startTop-b},H=()=>{const p=u.current;p&&(p.style.cursor="default"),m.current=null},ge=(p,P,w,b,C,I,q,K)=>{const le=Math.max(0,Math.min(p+w,C+q)-Math.max(p,C)),je=Math.max(0,Math.min(P+b,I+K)-Math.max(P,I));return le*je},ne=(p,P,w)=>{var q,K;const b=r.tables.find(le=>String(le.id)===String(p));if(!b)return 0;const C={x:P,y:w,w:b.width,h:b.height};let I=0;for(const le of r.tables){if(String(le.id)===String(p))continue;const je=((q=le.position)==null?void 0:q.x)||0,Te=((K=le.position)==null?void 0:K.y)||0;I+=ge(C.x,C.y,C.w,C.h,je,Te,le.width,le.height)}return I},h=(p,P,w,b)=>{var K,le;if(b||W)return!0;const C=r.tables.find(je=>String(je.id)===String(p));if(!C)return!1;const I=ne(p,((K=C.position)==null?void 0:K.x)||0,((le=C.position)==null?void 0:le.y)||0),q=ne(p,P,w);return I===0?q===0:q<I},k=p=>{var I,q;if(W)return;const P=r.tables.find(K=>String(K.id)===String(p));if(!P)return;const w=((I=P.position)==null?void 0:I.x)||0,b=((q=P.position)==null?void 0:q.y)||0;if(ne(p,w,b)===0)return;const C=[[20,0],[-20,0],[0,20],[0,-20],[20,20],[-20,20],[20,-20],[-20,-20],[40,0],[0,40],[-40,0],[0,-40]];for(let K=0;K<C.length;K++){const le=Math.max(0,w+C[K][0]),je=Math.max(0,b+C[K][1]);if(ne(p,le,je)===0){o(Te=>({...Te,tables:Te.tables.map(me=>String(me.id)===String(p)?{...me,position:{x:le,y:je}}:me)}));return}}};return uo.useEffect(()=>{const p=P=>{var le,je,Te;if(!l)return;const w=(le=P.target)==null?void 0:le.tagName;if(w&&["INPUT","TEXTAREA","SELECT","OPTION"].includes(w))return;let b=0,C=0;if(P.key==="ArrowLeft"?b=-20:P.key==="ArrowRight"?b=20:P.key==="ArrowUp"?C=-20:P.key==="ArrowDown"&&(C=20),!b&&!C)return;const I=r.tables.find(me=>String(me.id)===String(l));if(!I)return;const q=Math.max(0,(((je=I.position)==null?void 0:je.x)||0)+b),K=Math.max(0,(((Te=I.position)==null?void 0:Te.y)||0)+C);h(I.id,q,K,P.altKey)&&(P.preventDefault(),o(me=>({...me,tables:me.tables.map(Pe=>String(Pe.id)===String(I.id)?{...Pe,position:{x:q,y:K}}:Pe)})))};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[r,l,W]),s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[120]",onClick:t,children:s.jsxs("div",{className:"bg-white w-[95vw] max-w-[1100px] max-h-[95vh] overflow-auto rounded-lg p-4",onClick:p=>p.stopPropagation(),children:[s.jsx("h3",{className:"text-2xl font-bold mb-3",children:"Edit: Room Layout"}),s.jsxs("div",{className:"mb-2 flex items-center gap-2 flex-wrap",children:[s.jsx("label",{className:"text-sm",children:"Layout:"}),s.jsx("input",{className:"flex-1 min-w-[160px] border rounded px-2 py-1 text-sm",value:r.name,onChange:p=>o({...r,name:p.target.value})}),s.jsx("button",{className:"px-3 py-1 rounded bg-emerald-600 hover:bg-emerald-700 text-white",onClick:ae,children:"+ Add Table"}),s.jsxs("label",{className:"text-sm flex items-center gap-2 bg-orange-50 border border-orange-200 rounded px-2 py-1",children:[s.jsx("input",{type:"checkbox",checked:W,onChange:p=>x(p.target.checked)}),s.jsx("span",{className:W?"text-orange-700 font-semibold":"text-orange-600",children:"Disable Collision Rules"})]}),s.jsxs("label",{className:"text-sm flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:S,onChange:p=>j(p.target.checked)}),"Seat Numbers"]}),S&&s.jsxs(s.Fragment,{children:[s.jsx("label",{className:"text-sm",children:"Next Label"}),s.jsx("input",{className:"border rounded px-2 py-1 text-sm w-24",value:L,onChange:p=>N(p.target.value)})]}),s.jsx("button",{className:"px-3 py-1 rounded bg-rose-600 hover:bg-rose-700 text-white",onClick:Y,children:"Clear All"}),s.jsx("button",{className:"px-3 py-1 rounded bg-slate-600 hover:bg-slate-700 text-white",onClick:M,children:"Undo"}),s.jsx("button",{className:"px-3 py-1 rounded bg-emerald-700 hover:bg-emerald-800 text-white",onClick:ce,children:"Done"}),s.jsx("button",{className:"px-2 py-1 rounded border text-sm",onClick:()=>v(p=>!p),children:f?"Hide Editor":"Show Editor"})]}),f&&U&&s.jsxs("div",{className:"mb-3 p-3 bg-gradient-to-br from-indigo-50 to-white border border-indigo-200 rounded",children:[s.jsxs("div",{className:"flex flex-wrap items-end gap-3 text-xs mb-2",children:[s.jsxs("div",{className:"text-[13px] font-semibold text-slate-600 pr-2",children:["Editing: ",U.name]}),s.jsxs("label",{className:"flex flex-col gap-0.5 w-[140px] max-w-full shrink-0",children:[s.jsx("span",{className:Rs,children:"Name"}),s.jsx("input",{className:_s,value:U.name,onChange:p=>te(U.id,{name:p.target.value})})]}),s.jsxs("label",{className:"flex flex-col gap-0.5 w-[90px] max-w-full shrink-0",children:[s.jsx("span",{className:Rs,children:"Capacity"}),s.jsx("input",{type:"number",min:1,max:10,className:_s,value:U.capacity,onChange:p=>{const P=Math.min(10,Math.max(1,parseInt(p.target.value||"1",10))),w=ir(P,U.rotation||0);te(U.id,{capacity:P,width:w.width,height:w.height}),setTimeout(()=>k(U.id),0)}})]}),s.jsxs("label",{className:"flex flex-col gap-0.5 w-[140px] max-w-full shrink-0",children:[s.jsx("span",{className:Rs,children:"Orientation"}),s.jsxs("select",{className:_s,value:U.rotation||0,onChange:p=>{const P=parseInt(p.target.value,10),w=ir(U.capacity,P),b=U.height,C=U.width,I=Math.max(w.width,b),q=Math.max(w.height,C);te(U.id,{rotation:P,width:I,height:q}),setTimeout(()=>k(U.id),0)},children:[s.jsx("option",{value:0,children:"Horizontal ↔"}),s.jsx("option",{value:90,children:"Vertical ↕"})]})]}),(()=>{const p=ir(U.capacity,U.rotation||0);return s.jsxs("label",{className:"flex flex-col gap-0.5 w-[100px] max-w-full shrink-0",children:[s.jsx("span",{className:Rs,children:"Width"}),s.jsx("input",{type:"number",step:10,min:p.width,className:_s,value:U.width,onChange:P=>{const w=parseInt(P.target.value||"0",10),b=Math.round(w/10)*10,C=Math.max(p.width,b);te(U.id,{width:C}),setTimeout(()=>k(U.id),0)}})]})})(),(()=>{const p=ir(U.capacity,U.rotation||0);return s.jsxs("label",{className:"flex flex-col gap-0.5 w-[100px] max-w-full shrink-0",children:[s.jsx("span",{className:Rs,children:"Height"}),s.jsx("input",{type:"number",step:10,min:p.height,className:_s,value:U.height,onChange:P=>{const w=parseInt(P.target.value||"0",10),b=Math.round(w/10)*10,C=Math.max(p.height,b);te(U.id,{height:C}),setTimeout(()=>k(U.id),0)}})]})})(),s.jsxs("label",{className:"flex flex-col gap-0.5 w-[95px] max-w-full shrink-0",children:[s.jsx("span",{className:Rs,children:"X Position"}),s.jsx("input",{type:"number",className:_s,value:((_=U.position)==null?void 0:_.x)||0,onChange:p=>{var P;return te(U.id,{position:{x:parseInt(p.target.value||"0",10),y:((P=U.position)==null?void 0:P.y)||0}})}})]}),s.jsxs("label",{className:"flex flex-col gap-0.5 w-[95px] max-w-full shrink-0",children:[s.jsx("span",{className:Rs,children:"Y Position"}),s.jsx("input",{type:"number",className:_s,value:((A=U.position)==null?void 0:A.y)||0,onChange:p=>{var P;return te(U.id,{position:{x:((P=U.position)==null?void 0:P.x)||0,y:parseInt(p.target.value||"0",10)}})}})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[s.jsx("span",{className:"text-[10px] font-semibold tracking-wide uppercase text-slate-500",children:"Move Table (or use arrow keys)"}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.jsx("button",{className:vl,"aria-label":"Move left",onClick:p=>{var b,C;const P=Math.max(0,(((b=U.position)==null?void 0:b.x)||0)-20),w=((C=U.position)==null?void 0:C.y)||0;h(U.id,P,w,p.altKey)&&te(U.id,{position:{x:P,y:w}})},children:"←"}),s.jsx("button",{className:vl,"aria-label":"Move right",onClick:p=>{var b,C;const P=(((b=U.position)==null?void 0:b.x)||0)+20,w=((C=U.position)==null?void 0:C.y)||0;h(U.id,P,w,p.altKey)&&te(U.id,{position:{x:P,y:w}})},children:"→"}),s.jsx("button",{className:vl,"aria-label":"Move up",onClick:p=>{var b,C;const P=((b=U.position)==null?void 0:b.x)||0,w=Math.max(0,(((C=U.position)==null?void 0:C.y)||0)-20);h(U.id,P,w,p.altKey)&&te(U.id,{position:{x:P,y:w}})},children:"↑"}),s.jsx("button",{className:vl,"aria-label":"Move down",onClick:p=>{var b,C;const P=((b=U.position)==null?void 0:b.x)||0,w=(((C=U.position)==null?void 0:C.y)||0)+20;h(U.id,P,w,p.altKey)&&te(U.id,{position:{x:P,y:w}})},children:"↓"})]})]})]}),s.jsxs("div",{className:"rounded border-2 border-dashed border-slate-300 p-2 bg-slate-50",style:{minHeight:400},children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("div",{className:"text-sm text-slate-600",children:"Layout (Click to select; Alt = ignore collisions):"}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("label",{children:"Zoom"}),s.jsx("input",{type:"range",min:.5,max:2,step:.1,value:a,onChange:p=>c(parseFloat(p.target.value))}),s.jsxs("span",{className:"w-10 text-right",children:[a.toFixed(1),"x"]})]})]}),s.jsx("div",{ref:u,className:"relative overflow-auto rounded",style:{width:"100%",height:600,cursor:"default"},onMouseDown:$e,onMouseMove:xe,onMouseUp:H,onMouseLeave:H,onClick:()=>i(null),children:s.jsx("div",{className:"relative",style:{width:3e3*a,height:1800*a},children:r.tables.map(p=>{var K,le;const P=(((K=p.position)==null?void 0:K.x)||0)*a,w=(((le=p.position)==null?void 0:le.y)||0)*a,b=(p.width||0)*a,C=(p.height||0)*a,I=zx(p),q=G(p);return s.jsxs("div",{onClick:je=>{je.stopPropagation(),i(p.id)},className:(String(l)===String(p.id)?"border-amber-400":"border-teal-500")+" absolute rounded-lg shadow px-3 py-2 text-left",style:{left:P,top:w,width:b,height:C,background:"#c7fff1",borderWidth:2},title:`${p.width}x${p.height}px`,children:[s.jsx("div",{className:"font-semibold",children:p.name}),s.jsxs("div",{className:"text-xs",children:["Cap: ",p.capacity]}),s.jsx("div",{className:"text-xs",children:(p.rotation||0)===90?"↕":"↔"}),s.jsxs("div",{className:"text-xs",children:[p.width,"x",p.height,"px"]}),S&&s.jsx("div",{className:"absolute",style:{left:0,top:0,width:"100%",height:"100%"},children:I.map(je=>{const Te=q[je.index];return s.jsx("button",{type:"button",className:"absolute",style:{left:je.x*a,top:je.y*a,width:je.width*a,height:je.height*a,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},onClick:me=>{if(me.stopPropagation(),!!S)if(Te)J(p.id,je.index,null),N(()=>{const Pe=parseInt(String(Te),10);return Number.isNaN(Pe)?String(Te):String(Pe)});else{J(p.id,je.index,L);const Pe=parseInt(L,10);isNaN(Pe)||N(String(Pe+1))}},children:Te?s.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-xs font-semibold",style:{background:"#1f78d1"},children:String(Te)}):s.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center text-xs font-semibold",style:{border:"2px dashed #cbd5e1",color:"#94a3b8",background:"rgba(255,255,255,0.6)",boxShadow:"inset 0 0 0 1px rgba(255,255,255,0.4)"}})},je.index)})})]},String(p.id))})})})]})]})})}const dm="newui_students_state_v1";function um(){try{const e=localStorage.getItem(dm);return e?{version:1,students:JSON.parse(e).students??[]}:{version:1,students:[]}}catch{return{version:1,students:[]}}}function Gx(e){localStorage.setItem(dm,JSON.stringify(e))}function mt(){return um().students}function li(e){return mt().filter(t=>(t.periodIds||[]).some(n=>String(n)===String(e)))}function En(e){Gx({version:1,students:e})}function Hx(e,t){const n=um().students.slice(),r=[],o=[],l=[];function i(c){return(c||"").trim().replace(/\s+/g," ").toLowerCase()}const a=new Map;n.forEach((c,u)=>a.set(i(c.fullName),u));for(const c of e){const u=i(c.fullName),m=a.get(u);if(m==null)n.push(c),a.set(u,n.length-1),r.push(c);else{const E=t.onCollision?t.onCollision(n[m],c):"merge";if(E==="skip")l.push(c);else if(E==="new")n.push(c),r.push(c);else{const S=n[m],j={...S,...c,tagIds:Array.from(new Set([...S.tagIds||[],...c.tagIds||[]])),strongPreferences:Array.from(new Set([...S.strongPreferences||[],...c.strongPreferences||[]])),preferences:Array.from(new Set([...S.preferences||[],...c.preferences||[]])),periodIds:Array.from(new Set([...S.periodIds||[],...c.periodIds||[]]))};n[m]=j,o.push(j)}}}return En(n),{added:r,merged:o,skipped:l}}function Ux({onChanged:e}){const t=et(),n=mt(),[r,o]=d.useState(""),[l,i]=d.useState(null),[a,c]=d.useState(""),[u,m]=d.useState(!1),[E,S]=d.useState(()=>(t.periods||[]).map(f=>({...f}))),j=new Map;n.forEach(f=>(f.periodIds||[]).forEach(v=>{const D=String(v);j.set(D,(j.get(D)||0)+1)}));const L=f=>{rc(f),e()},N=()=>{const f=r.trim();if(!f)return;const v=Date.now().toString();L([...t.periods||[],{id:v,name:f,layoutId:null}]),Ut(v),o("")},W=f=>{var D;if(!confirm("Delete this period? Students remain in data but will not be associated with this period."))return;const v=(t.periods||[]).filter(M=>String(M.id)!==String(f));L(v),String(t.currentId)===String(f)&&Ut(((D=v[0])==null?void 0:D.id)??null)},x=(f,v)=>{const D=E.slice(),M=D.findIndex(U=>String(U.id)===String(f));if(M<0)return;const G=M+v;if(G<0||G>=D.length)return;const J=D[M];D[M]=D[G],D[G]=J,S(D)};return s.jsxs("div",{children:[s.jsx("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:(t.periods||[]).map(f=>{const v=String(f.id)===String(t.currentId),D=j.get(String(f.id))||0;return s.jsxs("div",{className:(v?"bg-violet-600 text-white":"bg-white border-2 border-slate-300 text-slate-800 hover:bg-slate-50")+" px-4 py-2 rounded-lg inline-flex items-center gap-2 transition-colors",children:[s.jsx("div",{role:"button",tabIndex:0,className:"font-medium text-sm focus:outline-none",onClick:()=>{Ut(f.id),e()},onKeyDown:M=>{(M.key==="Enter"||M.key===" ")&&(M.preventDefault(),Ut(f.id),e())},children:String(l)===String(f.id)?s.jsx("input",{autoFocus:!0,className:"border rounded px-2 py-0.5 text-sm text-black",value:a,onChange:M=>c(M.target.value),onBlur:()=>{const M=a.trim();if(i(null),!M||M===f.name)return;const G=(t.periods||[]).map(J=>String(J.id)===String(f.id)?{...J,name:M}:J);L(G)},onKeyDown:M=>{M.stopPropagation(),M.key==="Enter"&&M.currentTarget.blur(),M.key==="Escape"&&(i(null),c(""))}}):s.jsxs("span",{children:[f.name," (",D," students)"]})}),s.jsx("button",{className:(v?"text-blue-200 hover:text-blue-100":"text-blue-600 hover:text-blue-800")+" text-sm",title:"Rename",onClick:()=>{i(f.id),c(f.name)},children:"✎"}),s.jsx("button",{className:(v?"text-rose-200 hover:text-rose-100":"text-rose-600 hover:text-rose-800")+" text-sm font-bold",title:"Delete",onClick:()=>W(f.id),children:"✕"})]},String(f.id))})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{className:"flex-1 border rounded px-3 py-2",placeholder:"New period name",value:r,onChange:f=>o(f.target.value)}),s.jsx("button",{className:"px-3 py-2 rounded bg-violet-600 text-white",onClick:N,children:"+ Add Period"}),s.jsx("button",{className:"px-2 py-2 rounded border",title:"Reorder",onClick:()=>{S((t.periods||[]).map(f=>({...f}))),m(!0)},children:"⚙"})]}),u&&s.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded shadow-xl w-full max-w-md p-4",children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Reorder Periods"}),s.jsx("div",{className:"space-y-2 max-h-72 overflow-auto",children:E.map((f,v)=>s.jsxs("div",{className:"flex items-center justify-between border rounded px-2 py-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-slate-500",children:[v+1,"."]}),s.jsx("span",{className:"font-medium",children:f.name})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{className:"px-2 py-1 border rounded",disabled:v===0,onClick:()=>x(f.id,-1),children:"↑"}),s.jsx("button",{className:"px-2 py-1 border rounded",disabled:v===E.length-1,onClick:()=>x(f.id,1),children:"↓"})]})]},String(f.id)))}),s.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[s.jsx("button",{className:"px-3 py-1 rounded border",onClick:()=>m(!1),children:"Cancel"}),s.jsx("button",{className:"px-3 py-1 rounded bg-indigo-600 text-white",onClick:()=>{L(E),m(!1)},children:"Save"})]})]})})]})}function Vx(){const[e,t]=d.useState([]),[n,r]=d.useState(null),[o,l]=d.useState(null),[i,a]=d.useState(""),[c,u]=d.useState(!1),[m,E]=d.useState(!1),[S,j]=d.useState(""),[L,N]=d.useState("#EF4444"),[W,x]=d.useState("#4F46E5"),f=d.useRef(null),[v,D]=d.useState("Medical"),[M,G]=d.useState(""),[J,U]=d.useState([]),[te,ae]=d.useState(0);d.useEffect(()=>{t($s());try{U(pn())}catch{}},[]);const Y=H=>{switch(H){case"Medical":return"🏥";case"Vision":return"👓";case"Hearing":return"🦻";case"Alert":return"⚠️";case"Accommodation":return"🧩";case"ELL":return"🌎";case"Seating":return"🪑";case"Focus":return"🎯";case"Academic":return"📘";case"Social":return"🤝";case"Other":return"🏷️";default:return H}},ce=H=>({Medical:"🏥",Vision:"👓",Hearing:"🦻",Alert:"⚠️",Accommodation:"🧩",ELL:"🌎",Seating:"🪑",Focus:"🎯",Academic:"📘",Social:"🤝",Other:"🏷️"})[H]||H,$e=()=>{u(!0)},xe=e.find(H=>String(H.id)===String(n))||e[0];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("section",{className:"card p-6",children:[s.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"Class Periods"}),s.jsx(Ux,{onChanged:()=>ae(H=>H+1)},te)]}),s.jsxs("section",{className:"card p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Table Layout Manager"}),s.jsx("p",{className:"text-sm text-slate-600",children:"Create and manage classroom table layouts for seating arrangements."})]}),s.jsx("button",{className:"px-3 py-2 rounded bg-emerald-600 hover:bg-emerald-700 text-white font-semibold",onClick:$e,children:"+ Create Layout"})]}),e.length===0?s.jsxs("div",{className:"mt-3 rounded border-2 border-dashed border-slate-300 p-10 text-center text-slate-500",children:[s.jsx("div",{className:"text-6xl leading-none mb-3",children:"🏷️"}),s.jsx("div",{className:"font-semibold",children:"No layouts created yet"}),s.jsx("div",{className:"text-sm",children:"Create your first table layout to get started"})]}):s.jsx("div",{className:"grid md:grid-cols-2 gap-3 mt-3",children:e.map(H=>s.jsxs("div",{className:(xe&&String(xe.id)===String(H.id)?"ring-2 ring-indigo-400 bg-indigo-50":"border-slate-200 bg-white")+" w-full card p-3 flex items-center justify-between",children:[s.jsxs("div",{onClick:()=>r(H.id),className:"cursor-pointer",children:[s.jsx("div",{className:"font-semibold text-slate-800",children:String(o)===String(H.id)?s.jsx("input",{autoFocus:!0,className:"border rounded px-2 py-1 text-sm",value:i,onChange:ge=>a(ge.target.value),onBlur:()=>{const ge=i.trim();if(l(null),!ge||ge===H.name)return;const ne={...H,name:ge},h=e.map(k=>String(k.id)===String(H.id)?ne:k);t(h),On(h)},onKeyDown:ge=>{ge.key==="Enter"&&ge.currentTarget.blur(),ge.key==="Escape"&&(l(null),a(""))}}):s.jsx("span",{children:H.name})}),s.jsxs("div",{className:"text-xs text-slate-600",children:["Tables: ",H.tables.length]})]}),s.jsxs("div",{className:"flex gap-2",children:[String(o)!==String(H.id)&&s.jsx("button",{className:"btn",onClick:()=>{r(H.id),l(H.id),a(H.name)},children:"Rename"}),s.jsx("button",{className:"btn",onClick:()=>{r(H.id),E(!0)},children:"Edit"}),s.jsx("button",{className:"btn",onClick:()=>{var ne;if(!confirm("Delete this layout?"))return;const ge=e.filter(h=>String(h.id)!==String(H.id));t(ge),On(ge),xe&&String(xe.id)===String(H.id)&&r(((ne=ge[0])==null?void 0:ne.id)??null)},children:"Delete"})]})]},String(H.id)))})]}),s.jsxs("section",{className:"card p-6",children:[s.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"Student Tags"}),s.jsx("p",{className:"text-sm text-slate-600 mb-3",children:"Create custom tags to categorize and track students (medical alerts, accommodations, etc.)."}),s.jsxs("div",{className:"p-3 rounded bg-indigo-50 border border-indigo-200 mb-3 grid gap-3 md:grid-cols-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs block mb-1",children:"Tag Name:"}),s.jsx("input",{className:"w-full border rounded px-2 py-1",placeholder:"e.g., Medical Alert",value:S,onChange:H=>j(H.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs block mb-1",children:"Color:"}),s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[["#EF4444","#F59E0B","#22C55E","#3B82F6","#8B5CF6"].map(H=>s.jsx("button",{type:"button",title:H,className:`w-6 h-6 rounded border ${L===H?"ring-2 ring-indigo-500 border-slate-600":"border-slate-300"}`,style:{background:H},onClick:()=>N(H)},H)),s.jsx("button",{type:"button",className:"px-2 py-1 text-xs rounded border",style:{background:L,color:"#fff"},onClick:()=>{var H;return(H=f.current)==null?void 0:H.click()},children:"Custom"}),s.jsx("input",{ref:f,type:"color",className:"hidden",value:L,onChange:H=>N(H.target.value)})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("label",{className:"text-xs block mb-1",children:"Icon:"}),s.jsx("select",{className:"w-full border rounded px-2 py-1",value:v,onChange:H=>D(H.target.value),children:[{key:"Medical"},{key:"Vision"},{key:"Hearing"},{key:"Alert"},{key:"Accommodation"},{key:"ELL"},{key:"Seating"},{key:"Focus"},{key:"Academic"},{key:"Social"},{key:"Other"}].map(H=>s.jsxs("option",{value:H.key,children:[Y(H.key)," ",H.key]},H.key))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs block mb-1",children:"Description (optional):"}),s.jsx("input",{className:"w-full border rounded px-2 py-1",placeholder:"e.g., Student has severe peanut allergy",value:M,onChange:H=>G(H.target.value)})]}),s.jsx("div",{className:"md:col-span-4",children:s.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 hover:bg-indigo-700 text-white font-semibold",onClick:()=>{if(!S.trim())return;const H=[...J,{id:Date.now().toString(),name:S.trim(),color:L,icon:Y(v),description:M}];U(H),us(H),j(""),G("")},children:"+ Create Tag"})})]}),J.length===0?s.jsxs("div",{className:"rounded border-2 border-dashed border-slate-300 p-10 text-center text-slate-500",children:[s.jsx("div",{className:"text-6xl leading-none mb-3",children:"🏷️"}),s.jsx("div",{className:"font-semibold",children:"No tags created yet"}),s.jsx("div",{className:"text-sm",children:"Create your first tag to start organizing students"})]}):s.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:J.map(H=>(H.icon||ce(H.name),s.jsxs("div",{className:"p-3 rounded border flex items-center justify-between",style:{borderColor:H.color},children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-md flex items-center justify-center",style:{background:`${H.color}22`},children:s.jsx("span",{className:"text-xl",children:H.icon||Y(H.name)})}),s.jsx("div",{className:"text-base font-semibold",children:H.name})]}),s.jsx("button",{className:"px-3 py-1 rounded bg-rose-100 text-rose-700 border border-rose-200",onClick:()=>{const ge=J.filter(ne=>ne.id!==H.id);U(ge),us(ge)},children:"Delete"})]},H.id)))})]}),s.jsxs("section",{className:"card p-6",children:[s.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"Behavior Points Tracking"}),s.jsx("p",{className:"text-sm text-slate-600 mb-3",children:"Optional system to track student behavior points per period."}),s.jsx("div",{className:"space-y-2 bg-amber-50 border border-amber-200 rounded p-3",children:(()=>{const H=et().periods;return H.length?H.map(ge=>s.jsxs("div",{className:(ge.pointsEnabled?"bg-amber-50":"bg-white")+" flex items-center justify-between gap-3 border border-amber-200 rounded px-3 py-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:!!ge.pointsEnabled,onChange:ne=>{Dx(ge.id,ne.target.checked),ae(h=>h+1)}}),s.jsxs("div",{className:"text-sm font-medium",children:[ge.name," ",s.jsx("span",{className:"text-xs text-slate-500",children:"(0 students)"})]})]}),ge.pointsEnabled&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("label",{children:"Starting Points:"}),s.jsx("input",{type:"number",min:0,className:"w-20 border rounded px-2 py-1",value:ge.startingPoints??50,onChange:ne=>{const h=parseInt(ne.target.value||"0",10);Mx(ge.id,h),ae(k=>k+1)}}),s.jsx("button",{className:"px-3 py-1 rounded bg-orange-500 hover:bg-orange-600 text-white",onClick:()=>{Rx(ge.id),ae(ne=>ne+1)},children:"Reset All"}),s.jsx("button",{className:"px-3 py-1 rounded bg-slate-600 hover:bg-slate-700 text-white",onClick:()=>{_x(ge.id),ae(ne=>ne+1)},children:"Clear History"})]})]},String(ge.id))):s.jsx("p",{className:"text-sm text-slate-600",children:"Import periods first (Periods tab) to enable settings."})})()}),s.jsxs("div",{className:"mt-3 text-sm p-3 bg-amber-50 border border-amber-200 rounded",children:[s.jsx("span",{className:"font-semibold",children:"How it works:"})," When enabled for a period, you’ll be able to adjust student points from the Attendance tab (badges + add-note modal). This card only configures period defaults."]})]}),c&&s.jsx(Bx,{onCancel:()=>u(!1),onCreate:H=>{const ge=[...e,H];t(ge),On(ge),r(H.id),u(!1),E(!0)}}),m&&xe&&s.jsx(Wx,{layout:xe,onClose:()=>E(!1),onSave:H=>{const ge=e.map(ne=>String(ne.id)===String(H.id)?H:ne);t(ge),On(ge),E(!1)}})]})}function Kx({headers:e,previewRow:t,onCancel:n,onConfirm:r}){const[o,l]=d.useState({}),i=d.useMemo(()=>e.map(c=>({value:c,label:c})),[e]),a=({value:c,onChange:u})=>s.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:c??"",onChange:m=>u(m.target.value||void 0),children:[s.jsx("option",{value:"",children:"Select a column..."}),i.map(m=>s.jsx("option",{value:m.value,children:m.label},m.value))]});return s.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded shadow-xl w-full max-w-2xl p-5",children:[s.jsx("h2",{className:"text-xl font-bold mb-2",children:"Map CSV Columns"}),s.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Select which columns correspond to each field."}),s.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold",children:"Name (Student's Name)"}),s.jsx("div",{className:"mt-1",children:s.jsx(a,{value:o.name,onChange:c=>l({...o,name:c})})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold",children:"Wants to request partners? (Yes/No)"}),s.jsx(a,{value:o.partnerRequest,onChange:c=>l({...o,partnerRequest:c})}),s.jsx("div",{className:"text-xs text-slate-500",children:"Yes = they have partner requests; No/blank = fine with anyone."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold",children:"Strong Preferences"}),s.jsx(a,{value:o.strongPrefs,onChange:c=>l({...o,strongPrefs:c})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold",children:"Regular Preferences"}),s.jsx(a,{value:o.regularPrefs,onChange:c=>l({...o,regularPrefs:c})})]}),s.jsxs("div",{className:"bg-slate-50 border rounded p-3 text-sm",children:[s.jsx("div",{className:"font-semibold mb-1",children:"Preview: First row from CSV"}),s.jsx("div",{className:"text-slate-700 whitespace-pre-wrap break-words",children:e.map((c,u)=>`${c}: ${t[u]??""}`).join(`
`)})]})]}),s.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[s.jsx("button",{className:"px-3 py-2 rounded border",onClick:n,children:"Cancel"}),s.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white",onClick:()=>r(o),disabled:!o.name,children:"Import Data"})]})]})})}function Yx({items:e,onCancel:t,onResolve:n}){const[r,o]=d.useState(e.map(()=>"merge"));return s.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded shadow-xl w-full max-w-2xl p-5",children:[s.jsx("h2",{className:"text-xl font-bold mb-2",children:"Name Collisions"}),s.jsx("p",{className:"text-sm text-slate-600 mb-3",children:"Students with the same name were found. Choose what to do for each."}),s.jsx("div",{className:"space-y-3 max-h-80 overflow-auto pr-2",children:e.map((l,i)=>s.jsxs("div",{className:"border rounded p-2",children:[s.jsx("div",{className:"font-semibold",children:l.incoming.fullName}),s.jsxs("div",{className:"text-xs text-slate-600",children:["Existing ID: ",String(l.existing.id)," | Incoming ID: ",String(l.incoming.id)]}),s.jsxs("div",{className:"mt-2 flex gap-3 text-sm",children:[s.jsxs("label",{className:"inline-flex items-center gap-1",children:[s.jsx("input",{type:"radio",name:`c${i}`,checked:r[i]==="merge",onChange:()=>{const a=[...r];a[i]="merge",o(a)}})," Merge"]}),s.jsxs("label",{className:"inline-flex items-center gap-1",children:[s.jsx("input",{type:"radio",name:`c${i}`,checked:r[i]==="skip",onChange:()=>{const a=[...r];a[i]="skip",o(a)}})," Skip"]}),s.jsxs("label",{className:"inline-flex items-center gap-1",children:[s.jsx("input",{type:"radio",name:`c${i}`,checked:r[i]==="new",onChange:()=>{const a=[...r];a[i]="new",o(a)}})," Create New"]})]})]},i))}),s.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[s.jsx("button",{className:"px-3 py-2 rounded border",onClick:t,children:"Cancel"}),s.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white",onClick:()=>n(r),children:"Apply"})]})]})})}function Qx(e){const t=e.replace(/^\uFEFF/,""),n=[];let r=[],o="",l=0,i=!1;for(;l<t.length;){const c=t[l];if(i)if(c==='"')if(t[l+1]==='"'){o+='"',l+=2;continue}else{i=!1,l++;continue}else{o+=c,l++;continue}else{if(c==='"'){i=!0,l++;continue}if(c===","){r.push(o),o="",l++;continue}if(c===`
`){r.push(o),n.push(r),r=[],o="",l++;continue}if(c==="\r"){l++;continue}o+=c,l++}}return r.push(o),n.push(r),{headers:(n.shift()||[]).map(c=>c.trim()),rows:n}}function Jx(e,t=.15){const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e||"");if(!n)return`rgba(148,163,184,${t})`;const r=parseInt(n[1],16),o=parseInt(n[2],16),l=parseInt(n[3],16);return`rgba(${r}, ${o}, ${l}, ${t})`}function Xx(e){const t=(e||"").trim().toLowerCase();return{medical:{icon:"🩺",color:"#ef4444"},vision:{icon:"👓",color:"#06b6d4"},hearing:{icon:"👂",color:"#8b5cf6"},alert:{icon:"⚠️",color:"#f59e0b"},accommodation:{icon:"🏷️",color:"#22c55e"},ell:{icon:"🌍",color:"#22c55e"},seating:{icon:"🪑",color:"#3b82f6"},focus:{icon:"🎯",color:"#f97316"},academic:{icon:"📘",color:"#2563eb"},social:{icon:"🤝",color:"#10b981"},other:{icon:void 0,color:"#9ca3af"}}[t]||{}}function Zx({student:e,peers:t,tags:n,onUpdate:r,onRemove:o,onEdit:l}){const i=new Set(e.strongPreferences||[]),a=new Set(e.preferences||[]),c=d.useMemo(()=>{const N=t.filter(x=>String(x.id)!==String(e.id)),W=x=>{var f;return((f=(x||"").trim().split(/\s+/)[0])==null?void 0:f.toLowerCase())||""};return N.slice().sort((x,f)=>W(x.fullName).localeCompare(W(f.fullName)))},[t,e.id]),u=e.gender==="M"?"bg-blue-500":e.gender==="F"?"bg-pink-500":"bg-slate-400",m=(e.fullName||"?").trim().charAt(0).toUpperCase(),E=N=>{r(W=>{const x=new Set(W.strongPreferences||[]);x.has(N)?x.delete(N):x.size<3&&x.add(N);const f=new Set(W.preferences||[]);return f.delete(N),{...W,strongPreferences:Array.from(x),preferences:Array.from(f)}})},S=N=>{r(W=>{if(new Set(W.strongPreferences||[]).has(N))return W;const f=new Set(W.preferences||[]);return f.has(N)?f.delete(N):f.size<5&&f.add(N),{...W,preferences:Array.from(f)}})},j=N=>{r(W=>({...W,tagIds:Array.from(new Set([...W.tagIds||[],N]))}))},L=N=>{r(W=>({...W,tagIds:(W.tagIds||[]).filter(x=>String(x)!==String(N))}))};return s.jsxs("div",{className:"border border-slate-200 rounded-lg p-3 bg-slate-50",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-8 h-8 ${u} text-white rounded-full flex items-center justify-center font-bold`,children:m}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold text-slate-900",children:e.fullName}),s.jsx("div",{className:"text-xs text-slate-500",children:e.gender==="M"?"Male":e.gender==="F"?"Female":"Other"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[l&&s.jsx("button",{className:"text-slate-500 hover:text-indigo-600 text-lg leading-none",title:"Edit",onClick:l,children:"✏️"}),o&&s.jsx("button",{className:"text-rose-600 hover:text-rose-700 text-lg leading-none",title:"Remove",onClick:o,children:"×"})]})]}),e.happyWithAnyone&&s.jsx("div",{className:"mt-2 text-sm bg-emerald-50 border border-emerald-200 text-emerald-700 rounded px-2 py-1",children:"Happy with anyone"}),s.jsxs("div",{className:"mt-3",children:[s.jsx("div",{className:"text-sm font-semibold",children:"⭐ Strong Preferences (max 3):"}),s.jsxs("div",{className:"text-xs text-slate-500 mb-1",children:[(e.strongPreferences||[]).length,"/3 strong preferences selected"]}),s.jsx("div",{className:"max-h-32 overflow-auto border border-yellow-300 rounded p-2 bg-yellow-50",children:c.map(N=>s.jsxs("label",{className:"flex items-center gap-2 text-sm py-0.5",children:[s.jsx("input",{type:"checkbox",checked:i.has(N.id),onChange:()=>E(N.id)})," ",N.fullName]},String(N.id)))})]}),s.jsxs("div",{className:"mt-3",children:[s.jsx("div",{className:"text-sm font-semibold",children:"Regular Preferences (max 5):"}),s.jsxs("div",{className:"text-xs text-slate-500 mb-1",children:[(e.preferences||[]).length,"/5 regular preferences selected"]}),s.jsx("div",{className:"max-h-32 overflow-auto border border-slate-200 rounded p-2 bg-white",children:c.map(N=>s.jsxs("label",{className:"flex items-center gap-2 text-sm py-0.5",children:[s.jsx("input",{type:"checkbox",checked:a.has(N.id),disabled:i.has(N.id),onChange:()=>S(N.id)})," ",N.fullName]},String(N.id)))})]}),s.jsxs("div",{className:"mt-3",children:[s.jsx("div",{className:"text-sm font-semibold mb-1",children:"Tags:"}),s.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[(e.tagIds||[]).map(N=>{const W=n.find(M=>String(M.id)===String(N));if(!W)return null;const x=Xx(W.name),f=W.color&&W.color.toLowerCase()!=="#9ca3af"?W.color:x.color||W.color||"#9CA3AF",v=Jx(f,.18),D=W.icon||x.icon;return s.jsxs("span",{className:"inline-flex items-center gap-2 text-sm px-2 py-0.5 rounded-full border",style:{background:v,borderColor:f,color:"#111"},children:[D?s.jsx("span",{className:"text-base leading-none","aria-hidden":!0,children:D}):s.jsx("span",{className:"w-2 h-2 rounded-full",style:{background:f}}),W.name,s.jsx("button",{className:"ml-1 text-slate-500 hover:text-rose-600",onClick:()=>L(N),children:"×"})]},String(N))}),s.jsxs("select",{className:"border rounded px-2 py-1 text-sm",onChange:N=>{const W=N.target.value;W&&(j(W),N.currentTarget.selectedIndex=0)},children:[s.jsx("option",{value:"",children:"+ Add Tag"}),n.filter(N=>!(e.tagIds||[]).some(W=>String(W)===String(N.id))).map(N=>s.jsx("option",{value:String(N.id),children:N.name},String(N.id)))]})]})]}),s.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[s.jsx("input",{type:"checkbox",checked:!!e.canWorkSolo,onChange:N=>r(W=>({...W,canWorkSolo:N.target.checked}))}),"Can work solo"]}),s.jsx("div",{className:"text-sm rounded px-2 py-1 border "+(e.mustWorkAlone?"bg-yellow-50 border-yellow-300 text-yellow-800":"bg-slate-50 border-slate-200 text-slate-600"),children:s.jsxs("label",{className:"inline-flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:!!e.mustWorkAlone,onChange:N=>r(W=>({...W,mustWorkAlone:N.target.checked}))}),s.jsx("span",{children:"⚠️ Must work alone"})]})})]}),s.jsxs("div",{className:"mt-3",children:[s.jsx("div",{className:"text-sm font-semibold mb-1",children:"Notes:"}),s.jsx("input",{className:"w-full border rounded px-2 py-1",placeholder:"Optional notes...",value:e.notes||"",onChange:N=>r(W=>({...W,notes:N.target.value}))})]})]})}const fm="newui_constraints_v1";function nd(){try{const e=localStorage.getItem(fm);return e?{byPeriod:JSON.parse(e).byPeriod||{}}:{byPeriod:{}}}catch{return{byPeriod:{}}}}function pm(e){localStorage.setItem(fm,JSON.stringify(e))}function Fr(e){const t=nd(),n=String(e);return t.byPeriod[n]||{together:[],apart:[]}}function sd(e,t){const n=nd();n.byPeriod[String(e)]={together:t.together.slice(),apart:t.apart.slice()},pm(n)}function qx(e,t,n){const r=Fr(e),o=[t,n];r.together.some(([i,a])=>String(i)===String(t)&&String(a)===String(n)||String(i)===String(n)&&String(a)===String(t))||r.together.push(o),sd(e,r)}function e0(e,t,n){const r=Fr(e),o=[t,n];r.apart.some(([i,a])=>String(i)===String(t)&&String(a)===String(n)||String(i)===String(n)&&String(a)===String(t))||r.apart.push(o),sd(e,r)}function Tu(e,t,n,r){const o=Fr(e),l=(t==="together"?o.together:o.apart).filter(([i,a])=>!(String(i)===String(n)&&String(a)===String(r)||String(i)===String(r)&&String(a)===String(n)));t==="together"?o.together=l:o.apart=l,sd(e,o)}function t0(){return nd()}function to(e){pm({byPeriod:(e==null?void 0:e.byPeriod)||{}})}function mm(e){return(e||"").trim()}function Sn(e){return mm(e).replace(/\s+/g," ").toLowerCase()}function n0(e){const t=(e||"").trim().toLowerCase();return["no","n","false","0","i'm fine to sit with anyone","fine with anyone","none","no preference","no selections","n/a","skip"].includes(t)}function s0(e){const t=(e||"").trim().toLowerCase();return["yes","y","true","1"].includes(t)}function Du(e){return e?e.split(",").map(t=>t.trim()).filter(Boolean):[]}function r0(){const[e,t]=d.useState(null),[n,r]=d.useState([]),[o,l]=d.useState(null),[i,a]=d.useState(!1),[c,u]=d.useState(null),[m,E]=d.useState(null),[S,j]=d.useState(mt()),[L,N]=d.useState(pn()),[W,x]=d.useState(0),f=et(),v=f.currentId,[D,M]=d.useState(null),[G,J]=d.useState(!0),[U,te]=d.useState(!0),[ae,Y]=d.useState(""),[ce,$e]=d.useState(0),xe=Fr(v),[H,ge]=d.useState(null),[ne,h]=d.useState({name:"",gender:"F",periodId:v??null});uo.useEffect(()=>{const y=()=>N(pn());return window.addEventListener("focus",y),()=>window.removeEventListener("focus",y)},[]),uo.useEffect(()=>{if(!D)return;const y=setTimeout(()=>M(null),6e3);return()=>clearTimeout(y)},[D]),uo.useEffect(()=>{if(!L.length)return;const y=new Map;for(const ie of L){const we=(ie.name||"").trim().toLowerCase();if(!we)continue;const ee=y.get(we)||[];ee.push(ie),y.set(we,ee)}const R=new Map;for(const[ie,we]of y.entries()){let ee=we[0];for(const ze of we){const Ce=ze.icon,ye=(ze.color||"").toLowerCase()!=="#9ca3af",Ee=ee.icon,pe=(ee.color||"").toLowerCase()!=="#9ca3af";(Ce&&!Ee||Ce===Ee&&ye&&!pe)&&(ee=ze)}R.set(ie,ee.id)}const z=mt();let X=!1;const re=z.map(ie=>{const we=ie.tagIds||[];if(!we.length)return ie;const ee=[],ze=new Set;for(const Ce of we){const ye=L.find(B=>String(B.id)===String(Ce));if(!ye)continue;const Ee=(ye.name||"").trim().toLowerCase(),pe=R.get(Ee)||Ce,se=String(pe);ze.has(se)||(ee.push(pe),ze.add(se))}return ee.length!==we.length||ee.some((Ce,ye)=>String(Ce)!==String(we[ye]))?(X=!0,{...ie,tagIds:ee}):ie});X&&(En(re),j(mt()))},[L]);const k=d.useMemo(()=>{const y=S.filter(z=>(z.periodIds||[]).some(X=>String(X)===String(v))),R=z=>{var X;return((X=(z||"").trim().split(/\s+/)[0])==null?void 0:X.toLowerCase())||""};return y.slice().sort((z,X)=>R(z.fullName).localeCompare(R(X.fullName)))},[S,v]),_=d.useMemo(()=>{const y=ae.trim().toLowerCase();return y?k.filter(z=>(z.fullName||"").toLowerCase().includes(y)):k},[k,ae]),A=k,[p,P]=d.useState("single"),[w,b]=d.useState(""),[C,I]=d.useState("F"),[q,K]=d.useState(""),le=async y=>{const R=await y.text(),{headers:z,rows:X}=Qx(R);!z.length||!X.length||(t(z),r(X),l(X[0]),a(!0))},je=y=>{const R=ee=>ee?e.indexOf(ee):-1,z=R(y.name),X=R(y.partnerRequest),re=R(y.strongPrefs),ie=R(y.regularPrefs),we=[];for(const ee of n){const ze=z>=0?mm(ee[z]):"";if(!ze)continue;const Ce=[];v!=null&&Ce.push(v);const ye=[],Ee=[];re>=0&&ye.push(...Du(ee[re])),ie>=0&&Ee.push(...Du(ee[ie]));const pe=Sn(ze),se=new Set;for(const Qe of ye){const Xe=Sn(Qe);!Xe||Xe===pe||se.size<3&&se.add(Xe)}const B=new Set;for(const Qe of Ee){const Xe=Sn(Qe);!Xe||Xe===pe||se.has(Xe)||B.size<5&&B.add(Xe)}const fe=X>=0?ee[X]:"";let Ae;s0(fe)?Ae=!1:(n0(fe)||se.size===0&&B.size===0)&&(Ae=!0);const Ke={id:Date.now()+"-"+Math.random().toString(36).slice(2),fullName:ze,happyWithAnyone:Ae,strongPreferences:Array.from(se).map(Qe=>Qe),preferences:Array.from(B).map(Qe=>Qe),periodIds:Ce};we.push(Ke)}return we},[Te,me]=d.useState(null),Pe=y=>{const R=mt(),z=new Map;for(const X of R)z.set(Sn(X.fullName),X.id);for(const X of y)z.set(Sn(X.fullName),X.id);return y.map(X=>{const re=[];for(const we of X.strongPreferences||[]){const ee=z.get(Sn(we));ee&&ee!==X.id&&!re.includes(ee)&&re.push(ee)}const ie=[];for(const we of X.preferences||[]){const ee=z.get(Sn(we));ee&&ee!==X.id&&!re.includes(ee)&&!ie.includes(ee)&&ie.push(ee)}return{...X,strongPreferences:re,preferences:ie}})},Le=y=>{const R=je(y);u(y),a(!1);const z=mt(),X=new Map(z.map(ie=>[Sn(ie.fullName),ie])),re=[];for(const ie of R){const we=X.get(Sn(ie.fullName));we&&re.push({existing:we,incoming:ie})}me(R),re.length?Oe(R,re.map(()=>"merge")):Oe(R,[])},Oe=(y,R)=>{const z=Pe(y);let X=0;const re=Hx(z,{onCollision:(ie,we)=>{const ee=R[X]??"merge";return X++,ee}});j(mt()),E(null),me(null),M(`Import applied. Added ${re.added.length}, merged ${re.merged.length}, skipped ${re.skipped.length}.`)},F=y=>{var we;const R=v??((we=f.periods[0])==null?void 0:we.id)??null;if(!R){alert("Please create/select a Period first (Periods tab).");return}const z=y.map(ee=>({id:Date.now()+"-"+Math.random().toString(36).slice(2),fullName:ee.name.trim(),gender:ee.gender,tagIds:[],happyWithAnyone:void 0,strongPreferences:[],preferences:[],periodIds:[R]})).filter(ee=>ee.fullName);if(!z.length)return;const X=mt(),re=new Map(X.map(ee=>[Sn(ee.fullName),ee])),ie=[];for(const ee of z){const ze=re.get(Sn(ee.fullName));ze&&ie.push({existing:ze,incoming:ee})}me(z),ie.length?E(ie):Oe(z,[])},oe=()=>{const y=w.trim();y&&(F([{name:y,gender:C}]),b(""))},$=()=>{const y=q.split(/\r?\n/),R=[];for(const z of y){const X=z.trim();if(!X)continue;const re=X.match(/^(.*?)(?:\s*[,-]\s*([FfMmOo]))?$/);if(re){const ie=re[1].trim(),we=(re[2]||"").toUpperCase();R.push({name:ie,gender:we||void 0})}else R.push({name:X})}R.length&&(F(R),K(""))},O=d.useMemo(()=>{const y=new Map;return S.forEach(R=>(R.periodIds||[]).forEach(z=>y.set(z,(y.get(z)||0)+1))),y},[S]);return s.jsxs("div",{className:"p-6 space-y-4 bg-slate-50 min-h-screen",children:[s.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold mb-3",children:"Select Class Period"}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[(f.periods||[]).map(y=>{const R=String(y.id)===String(v),z=O.get(y.id)||0;return s.jsxs("button",{className:(R?"bg-violet-600 text-white":"bg-white border-2 border-slate-300 text-slate-800 hover:bg-slate-50")+" px-4 py-2 rounded-lg text-sm font-medium transition-colors",onClick:()=>{Ut(y.id),x(X=>X+1)},children:[y.name," (",z," students)"]},String(y.id))}),(f.periods||[]).length===0&&s.jsx("div",{className:"text-sm text-slate-500",children:"No periods yet. Add periods on the Room Setup tab."})]})]}),s.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Add Students"}),s.jsxs("div",{className:"flex items-center gap-3",children:[D&&s.jsx("div",{className:"rounded-lg border border-green-200 bg-green-50 px-4 py-1.5 text-sm text-green-800 shadow-sm",children:D}),s.jsx("button",{className:"text-indigo-700 text-sm",onClick:()=>P(p==="single"?"bulk":"single"),children:p==="single"?"Switch to Bulk Add":"Switch to Single Add"})]})]}),p==="single"?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{className:"flex-1 border rounded px-3 py-2",placeholder:"Student name",value:w,onChange:y=>b(y.target.value)}),s.jsxs("select",{className:"border rounded px-2 py-2",value:C,onChange:y=>I(y.target.value),children:[s.jsx("option",{value:"F",children:"Female"}),s.jsx("option",{value:"M",children:"Male"}),s.jsx("option",{value:"O",children:"Other/Prefer not"})]}),s.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white",onClick:oe,children:"+ Add"})]}):s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-slate-600 mb-2",children:"Enter one student per line: Name, Gender (F/M/O)"}),s.jsx("textarea",{className:"w-full border rounded p-2 h-40 font-mono",placeholder:`Alice Johnson, F
Bob Smith, M
Charlie Davis, O`,value:q,onChange:y=>K(y.target.value)}),s.jsx("div",{className:"mt-2",children:s.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white",onClick:$,children:"Add All Students"})})]})]}),s.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Import from CSV"}),s.jsx("p",{className:"text-sm text-slate-600",children:"Import students from CSV with partner intent and strong/regular preferences."}),s.jsx("div",{className:"mt-3",children:s.jsx("input",{type:"file",accept:".csv,text/csv",onChange:y=>{var z;const R=(z=y.target.files)==null?void 0:z[0];R&&le(R)}})})]}),s.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold text-lg",children:"📋 Constraints"}),s.jsx("button",{className:"px-3 py-1 rounded border",onClick:()=>te(y=>!y),children:U?"Hide Constraints":"Show Constraints"})]}),v?U?s.jsxs("div",{children:[s.jsx("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:s.jsx(o0,{students:A,periodId:v,onChanged:()=>$e(y=>y+1)})}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold mb-2 text-green-700",children:"🤝 Must work together"}),s.jsxs("div",{className:"border-2 border-green-200 bg-green-50 rounded p-3 min-h-[100px]",children:[(xe.together||[]).length===0&&s.jsx("div",{className:"text-slate-500 italic",children:"None"}),(xe.together||[]).map(([y,R],z)=>{var ie,we;const X=((ie=A.find(ee=>String(ee.id)===String(y)))==null?void 0:ie.fullName)||String(y),re=((we=A.find(ee=>String(ee.id)===String(R)))==null?void 0:we.fullName)||String(R);return s.jsxs("div",{className:"flex items-center justify-between mb-2 p-2 bg-white rounded",children:[s.jsxs("span",{children:[X," + ",re]}),s.jsx("button",{className:"text-rose-600 hover:text-rose-800 font-bold",onClick:()=>{Tu(v,"together",y,R),$e(ee=>ee+1)},children:"×"})]},z)})]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold mb-2 text-rose-700",children:"❌ Must stay apart"}),s.jsxs("div",{className:"border-2 border-rose-200 bg-rose-50 rounded p-3 min-h-[100px]",children:[(xe.apart||[]).length===0&&s.jsx("div",{className:"text-slate-500 italic",children:"None"}),(xe.apart||[]).map(([y,R],z)=>{var ie,we;const X=((ie=A.find(ee=>String(ee.id)===String(y)))==null?void 0:ie.fullName)||String(y),re=((we=A.find(ee=>String(ee.id)===String(R)))==null?void 0:we.fullName)||String(R);return s.jsxs("div",{className:"flex items-center justify-between mb-2 p-2 bg-white rounded",children:[s.jsxs("span",{children:[X," × ",re]}),s.jsx("button",{className:"text-rose-600 hover:text-rose-800 font-bold",onClick:()=>{Tu(v,"apart",y,R),$e(ee=>ee+1)},children:"×"})]},z)})]})]})]})]}):s.jsx("div",{className:"text-sm text-slate-600",children:"Constraints hidden."}):s.jsx("div",{className:"text-sm text-slate-600",children:"Select a period to manage constraints."})]}),s.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold text-lg",children:"Students in Current Period"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{className:"border rounded px-2 py-1 text-sm",placeholder:"Search students...",value:ae,onChange:y=>Y(y.target.value)}),s.jsx("button",{className:"px-3 py-1 rounded border",onClick:()=>J(y=>!y),children:G?"Hide Students":"Show Students"})]})]}),v?G?s.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[_.map(y=>s.jsx(Zx,{student:y,peers:A,tags:L,onEdit:()=>{ge(y),h({name:y.fullName||"",gender:y.gender||"F",periodId:(y.periodIds||[v])[0]||v||null})},onUpdate:R=>{const z=S.findIndex(re=>String(re.id)===String(y.id));if(z<0)return;const X=S.slice();X[z]=R({...X[z]}),En(X),j(mt())},onRemove:()=>{const R=S.findIndex(re=>String(re.id)===String(y.id));if(R<0)return;const z=S.slice(),X={...z[R]};X.periodIds=(X.periodIds||[]).filter(re=>String(re)!==String(v)),!X.periodIds||X.periodIds.length===0?z.splice(R,1):z[R]=X,En(z),j(mt())}},String(y.id))),_.length===0&&s.jsx("div",{className:"text-sm text-slate-600",children:"No students yet. Use Add Students above or import from CSV."})]}):s.jsx("div",{className:"text-sm text-slate-600",children:"Students hidden."}):s.jsx("div",{className:"text-sm text-slate-600",children:"Select a period to view and edit its roster."})]}),i&&e&&o&&s.jsx(Kx,{headers:e,previewRow:o,onCancel:()=>a(!1),onConfirm:y=>Le(y)}),m&&Te&&s.jsx(Yx,{items:m,onCancel:()=>{E(null),me(null)},onResolve:y=>Oe(Te,y)}),H&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:s.jsxs("div",{className:"w-full max-w-md rounded-xl bg-white p-6 shadow-xl",children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Edit Student"}),s.jsxs("div",{className:"mt-3 space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-slate-600",children:"Full Name"}),s.jsx("input",{className:"mt-1 w-full rounded border px-3 py-2",value:ne.name,onChange:y=>h(R=>({...R,name:y.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-slate-600",children:"Gender"}),s.jsxs("select",{className:"mt-1 w-full rounded border px-3 py-2",value:ne.gender,onChange:y=>h(R=>({...R,gender:y.target.value})),children:[s.jsx("option",{value:"F",children:"Female"}),s.jsx("option",{value:"M",children:"Male"}),s.jsx("option",{value:"O",children:"Other/Prefer not"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-slate-600",children:"Class Period"}),s.jsx("select",{className:"mt-1 w-full rounded border px-3 py-2",value:ne.periodId?String(ne.periodId):"",onChange:y=>h(R=>({...R,periodId:y.target.value?y.target.value:null})),children:(f.periods||[]).map(y=>s.jsx("option",{value:String(y.id),children:y.name},String(y.id)))})]})]}),s.jsxs("div",{className:"mt-5 flex justify-end gap-2",children:[s.jsx("button",{className:"rounded border px-4 py-2 text-sm text-slate-600",onClick:()=>ge(null),children:"Cancel"}),s.jsx("button",{className:"rounded bg-indigo-600 px-4 py-2 text-sm font-semibold text-white",onClick:()=>{if(!ne.name.trim()||!ne.periodId){alert("Name and period are required.");return}const y=S.findIndex(re=>String(re.id)===String(H.id));if(y<0){ge(null);return}const R=!(H.periodIds||[]).some(re=>String(re)===String(ne.periodId)),z={...H,fullName:ne.name.trim(),gender:ne.gender,periodIds:[ne.periodId],strongPreferences:R?[]:H.strongPreferences,preferences:R?[]:H.preferences},X=S.slice();X[y]=z,En(X),j(mt()),R&&x(re=>re+1),ge(null)},children:"Save"})]})]})})]})}function o0({students:e,periodId:t,onChanged:n}){const[r,o]=d.useState(""),[l,i]=d.useState("");return s.jsxs(s.Fragment,{children:[s.jsxs("select",{className:"border-2 rounded-lg px-3 py-2",value:r,onChange:a=>o(a.target.value),children:[s.jsx("option",{value:"",children:"Student A"}),e.map(a=>s.jsx("option",{value:String(a.id),children:a.fullName},String(a.id)))]}),s.jsxs("select",{className:"border-2 rounded-lg px-3 py-2",value:l,onChange:a=>i(a.target.value),children:[s.jsx("option",{value:"",children:"Student B"}),e.map(a=>s.jsx("option",{value:String(a.id),children:a.fullName},String(a.id)))]}),s.jsx("button",{className:"px-3 py-2 rounded-lg bg-green-600 hover:bg-green-700 text-white font-medium transition-colors",onClick:()=>{!r||!l||r===l||(qx(t,r,l),o(""),i(""),n())},children:"Add Together"}),s.jsx("button",{className:"px-3 py-2 rounded-lg bg-rose-600 hover:bg-rose-700 text-white font-medium transition-colors",onClick:()=>{!r||!l||r===l||(e0(t,r,l),o(""),i(""),n())},children:"Add Apart"})]})}const rd="newui_history_v1";function od(){try{const e=localStorage.getItem(rd);return e?{byPeriod:JSON.parse(e).byPeriod||{}}:{byPeriod:{}}}catch{return{byPeriod:{}}}}function l0(e){localStorage.setItem(rd,JSON.stringify(e))}function Gn(e){const t=od(),n=String(e),r=t.byPeriod[n]||{work:{},solos:{},gotChoice:{}};return r.gotChoice||(r.gotChoice={}),r}function qs(e,t){const n=od();n.byPeriod[String(e)]={work:{...t.work},solos:{...t.solos},gotChoice:{...t.gotChoice||{}}},l0(n)}function i0(e,t,n){const r=Gn(e);r.gotChoice[String(t)]=n,qs(e,r)}function a0(e,t,n){const r=Gn(e);r.solos[String(t)]=n,qs(e,r)}function c0(e,t,n,r){const o=Gn(e),l=[String(t),String(n)].sort().join("|");o.work[l]=r,qs(e,o)}function d0(e){const t=Gn(e);t.work={},qs(e,t)}function u0(e){const t=Gn(e);t.gotChoice={},qs(e,t)}function f0(e){const t=Gn(e);t.solos={},qs(e,t)}function p0(){return od()}function no(e){const t={byPeriod:(e==null?void 0:e.byPeriod)||{}};localStorage.setItem(rd,JSON.stringify(t))}function m0(e){const t=(e||"").toUpperCase();return t==="M"||t==="F"?t:"O"}function g0(e){return{id:e.id,name:e.fullName,gender:m0(e.gender),preferences:(e.preferences||[]).slice(),strongPreferences:(e.strongPreferences||[]).slice(),canWorkSolo:!!e.canWorkSolo,mustWorkAlone:!!e.mustWorkAlone,gotChoice:e.gotChoice||0,solo:e.solo||0}}function h0(){const e=et(),t=e.currentId;if(!t)return null;const n=e.periods.find(l=>String(l.id)===String(t));return!n||!n.layoutId?null:$s().find(l=>String(l.id)===String(n.layoutId))||null||null}function x0(e){return e?Gn(e).work:{}}function v0(e){return e?Gn(e).solos:{}}function b0(e){return e?Fr(e):{together:[],apart:[]}}function y0(e){const t=et(),n=t.currentId,l=mt().filter(j=>(j.periodIds||[]).some(L=>String(L)===String(n))).map(g0),i=h0(),a=b0(n),c=x0(n),u=v0(n),m={students:l,groupingMode:e.groupingMode,groupSize:e.groupSize,numberOfGroups:e.numberOfGroups,randomizeMode:e.randomizeMode,balanceByGender:!!e.balanceByGender,workHistory:c,soloHistory:u,mustWorkTogether:a.together,mustStayApart:a.apart,currentLayoutId:(t.periods.find(j=>String(j.id)===String(n))||{layoutId:null}).layoutId,getCurrentLayout:()=>i||null,autoApproveUnequalGroups:!!e.autoApproveUnequalGroups,showWarnings:!!e.showWarnings};if(!e.createGroupsImpl)return{groups:[],warnings:["Legacy algorithm not bound yet"],args:m};let E=e.createGroupsImpl(m);if(!E||!Array.isArray(E))return{groups:[],warnings:[],args:m};if(e.groupingMode==="size"&&e.groupSize&&e.balanceByGender&&!e.autoApproveUnequalGroups&&E.some(j=>j.length>e.groupSize)){const j=E.filter(N=>N.length>e.groupSize).length;if(!confirm(`⚠️ GENDER BALANCE DECISION

${j} group${j>1?"s":""} exceed${j>1?"":"s"} the requested size of ${e.groupSize}, likely due to gender balance or constraints.

Options:
1) Keep gender balance (OK) and allow oversize group(s).
2) Prioritize group size (Cancel) — relax gender balance to keep groups at or under ${e.groupSize}.`)&&(E=e.createGroupsImpl({...m,balanceByGender:!1,autoApproveUnequalGroups:!0,showWarnings:!1}),!E||!Array.isArray(E)))return{groups:[],warnings:[],args:m}}return{groups:E.map(j=>j.map(L=>L.id)),warnings:[],args:m}}console.log("🟢 GroupingAlgorithm.js (FIXED v2) file loaded!");const w0=(e,t)=>{const n=[];return t&&e.forEach(r=>{if(r.gender==="O"||r.gender!=="M"&&r.gender!=="F")return;const o=[...r.preferences||[],...r.strongPreferences||[]];if(o.length===0)return;if(o.filter(i=>{const a=e.find(c=>c.id===i);return a?a.gender===r.gender||a.gender==="O":!1}).length===0){const i=o.map(c=>e.find(u=>u.id===c)).filter(c=>c).map(c=>`${c.name} (${c.gender==="M"?"Male":c.gender==="F"?"Female":"Other"})`),a=r.gender==="M"?"Male":"Female";n.push({student:r,type:"no-achievable-preferences",message:`${r.name} (${a}) has preferences [${i.join(", ")}] but none are the same gender. With gender balance enabled, these preferences cannot be satisfied.`,suggestion:`Consider asking ${r.name} to add same-gender preferences, or disable gender balance if cross-gender pairing is acceptable.`})}}),n};function S0({students:e,groupSize:t,groupingMode:n,numberOfGroups:r,randomizeMode:o,balanceByGender:l,workHistory:i,soloHistory:a,mustWorkTogether:c,mustStayApart:u,currentLayoutId:m,getCurrentLayout:E,autoApproveUnequalGroups:S=!1,showWarnings:j=!0,_recursed:L=!1}){if(e.length===0)return[];if(j){const h=w0(e,l);if(h.length>0&&(console.warn(`⚠️ Found ${h.length} preference warning(s):`),h.forEach(k=>{console.warn(`  • ${k.message}`)}),!S)){const k=h.map(P=>P.student.name).join(", "),_=h.length>1?"s":"",A=h.length>1?"have":"has",p=`⚠️ PREFERENCE WARNING

${h.length} student${_} ${A} preferences that cannot be satisfied:

${k}

These student${_} only listed cross-gender preferences, but gender balance is enabled. They will be paired with available same-gender students instead.

Suggestions:
• Ask these students to add same-gender preferences, OR
• Disable gender balance if cross-gender pairing is acceptable

Continue with grouping anyway?`;if(!confirm(p))return console.log("User cancelled grouping due to preference warnings"),null}}const N=[];let W=[];const x=e.filter(h=>h.mustWorkAlone),f=e.filter(h=>!h.mustWorkAlone);if(console.log(`Must Work Alone: ${x.length} students`),console.log(`Available for grouping: ${f.length} students`),n==="tables"){const h=E();if(!h)return alert("Select a table layout first!"),null;W=h.tables.map(_=>_.capacity);const k=W.reduce((_,A)=>_+A,0);if(l){const _={};f.forEach(b=>{_[b.gender]=(_[b.gender]||0)+1}),console.log(`Gender distribution: ${JSON.stringify(_)}`),console.log(`Tables: ${W.length} tables with capacities: ${W.join(", ")}`);const A=_.M||0,p=_.F||0;_.O;const P=W.filter(b=>b>=3).length*2,w=W.filter(b=>b>=3).length*2;if((A>0&&A<P||p>0&&p<w)&&(console.warn("⚠️ Gender isolation is likely with current table configuration"),!S)){const b=`⚠️ GENDER BALANCE WARNING

With ${A} males and ${p} females distributed across ${W.length} tables,
some students will be isolated (only one of their gender in a group).

The algorithm will split groups to avoid isolation, which may create more groups than tables.

Continue? (Extra temporary tables will be created if needed)`;if(!confirm(b))return null}}if(k<f.length){const _=`⚠️ NOT ENOUGH SEATS!

Tables can hold: ${k} students
Students needing groups: ${f.length}

Click OK to proceed anyway, or Cancel to fix your table layout.`;if(!confirm(_))return null}}else if(n==="count"){const h=Math.floor(f.length/r),k=f.length%r;for(let _=0;_<r;_++)W.push(h+(_<k?1:0))}else{const h=Math.ceil(f.length/t);for(let k=0;k<h;k++)W.push(t)}let v;n==="tables"?(v=Math.round(W.reduce((k,_)=>k+_,0)/W.length),console.log(`Table mode: effectiveGroupSize = ${v} (based on table capacities)`)):n==="count"?v=Math.ceil(f.length/r):v=t;const D=(h,k)=>{const _=[String(h),String(k)].sort().join("-");return i[_]||0},M=(h,k)=>{const _=String(h.id),A=String(k.id),p=u.some(P=>{const w=String(P[0]),b=String(P[1]);return w===_&&b===A||w===A&&b===_});return p&&console.log(`⚠️ Cannot group ${h.name} with ${k.name} - must stay apart`),!p},G=h=>{if(!l||h.length<3)return!1;const k={};return h.forEach(_=>{_.gender!=="O"&&(k[_.gender]=(k[_.gender]||0)+1)}),Object.values(k).some(_=>_===1)},J=(h,k)=>{const _=String(h.id),A=String(k.id),p=(h.preferences||[]).map(q=>String(q)),P=(h.strongPreferences||[]).map(q=>String(q)),w=(k.preferences||[]).map(q=>String(q)),b=(k.strongPreferences||[]).map(q=>String(q)),C=p.includes(A)||P.includes(A),I=w.includes(_)||b.includes(_);return C&&I},U=(h,k,_=.2)=>{let A=0;A+=Math.random()*_*10;const p=(h.preferences||[]).map(b=>String(b)),P=(h.strongPreferences||[]).map(b=>String(b)),w=String(h.id);for(const b of k){const C=String(b.id),I=(b.preferences||[]).map(K=>String(K)),q=(b.strongPreferences||[]).map(K=>String(K));P.includes(C)&&(A+=10),p.includes(C)&&(A+=5),q.includes(w)&&(A+=8),I.includes(w)&&(A+=3)}A-=(h.gotChoice||0)*3;for(const b of k)A-=D(h.id,b.id)*2;return A},te=[...f].sort((h,k)=>{const _=(h.gotChoice||0)-(k.gotChoice||0);if(_!==0)return _;if(h.canWorkSolo&&k.canWorkSolo){const A=(h.solo||0)+(a[String(h.id)]||0),p=(k.solo||0)+(a[String(k.id)]||0);if(A!==p)return A-p}else if(h.canWorkSolo!==k.canWorkSolo)return h.canWorkSolo?1:-1;return 0});console.log("Student ordering (considering solo history):"),te.slice(0,5).forEach(h=>{const k=(h.solo||0)+(a[String(h.id)]||0);console.log(`  ${h.name}: gotChoice=${h.gotChoice||0}, canWorkSolo=${h.canWorkSolo}, totalSoloCount=${k}`)});const ae=new Set,Y=[];let ce=0,$e={M:0,F:0,O:0};if(l&&v===2){const h={M:0,F:0,O:0};f.forEach(k=>{h[k.gender]=(h[k.gender]||0)+1}),console.log(`
--- Pre-Selecting Solos (Gender Balance Mode) ---`),console.log(`Gender counts: M=${h.M}, F=${h.F}, O=${h.O}`),h.M%2===1&&($e.M=1,ce++,console.log(`Need 1 male solo (odd number: ${h.M})`)),h.F%2===1&&($e.F=1,ce++,console.log(`Need 1 female solo (odd number: ${h.F})`)),h.O%2===1&&($e.O=1,ce++,console.log(`Need 1 'other' solo (odd number: ${h.O})`))}else if(!l&&v===2)f.length%2===1&&(ce=1,console.log(`
--- Pre-Selecting Solos ---`),console.log(`Need 1 solo (odd number of students: ${f.length})`));else{const h=W.reduce((k,_)=>k+_,0);ce=Math.max(0,f.length-h),ce>0&&(console.log(`
--- Pre-Selecting Solos ---`),console.log(`Students: ${f.length}, Seats: ${h}, Solos needed: ${ce}`))}if(ce>0){for(const[h,k]of Object.entries($e)){if(k===0)continue;const _=f.filter(K=>K.gender===h&&K.canWorkSolo&&!ae.has(String(K.id)));if(_.length===0){console.warn(`⚠️ No ${h} students can work solo - will use fallback method`);continue}const A=_.map(K=>({student:K,soloCount:(K.solo||0)+(a[String(K.id)]||0)})),p={};A.forEach(({student:K,soloCount:le})=>{p[le]||(p[le]=[]),p[le].push(K)});const w=Object.keys(p).map(Number).sort((K,le)=>K-le)[0],I=[...p[w]].sort(()=>Math.random()-.5)[0];Y.push(I),ae.add(String(I.id)),console.log(`✓ Pre-selected ${h==="M"?"Male":h==="F"?"Female":"Other"} solo: ${I.name} (solo count: ${w})`)}Y.length>0&&console.log(`Pre-selected ${Y.length} solo(s) successfully
`)}ce===0&&console.log(`No solos needed for this grouping
`);for(const[h,k]of c){const _=String(h),A=String(k);if(ae.has(_)||ae.has(A))continue;const p=te.find(w=>String(w.id)===_),P=te.find(w=>String(w.id)===A);if(p&&P&&!p.mustWorkAlone&&!P.mustWorkAlone){const w=[p,P];ae.add(String(p.id)),ae.add(String(P.id));let b=W[N.length]||t;for(;w.length<b;){let C=null,I=-999;for(const q of te){if(ae.has(q.id)||!w.every(le=>M(le,q)))continue;if(l&&b>=3){const le=[...w,q];if(le.length===b&&G(le))continue}const K=U(q,w);K>I&&(I=K,C=q)}if(C)w.push(C),ae.add(String(C.id));else break}N.push(w)}}let xe=N.length;for(;te.some(h=>!ae.has(String(h.id)))&&xe<W.length;){const h=W[xe],k=[],_=te.find(p=>!ae.has(String(p.id)));if(!_)break;for(k.push(_),ae.add(String(_.id));k.length<h;){let p=null,P=-999;for(const w of te){if(ae.has(String(w.id))||!k.every(C=>M(C,w)))continue;if(l&&h===2&&k.length===1){const C=k[0];if(C.gender!==w.gender&&C.gender!=="O"&&w.gender!=="O"&&!J(C,w))continue}if(l&&h>=3){const C=[...k,w];if(C.length===h&&G(C))continue}const b=U(w,k);b>P&&(P=b,p=w)}if(p)k.push(p),ae.add(String(p.id));else break}let A=[];if(l)if(k.length===2){const[p,P]=k;p.gender!==P.gender&&p.gender!=="O"&&P.gender!=="O"&&!J(p,P)?(console.log(`Splitting non-mutual cross-gender pair: ${p.name} & ${P.name}`),A=[[p],[P]]):A=[k]}else if(k.length>=3&&G(k))if(k.some(P=>!P.canWorkSolo))console.warn("⚠️ Group has gender isolation but contains students who cannot work solo - keeping together"),A=[k];else{console.log(`Splitting group with gender isolation (size ${k.length})`);const P={};k.forEach(w=>{P[w.gender]||(P[w.gender]=[]),P[w.gender].push(w)});for(const[w,b]of Object.entries(P))if(b.length===1&&w!=="O"){let C=!1;for(let I=N.length-1;I>=0;I--)if(N[I].length===1&&N[I][0].gender===w){N[I].push(b[0]),console.log(`Paired solo ${b[0].name} with existing solo ${N[I][0].name}`),C=!0;break}C||(A.push(b),console.log(`Creating solo for ${b[0].name} after gender split`))}else A.push(b)}else A=[k];else A=[k];N.push(...A),xe++}const H=te.filter(h=>!ae.has(String(h.id)));for(const h of H){let k=!1;const _=N.filter(A=>A.every(p=>M(p,h))).sort((A,p)=>A.length-p.length);for(const A of _)if(l&&A.length>=2){const p=[...A,h];if(!G(p)){A.push(h),k=!0,console.log(`Added ${h.name} to existing group`);break}}else{A.push(h),k=!0,console.log(`Added ${h.name} to existing group`);break}if(!k){if(!h.canWorkSolo){console.log(`⚠️ ${h.name} ended up solo but canWorkSolo = false`);for(const A of N){const p=[...A,h];if(A.every(P=>M(P,h))&&!G(p)){A.push(h),k=!0,console.log(`Found emergency placement for ${h.name} who cannot work solo`);break}}k||console.log(`⚠️ Emergency placement failed - no valid groups without gender isolation for ${h.name}`)}if(!k&&l){for(let A=N.length-1;A>=0;A--)if(N[A].length===1&&N[A][0].gender===h.gender&&M(N[A][0],h)){N[A].push(h),console.log(`Paired solo ${h.name} with ${N[A][0].name}`),k=!0;break}}if(!k)if(h.canWorkSolo)(h.solo||0)+(a[String(h.id)]||0),N.push([h]),console.log(`Created solo group for ${h.name} (canWorkSolo=true, current solo count: ${h.solo||0})`);else{console.log(`⚠️ ${h.name} can't work solo - looking for swap candidates`);const A=[];let p={groupsChecked:0,membersChecked:0,canWorkSoloCount:0,constraintFailures:0,genderIsolationFailures:0};for(let P=0;P<N.length;P++){const w=N[P];if(w.length>1){p.groupsChecked++;for(const b of w)if(p.membersChecked++,b.canWorkSolo){p.canWorkSoloCount++;const C=w.filter(le=>le!==b),I=[...C,h],q=C.every(le=>M(le,h)),K=!G(I);if(!q)p.constraintFailures++,console.log(`  ✗ Cannot swap with ${b.name}: constraint violation`);else if(!K)p.genderIsolationFailures++,console.log(`  ✗ Cannot swap with ${b.name}: would create gender isolation`);else{const le=(b.solo||0)+(a[String(b.id)]||0);A.push({member:b,groupIndex:P,soloCount:le}),console.log(`  ✓ Found swap candidate: ${b.name} (solo count: ${le})`)}}}}if(console.log(`Swap search complete: ${A.length} candidates found`),console.log(`Debug: Checked ${p.groupsChecked} groups, ${p.membersChecked} members, ${p.canWorkSoloCount} can work solo`),console.log(`Failures: ${p.constraintFailures} constraint, ${p.genderIsolationFailures} gender isolation`),A.length>0){A.sort((b,C)=>b.soloCount-C.soloCount);let P=`⚠️ PLACEMENT DECISION NEEDED

`;P+=`${h.name} cannot be placed in any existing group without violating constraints,
`,P+=`and is marked as "Cannot Work Solo".

`,P+=`You can swap them with one of these students who CAN work solo:

`,A.forEach((b,C)=>{P+=`${C+1}. ${b.member.name} - Has worked solo ${b.soloCount} time(s)
`}),P+=`
Enter the number of the student you'd like to work solo (1-${A.length}),
`,P+=`or click Cancel to have ${h.name} work solo anyway.`;const w=prompt(P);if(w!==null){const b=parseInt(w);if(b>=1&&b<=A.length){const C=A[b-1];console.log(`✅ Teacher chose: ${C.member.name} to work solo (has worked solo ${C.soloCount} times)`),N[C.groupIndex]=N[C.groupIndex].filter(I=>I!==C.member),N[C.groupIndex].push(h),N.push([C.member]),k=!0}else console.warn(`Invalid choice: ${w}`)}}if(!k)if(A.length===0){console.warn("⚠️ No valid swap candidates with strict rules - trying lenient search");const P=[];for(let w=0;w<N.length;w++){const b=N[w];if(b.length>1){for(const C of b)if(C.canWorkSolo&&b.filter(q=>q!==C).every(q=>M(q,h))){const q=(C.solo||0)+(a[String(C.id)]||0);P.push({member:C,groupIndex:w,soloCount:q}),console.log(`  ✓ Lenient search found: ${C.name} (may create gender isolation)`)}}}if(P.length>0){P.sort((C,I)=>C.soloCount-I.soloCount);let w=`⚠️ PLACEMENT DECISION NEEDED

`;w+=`${h.name} cannot work solo and has no ideal group placement.

`,w+=`These students CAN work solo (swapping may create gender isolation):

`,P.forEach((C,I)=>{w+=`${I+1}. ${C.member.name} - Solo count: ${C.soloCount}
`}),w+=`
Enter number (1-${P.length}) or Cancel to place ${h.name} solo.`;const b=prompt(w);if(b!==null){const C=parseInt(b);if(C>=1&&C<=P.length){const I=P[C-1];console.log(`✅ Teacher chose: ${I.member.name} to work solo`),N[I.groupIndex]=N[I.groupIndex].filter(q=>q!==I.member),N[I.groupIndex].push(h),N.push([I.member]),k=!0}}}k||(console.error(`❌ CRITICAL: Absolutely no swap candidates found for ${h.name}`),alert(`⚠️ WARNING

${h.name} is marked "Cannot Work Solo" but cannot be placed in any group due to constraints.

They will be placed solo anyway.

Consider adjusting their "Must Stay Apart" constraints or "Can Work Solo" setting.`),N.push([h]))}else console.log(`Teacher cancelled - placing ${h.name} solo anyway`),N.push([h])}}}for(const h of Y)N.push([h]),console.log(`Added ${h.name} as pre-selected solo`);for(const h of x)N.push([h]),console.log(`Added ${h.name} as forced solo`);const ge=N.filter(h=>h.length===1&&!h[0].mustWorkAlone&&h[0].canWorkSolo===!1).map(h=>h[0].name);ge.length>0&&(console.warn("⚠️ WARNING: The following students are solo but have canWorkSolo=false:"),ge.forEach(h=>console.warn(`   - ${h}`)),console.warn("Consider adjusting settings or constraints to avoid this."));const ne=N.filter(h=>h.length===1).map(h=>h[0]);if(ne.length>0&&(console.log(`
📊 Solo assignments this round: ${ne.length} students`),ne.forEach(h=>{(h.solo||0)+(a[String(h.id)]||0),h.mustWorkAlone?console.log(`   - ${h.name} (Must Work Alone)`):console.log(`   - ${h.name} (Solo count: ${h.solo||0} → ${(h.solo||0)+1})`)}),console.log(`
Note: The 'solo' field should be incremented when groups are accepted/saved in ClassSeats.`)),l){console.log(`
--- Rebalancing Phase ---`),console.log(`Target group size: ${v}`);const h=k=>{for(let _=0;_<k.length;_++)for(let A=_+1;A<k.length;A++)if(!M(k[_],k[A]))return!1;return!0};if(v===2){console.log("Target size is 2 (pairs) - preserving pair structure");const k=[];for(const w of N)if(w.length<=2&&h(w))k.push(w);else if(w.length>2){console.log(`Splitting group of ${w.length} into pairs`);for(let b=0;b<w.length;b+=2)if(b+1<w.length){const C=[w[b],w[b+1]];h(C)?k.push(C):(w[b].canWorkSolo?k.push([w[b]]):(console.log(`⚠️ ${w[b].name} cannot work solo - keeping in problematic pair`),k.push(C)),w[b+1].canWorkSolo?k.push([w[b+1]]):w[b].canWorkSolo&&(console.log(`⚠️ ${w[b+1].name} cannot work solo - keeping in problematic pair`),k.push([w[b],w[b+1]])))}else if(w[b].canWorkSolo)k.push([w[b]]);else{console.log(`⚠️ ${w[b].name} cannot work solo - attempting to pair with existing group`);let C=!1;for(let I=k.length-1;I>=0;I--){const q=k[I];if(q.length===1&&M(q[0],w[b])){q.push(w[b]),C=!0,console.log(`Added ${w[b].name} to existing solo to avoid solo placement`);break}}C||(console.warn(`⚠️ Creating solo for ${w[b].name} despite canWorkSolo=false - no alternatives`),k.push([w[b]]))}}else console.log("Group has constraint violations, splitting"),w.forEach(b=>{b.canWorkSolo?k.push([b]):(console.warn(`⚠️ ${b.name} cannot work solo but has constraint violations - creating solo anyway`),k.push([b]))});const _=k.filter(w=>w.length===1),A=new Set;for(let w=0;w<_.length;w++){if(A.has(w))continue;const b=_[w][0];for(let C=w+1;C<_.length;C++){if(A.has(C))continue;const I=_[C][0];if(b.gender===I.gender&&M(b,I)){const q=k.indexOf(_[w]),K=k.indexOf(_[C]);q>K?(k.splice(q,1),k.splice(K,1)):(k.splice(K,1),k.splice(q,1)),k.push([b,I]),A.add(w),A.add(C),console.log(`Paired solos: ${b.name} with ${I.name}`);break}}}const P=k.filter(w=>w.length===1).filter(w=>!w[0].canWorkSolo);if(P.length>0){console.warn(`⚠️ Found ${P.length} solo(s) who cannot work solo after pairing attempts`);for(const w of P){const b=w[0];console.log(`Attempting to place ${b.name} who cannot work solo`);let C=!1;for(const I of k)if(I!==w&&I.length===2){const q=[...I,b];if(I.every(K=>M(K,b))&&!G(q)){I.push(b);const K=k.indexOf(w);k.splice(K,1),C=!0,console.log(`✅ Added ${b.name} to existing pair (creating group of 3, no gender isolation)`);break}}if(!C){console.warn(`⚠️ Could not place ${b.name} without gender isolation - trying lenient search`);for(const I of k)if(I!==w&&I.length===2&&I.every(q=>M(q,b))){I.push(b);const q=k.indexOf(w);k.splice(q,1),C=!0,console.log(`✅ Added ${b.name} to pair (may have gender isolation - but better than solo)`);break}}C||console.warn(`⚠️ Could not place ${b.name} in any group - they will remain solo despite canWorkSolo=false`)}}N.length=0,N.push(...k),console.log(`Rebalancing complete: ${N.length} groups (target was pairs)`)}else if(n==="tables"){console.log("Tables mode with larger groups - enforcing capacity constraints");const k=[];for(let A=0;A<N.length;A++){const p=N[A];if(p.length===2){const[P,w]=p;if(P.gender!==w.gender&&P.gender!=="O"&&w.gender!=="O"&&!J(P,w))if(console.warn(`⚠️ Cross-gender pair detected: ${P.name} & ${w.name} (no mutual preferences)`),S)k.push(p);else{const b=`⚠️ GENDER BALANCE DECISION

Found a cross-gender pair: ${P.name} (${P.gender==="M"?"Male":"Female"}) & ${w.name} (${w.gender==="M"?"Male":"Female"})

These students have no mutual preferences.

Options:
1. Split into SOLO groups (click OK) - Both work alone
2. Keep as CROSS-GENDER pair (click Cancel) - Allow this pairing

Split into solos?`;confirm(b)?(P.canWorkSolo?(k.push([P]),console.log(`Split ${P.name} into solo (teacher choice)`)):(k.push([P]),console.warn(`⚠️ ${P.name} cannot work solo but was split anyway`)),w.canWorkSolo?(k.push([w]),console.log(`Split ${w.name} into solo (teacher choice)`)):(k.push([w]),console.warn(`⚠️ ${w.name} cannot work solo but was split anyway`))):(k.push(p),console.log(`Keeping cross-gender pair: ${P.name} & ${w.name} (teacher approved)`))}else k.push(p)}else k.push(p)}const _=[];for(let A=0;A<k.length;A++){const p=k[A],P=W[A]||v;if(p.length<=P)_.push(p);else{console.warn(`⚠️ Group ${A+1} has ${p.length} students but table capacity is ${P} - splitting`),_.push(p.slice(0,P));const w=p.slice(P);console.log(`Overflow: ${w.map(b=>b.name).join(", ")}`);for(const b of w){let C=!1;for(let I=0;I<_.length;I++){const q=W[I]||v;if(_[I].length<q&&_[I].every(K=>M(K,b))){const K=[..._[I],b];if(K.length===2){const[le,je]=K;if(le.gender!==je.gender&&le.gender!=="O"&&je.gender!=="O"&&!J(le,je))continue}if(!G(K)){_[I].push(b),C=!0,console.log(`Placed ${b.name} in group ${I+1}`);break}}}if(!C){console.warn(`⚠️ Could not place ${b.name} without violating gender balance or capacity constraints`);const I=[];for(let q=0;q<_.length;q++)if(_[q].length===1){const K=_[q][0];K.gender!==b.gender&&K.gender!=="O"&&b.gender!=="O"&&M(K,b)&&I.push({index:q,partner:K})}if(I.length>0&&!S){const q=I.map(le=>le.partner.name).join(", "),K=`⚠️ GENDER BALANCE DECISION

${b.name} (${b.gender==="M"?"Male":"Female"}) cannot be placed without violating gender balance rules.

Potential cross-gender pairing${I.length>1?"s":""} available: ${q}

Options:
1. Create SOLO groups (click OK) - Both students work alone
2. Allow CROSS-GENDER pair (click Cancel) - Pair them despite different genders

Note: Cross-gender pairs without mutual preferences are typically avoided.

Create solo groups?`;if(confirm(K))if(b.canWorkSolo)_.push([b]),console.log(`Created solo group for ${b.name} (teacher choice: solos)`);else{const le=_.reduce((je,Te,me)=>Te.length<_[je].length?me:je,0);_[le].push(b),console.warn(`⚠️ ${b.name} cannot work solo - added to smallest group`)}else{const le=I[0];_[le.index].push(b),console.log(`Created cross-gender pair: ${le.partner.name} & ${b.name} (teacher approved)`),C=!0}}else if(b.canWorkSolo)_.push([b]),console.log(`Created solo group for ${b.name}`);else{const q=_.reduce((K,le,je)=>le.length<_[K].length?je:K,0);_[q].push(b),console.warn(`⚠️ Forced ${b.name} into group ${q+1} (cannot work solo)`)}}}}}N.length=0,N.push(..._),console.log(`Tables mode rebalancing complete: ${N.length} groups`)}else{const k=(P,w)=>{const b=[];let C=[...P];for(const I of w){if(C.length===0)break;let q=null;for(let K=0;K<=C.length-I;K++){const le=C.slice(K,K+I);if(h(le)){q=le,C=C.filter(je=>!le.includes(je));break}}q?b.push(q):console.log(`Could not form group of size ${I} due to constraints`)}return C.length>0&&b.push(C),b},_={};N.forEach((P,w)=>{if(P.length===1&&P[0].mustWorkAlone)return;const b=new Set(P.map(C=>C.gender).filter(C=>C!=="O"));if(b.size===0||b.size===1&&P.some(C=>C.gender==="O")){const C=b.size===0?"O":[...b][0];_[C]||(_[C]=[]),_[C].push({group:P,index:w})}else if(b.size===1){const C=[...b][0];_[C]||(_[C]=[]),_[C].push({group:P,index:w})}});const A=[],p=new Set;for(const[P,w]of Object.entries(_)){console.log(`Rebalancing ${P} groups: ${w.length} groups`),w.sort((C,I)=>C.group.length-I.group.length);let b=[];for(const{group:C,index:I}of w){p.add(I);let q=!0;for(const K of C){for(const le of b)if(!M(K,le)){q=!1,console.log(`Cannot combine groups: ${K.name} must stay apart from ${le.name}`);break}if(!q)break}if(q?b.push(...C):(b.length>0&&(A.push([...b]),b=[]),b.push(...C)),b.length>=3){if(b.length===4){if(h(b))A.push([...b]);else{const K=k(b,[2,2]);A.push(...K)}b=[]}else if(b.length===5){const K=k(b,[3,2]);A.push(...K),b=[]}else if(b.length===6){const K=k(b,[3,3]);A.push(...K),b=[]}else if(b.length===7){const K=k(b,[4,3]);A.push(...K),b=[]}else if(b.length===8){const K=k(b,[4,4]);A.push(...K),b=[]}}}if(b.length>0)if(b.length===1){let C=!1;const I=b[0];for(let q=A.length-1;q>=0;q--){const K=A[q];if(K.length<4&&K.every(le=>le.gender===P||le.gender==="O")&&K.every(le=>M(le,I))){K.push(I),C=!0,console.log(`Added remaining ${P} student to existing group`);break}}C||A.push(b)}else A.push(b)}N.forEach((P,w)=>{p.has(w)||A.push(P)}),N.length=0,N.push(...A),console.log(`Rebalancing complete: ${N.length} final groups`)}}if(n==="tables"&&N.length>W.length){const h=N.length-W.length;if(console.warn(`⚠️ Created ${h} extra groups due to gender balance constraints`),!S){const k=`⚠️ EXTRA GROUPS CREATED

Gender balance rules required creating ${h} additional group(s).

You have ${W.length} tables but need ${N.length} groups.

Temporary tables will be automatically added for this period.

Click OK to continue with temporary tables, or Cancel to adjust settings.`;if(!confirm(k))return null}}if(l&&n!=="tables"){console.log("Running final cross-gender pair validation...");const h=[];for(let k=0;k<N.length;k++){const _=N[k];if(_.length===2){const[A,p]=_;if(A.gender!==p.gender&&A.gender!=="O"&&p.gender!=="O"&&!J(A,p))if(console.warn(`⚠️ FINAL CHECK: Cross-gender pair detected in Group ${k+1}: ${A.name} (${A.gender}) & ${p.name} (${p.gender}) - no mutual preferences`),S)h.push(_),console.log(`Auto-approved cross-gender pair: ${A.name} & ${p.name}`);else{const P=`⚠️ GENDER BALANCE DECISION

Found a cross-gender pair in Group ${k+1}:
${A.name} (${A.gender==="M"?"Male":"Female"}) & ${p.name} (${p.gender==="M"?"Male":"Female"})

These students have no mutual preferences.

Options:
1. Split into SOLO groups (click OK) - Both work alone
2. Keep as CROSS-GENDER pair (click Cancel) - Allow this pairing

Split into solos?`;confirm(P)?(A.canWorkSolo||A.mustWorkAlone?(h.push([A]),console.log(`Split ${A.name} into solo (teacher choice)`)):(h.push([A]),console.warn(`⚠️ ${A.name} cannot work solo but was split anyway (teacher override)`)),p.canWorkSolo||p.mustWorkAlone?(h.push([p]),console.log(`Split ${p.name} into solo (teacher choice)`)):(h.push([p]),console.warn(`⚠️ ${p.name} cannot work solo but was split anyway (teacher override)`))):(h.push(_),console.log(`Keeping cross-gender pair: ${A.name} & ${p.name} (teacher approved)`))}else h.push(_)}else h.push(_)}N.length=0,N.push(...h),console.log(`Final validation complete: ${N.length} groups`)}return console.log(`
✓ Created ${N.length} groups`),N}console.log("✅ GroupingAlgorithm v2 loaded successfully!");const gm="newui_groupings_v1";function Ei(){try{const e=localStorage.getItem(gm);return e?{byPeriod:JSON.parse(e).byPeriod||{}}:{byPeriod:{}}}catch{return{byPeriod:{}}}}function ld(e){localStorage.setItem(gm,JSON.stringify(e))}function ii(e){return Ei().byPeriod[String(e)]||[]}function Mu(e,t){const n=Ei(),r=String(e),o=n.byPeriod[r]||[],l=t.id||Date.now()+"-"+Math.random().toString(36).slice(2),i=t.savedAt||new Date().toISOString();let a=t.tableAssignments;if(!a&&t.layoutId){const u=$s().find(m=>String(m.id)===String(t.layoutId));u&&(a=u.tables.reduce((m,E,S)=>(m[String(S)]=E.id,m),{}))}const c={id:l,savedAt:i,name:t.name,layoutId:t.layoutId??null,groups:t.groups,tablePositions:t.tablePositions,tableDimensions:t.tableDimensions,tableAssignments:a};n.byPeriod[r]=[c,...o],ld(n);try{const u=et(),m=u.periods.findIndex(E=>String(E.id)===r);if(m>=0){const E={...u.periods[m]};E.activeGrouping=c.groups,c.layoutId!==void 0&&(E.layoutId=c.layoutId),c.tableAssignments&&(E.tableAssignments={...c.tableAssignments}),u.periods[m]=E,lr(u)}}catch{}}function hm(e,t){const n=Ei(),r=String(e);n.byPeriod[r]=(n.byPeriod[r]||[]).filter(o=>o.id!==t),ld(n)}function N0(){return Ei()}function so(e){ld({byPeriod:(e==null?void 0:e.byPeriod)||{}})}function xm(e,t,n,r){if(e<=0)return{cols:1,rows:0};if(r===90)return e<=2?{cols:1,rows:e}:e<=4?{cols:1,rows:e}:e<=6?{cols:2,rows:Math.ceil(e/2)}:{cols:2,rows:Math.ceil(e/2)};if(e<=2)return{cols:e,rows:1};if(e<=4)return{cols:2,rows:Math.ceil(e/2)};if(e<=6)return t/n>1.5?{cols:3,rows:Math.ceil(e/3)}:{cols:2,rows:Math.ceil(e/2)};{const l=t/n>1.8?4:3;return{cols:l,rows:Math.ceil(e/l)}}}function j0(e,t=0){if(e<=0)return{width:140,height:100};const n=110,r=55,o=70,l=8,i=8,a=4,c=xm(e,200,100,t),u=c.cols*n+(c.cols-1)*a+i*2,m=o+c.rows*r+(c.rows-1)*a+l,E=Math.ceil(u/20)*20,S=Math.ceil(m/20)*20;return{width:E,height:S}}function vm(e,t=0){const n=j0(e,t);return{minWidth:n.width,minHeight:n.height,maxWidth:500,maxHeight:500}}function k0(e,t,n,r=0){const o=vm(n,r);return{width:Math.max(o.minWidth,Math.min(o.maxWidth,e)),height:Math.max(o.minHeight,Math.min(o.maxHeight,t))}}function bm(e){const{layout:t,groups:n,students:r,period:o,tablePositions:l={},tableDimensions:i={},tags:a,selectedTagIds:c}=e,u=new Map(r.map(H=>[String(H.id),H])),m=new Map(a.map(H=>[String(H.id),H])),E=Array.isArray(c)?new Set(c.map(H=>String(H))):null;let S=1/0,j=1/0,L=0,N=0;n.forEach((H,ge)=>{const ne=t.tables[ge],h=ne?ne.id:`temp-${ge}`,k=ne?{width:ne.width,height:ne.height}:{width:200,height:150},_=i[h]||k,A=(ne==null?void 0:ne.position)||{x:20+ge*220,y:20},p=l[h]||A;S=Math.min(S,p.x),j=Math.min(j,p.y),L=Math.max(L,p.x+_.width),N=Math.max(N,p.y+_.height)});const W=30;S=Math.max(0,S-W),j=Math.max(0,j-W),L+=W,N+=W;const x=L-S,f=N-j,v=C0(n,u,m,E),D=80,M=v.length?60:0,G=60,J=960,U=720-D-M-G,te=J/x,ae=U/f,Y=Math.min(Math.min(te,ae)*.92,1),ce=x*Y,$e=f*Y;let xe=`<html><head><title>${o.name} - Seating Chart</title><style>
    @page { size: landscape; margin: 0.5in; }
    body { font-family: Arial; padding: 10px; margin: 0; }
    h1 { text-align: center; margin-bottom: 10px; font-size: 18px; }
    .legend { text-align: center; margin-bottom: 15px; padding: 10px; background: #f9fafb; border: 1px solid #d1d5db; border-radius: 8px; }
    .legend-item { display: inline-flex; align-items: center; gap: 8px; margin: 0 10px; padding: 5px 10px; border-radius: 6px; font-size: 12px; font-weight: 600; border: 2px solid #cbd5f5; }
    .print-container { width: 100%; display: flex; justify-content: center; align-items: flex-start; overflow: hidden; }
    .classroom-wrapper { width: ${ce}px; height: ${$e}px; position: relative; margin: 0 auto; }
    .classroom-inner { transform: scale(${Y}); transform-origin: top left; width: ${x}px; height: ${f}px; position: absolute; top: 0; left: 0; }
    .classroom { position: relative; width: ${x}px; height: ${f}px; border: 2px solid #333; background: #f3f4f6; background-image: radial-gradient(circle, #d1d5db 1px, transparent 1px); background-size: 20px 20px; }
    .table { position: absolute; border: 2px solid #0a5f56; background: #fdfdfd; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); overflow: hidden; }
    .table.temporary { border: 2px solid #ea580c; background: #fff8f1; }
    .table-header { font-weight: bold; color: #0f766e; font-size: 14px; text-align: center; display: flex; justify-content: center; align-items: center; padding: 8px; background: #99f6e4; border-bottom: 2px solid #5eead4; }
    .table-header.temporary { color: #9a3412; background: #fed7aa; border-bottom: 2px solid #fdba74; }
    .student-area { padding: 8px; display: grid; gap: 4px; }
    .student-item { background: white; border-radius: 4px; padding: 5px 6px; font-size: 13px; font-weight: 600; text-align: center; border: 1px solid #e5e7eb; overflow: hidden; word-wrap: break-word; line-height: 1.15; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 0; }
    .gender-chip { width: 16px; height: 16px; border-radius: 50%; margin-bottom: 2px; display: flex; align-items: center; justify-content: center; color: white; font-size: 10px; font-weight: bold; }
    .gender-M { background: #3b82f6; }
    .gender-F { background: #ec4899; }
    .gender-O { background: #94a3b8; }
    .tag-row { margin-top: 4px; display: flex; flex-wrap: wrap; justify-content: center; gap: 4px; }
    .tag-chip { border-radius: 999px; border: 1px solid #94a3b8; padding: 2px 6px; font-size: 11px; background: #f3f4f6; font-weight: 600; display: inline-flex; align-items: center; gap: 4px; }
    .scale-info { text-align: center; font-size: 10px; color: #666; margin-bottom: 5px; }
  </style></head><body><h1>${o.name} - Seating Chart</h1>`;return v.length&&(xe+='<div class="legend"><strong>Legend:</strong> ',v.forEach(H=>{xe+=`<span class="legend-item" style="border-color:${H.color};background:${H.color}22;">${H.icon||""} ${H.name}</span>`}),xe+="</div>"),Y<1&&(xe+=`<div class="scale-info">Scaled to ${Math.round(Y*100)}% to fit page</div>`),xe+='<div class="print-container"><div class="classroom-wrapper"><div class="classroom-inner"><div class="classroom">',n.forEach((H,ge)=>{const ne=t.tables[ge],h=!ne,k=ne?ne.id:`temp-${ge}`,_=ne?ne.name:`Temporary Table ${ge+1}`,A=ne?ne.capacity:H.length||1,p=ne?{width:ne.width,height:ne.height}:{width:200,height:150},P=i[k]||p,w=(ne==null?void 0:ne.position)||{x:20+ge*220,y:20},b=l[k]||w,C=b.x-S,I=b.y-j,q=Math.max(1,Math.floor(Math.sqrt(A))),K=h?Math.max(1,Math.min(2,Math.ceil(Math.sqrt(H.length)))):q;xe+=`<div class="table${h?" temporary":""}" style="left:${C}px;top:${I}px;width:${P.width}px;height:${P.height}px;">
      <div class="table-header${h?" temporary":""}">${_}</div>
      <div class="student-area" style="grid-template-columns: repeat(${K}, 1fr);">`,H.length?H.forEach(le=>{const je=u.get(String(le));if(!je)return;const Te=(je.fullName||"").trim().split(" "),me=Te[0]||je.fullName||je.id,Pe=Te.length>1?Te[Te.length-1].charAt(0):"",Le=Pe?`${me} ${Pe}.`:me,Oe=(je.tagIds||[]).map(R=>m.get(String(R))).filter(R=>!!R).filter(R=>E?E.has(String(R.id)):!0);Oe[0];const F="",oe=(je.gender||"O").toUpperCase(),$=(je.fullName||"").trim().charAt(0)||"?",O=`gender-${oe==="M"||oe==="F"?oe:"O"}`,y=Oe.length>0?`<div class="tag-row">${Oe.map(R=>`<span class="tag-chip" style="border-color:${R.color};background:${R.color}18;">${R.icon?`${R.icon} `:""}${R.name}</span>`).join("")}</div>`:"";xe+=`<div class="student-item" style="${F}">
          <div class="gender-chip ${O}">${$}</div>
          <span>${Le}</span>
          ${y}
        </div>`}):xe+='<div class="student-item" style="color:#999;">Empty</div>',xe+="</div></div>"}),xe+="</div></div></div></div></body></html>",xe}function C0(e,t,n,r){const o=new Map;return e.forEach(l=>{l.forEach(i=>{const a=t.get(String(i));a!=null&&a.tagIds&&a.tagIds.forEach(c=>{const u=String(c);if(r&&!r.has(u))return;const m=n.get(u);m&&!o.has(u)&&o.set(u,m)})})}),Array.from(o.values())}function Ru({isOpen:e,onClose:t,layout:n,groups:r,students:o,period:l,onSave:i,onSaveDraft:a,manualMode:c=!1,constraints:u}){const[m,E]=d.useState([]),[S,j]=d.useState(null),[L,N]=d.useState(!1),[W,x]=d.useState([]),[f,v]=d.useState(null),[D,M]=d.useState(null),[G,J]=d.useState(null),[U,te]=d.useState(null),[ae,Y]=d.useState({}),[ce,$e]=d.useState({}),[xe,H]=d.useState(1),ge=pn(),ne=$=>{const O=Math.max(n.tables.length,$.length),y=[];for(let R=0;R<O;R++)y.push($[R]?[...$[R]]:[]);return y};if(d.useEffect(()=>{e&&E(ne(r))},[r,e,n.tables.length]),d.useEffect(()=>{e&&l&&($e(l.tablePositions||{}),Y(l.tableDimensions||{}))},[e,l]),!e)return null;const h=new Map(o.map($=>[String($.id),$])),k=new Set;m.forEach($=>{$.forEach(O=>k.add(String(O)))});const _=o.filter($=>!k.has(String($.id))).sort(($,O)=>{const y=($.fullName||"").toLowerCase(),R=(O.fullName||"").toLowerCase();return y.localeCompare(R)}),A=$=>m.findIndex(O=>O.some(y=>String(y)===String($))),p=d.useMemo(()=>{if(!u)return{};const $={},O=(y,R)=>{y<0||($[y]||($[y]=[]),$[y].push(R))};return u.apart.forEach(([y,R])=>{var re,ie;const z=A(y),X=A(R);if(z>=0&&z===X&&X>=0){const we=((re=h.get(String(y)))==null?void 0:re.fullName)||String(y),ee=((ie=h.get(String(R)))==null?void 0:ie.fullName)||String(R);O(z,`Must stay apart: ${we} & ${ee}`)}}),u.together.forEach(([y,R])=>{var re,ie;const z=A(y),X=A(R);if(z>=0&&X>=0&&z!==X){const we=((re=h.get(String(y)))==null?void 0:re.fullName)||String(y),ee=((ie=h.get(String(R)))==null?void 0:ie.fullName)||String(R);O(z,`Needs to sit with ${ee}`),O(X,`Needs to sit with ${we}`)}}),$},[u,m,h]),P=new Set;m.forEach($=>{$.forEach(O=>{const y=h.get(String(O));y!=null&&y.tagIds&&y.tagIds.forEach(R=>P.add(R))})});const w=Array.from(P).map($=>ge.find(O=>String(O.id)===String($))).filter($=>!!$),b=($,O)=>{v($),M(O)},C=$=>{if(f===null)return;const O=m.map(y=>[...y]);D!==null&&D>=0&&(O[D]=O[D].filter(y=>String(y)!==String(f))),O[$].some(y=>String(y)===String(f))||O[$].push(f),E(O),v(null),M(null)},I=()=>{if(f===null||D===null)return;const $=m.map(O=>[...O]);$[D]=$[D].filter(O=>String(O)!==String(f)),E($),v(null),M(null)},q=()=>{E(m.map(()=>[]))},K=()=>{var R;if(_.length===0)return;const $=_.map(z=>z.id);let O=0;const y=m.map(z=>[...z]);for(let z=0;z<y.length;z++){const X=((R=n.tables[z])==null?void 0:R.capacity)??y[z].length;for(;O<$.length&&y[z].length<X;){const re=$[O++];y[z].some(ie=>String(ie)===String(re))||y[z].push(re)}}E(y)},le=$=>{var O;return S?(O=$.tagIds)==null?void 0:O.some(y=>String(y)===String(S)):!0},je=n.tables.reduce(($,O)=>O.position?{width:Math.max($.width,O.position.x+O.width+20),height:Math.max($.height,O.position.y+O.height+20)}:$,{width:800,height:600}),Te=()=>{x(w.map($=>$.id)),N(!0)},me=$=>{te($)},Pe=$=>{if(U===null||!G)return;if(U===$){te(null);return}const O=[...G.students],[y]=O.splice(U,1);O.splice($,0,y),J({...G,students:O});const R=[...m];R[G.tableIndex]=O.map(z=>z.id),E(R),te(null)},Le=($,O,y)=>{const R=Math.max(m.length,n.tables.length);if(R===0)return null;const z=[],X=ye=>({x:20+ye*220,y:20});for(let ye=0;ye<R;ye++){const Ee=n.tables[ye],pe=Ee?Ee.id:`temp-${ye}`,se=$[pe]||(Ee?{width:Ee.width,height:Ee.height}:{width:200,height:150}),B=(Ee==null?void 0:Ee.position)||X(ye),fe=O[pe]||B;z.push({id:pe,x:fe.x,y:fe.y,width:se.width,height:se.height})}const re=z.slice().sort((ye,Ee)=>ye.id===y?-1:Ee.id===y?1:ye.x===Ee.x?ye.y-Ee.y:ye.x-Ee.x),ie=16;let we=!1,ee=!1,ze=0;do{ee=!1;for(let ye=0;ye<re.length;ye++){const Ee=re[ye];for(let pe=ye+1;pe<re.length;pe++){const se=re[pe],B=Math.min(Ee.x+Ee.width,se.x+se.width)-Math.max(Ee.x,se.x),fe=Math.min(Ee.y+Ee.height,se.y+se.height)-Math.max(Ee.y,se.y);B>0&&fe>0&&(ee=!0,we=!0,B<=fe?se.x=Ee.x+Ee.width+ie:se.y=Ee.y+Ee.height+ie)}}ze++}while(ee&&ze<6);if(!we)return null;const Ce={...O};return z.forEach(ye=>{Ce[ye.id]={x:Math.round(ye.x),y:Math.round(ye.y)}}),Ce},Oe=($,O)=>{const y={...ae,[$]:O},R=Le(y,ce,$);Y(y),oc(y),R&&($e(R),oi(R))},F=($,O,y,R)=>{const z=ae[$]||{width:R.width,height:R.height},X=z.width+O,re=z.height+y,ie=k0(X,re,R.capacity,R.rotation||0);Oe($,ie)},oe=()=>{N(!1);const $=window.open("","","width=1400,height=1000");if(!$){alert("Please allow pop-ups to print the seating chart");return}const O=bm({layout:n,groups:m,students:o,period:l,tablePositions:ce,tableDimensions:ae,tags:ge,selectedTagIds:W});$.document.write(O),$.document.close(),setTimeout(()=>{$.print()},100)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg w-full max-w-[98vw] max-h-[95vh] overflow-y-auto",children:[s.jsxs("div",{className:"sticky top-0 bg-white border-b p-4 flex flex-wrap justify-between gap-4 items-center z-10",children:[s.jsxs("h3",{className:"text-2xl font-bold text-slate-900",children:[l.name," - Seating Chart"]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[s.jsxs("div",{className:"flex items-center gap-1 bg-slate-100 rounded-lg px-2 py-1",children:[s.jsx("button",{onClick:()=>H(Math.max(.25,xe-.1)),disabled:xe<=.25,className:`px-2 py-1 rounded font-bold ${xe<=.25?"text-slate-400 cursor-not-allowed":"text-slate-700 hover:bg-slate-200"}`,title:"Zoom out",children:"-"}),s.jsxs("span",{className:"text-sm font-semibold min-w-[50px] text-center",children:[Math.round(xe*100),"%"]}),s.jsx("button",{onClick:()=>H(Math.min(2,xe+.1)),disabled:xe>=2,className:`px-2 py-1 rounded font-bold ${xe>=2?"text-slate-400 cursor-not-allowed":"text-slate-700 hover:bg-slate-200"}`,title:"Zoom in",children:"+"}),s.jsx("button",{onClick:()=>H(1),className:"px-2 py-1 text-xs font-medium text-slate-600 hover:bg-slate-200 rounded",title:"Reset zoom",children:"Reset"})]}),c&&s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("button",{onClick:K,className:"px-3 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg text-sm",children:"⚡ Auto Fill"}),s.jsx("button",{onClick:q,className:"px-3 py-2 bg-slate-500 hover:bg-slate-600 text-white rounded-lg text-sm",children:"🧹 Clear All"}),a&&s.jsx("button",{onClick:()=>a(m,ce,ae),className:"px-3 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-lg text-sm",children:"💾 Save Draft"})]}),s.jsx("button",{onClick:Te,className:"px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg flex items-center gap-2",children:"🖨️ Print"}),i&&s.jsx("button",{onClick:()=>{i(m,ce,ae),t()},className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg",children:"Save & Close"}),s.jsx("button",{onClick:t,className:"px-4 py-2 bg-slate-300 hover:bg-slate-400 rounded-lg",children:"Close"})]})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-3 p-3 bg-blue-50 rounded-lg",children:[s.jsx("p",{className:"text-sm text-blue-800",children:s.jsx("strong",{children:"💡 Interactive Mode:"})}),s.jsxs("ul",{className:"text-xs text-blue-700 mt-1 ml-4 list-disc",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"Drag table headers"})," to reposition tables in the room"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Use +W/−W/+H/−H buttons"})," to adjust table dimensions"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Drag students"})," to move them between tables or seats"]}),s.jsxs("li",{children:["Drag students to the ",s.jsx("strong",{children:"Unassigned"})," area to remove from tables"]}),s.jsxs("li",{children:["Use ",s.jsx("strong",{children:"tag filters"})," to highlight specific students"]}),s.jsxs("li",{children:["When ready, click ",s.jsx("strong",{children:"Print"})," above"]}),c&&s.jsxs(s.Fragment,{children:[s.jsxs("li",{children:["Use ",s.jsx("strong",{children:"Auto Fill"})," to quickly seat remaining students or ",s.jsx("strong",{children:"Clear All"})," to restart."]}),s.jsxs("li",{children:["Click ",s.jsx("strong",{children:"Save Draft"})," to keep your progress without closing the modal."]})]})]})]}),_.length>0&&s.jsxs("div",{className:"mb-4 p-4 bg-yellow-50 border-2 border-yellow-300 rounded-lg",onDragOver:$=>$.preventDefault(),onDrop:$=>{$.preventDefault(),I()},children:[s.jsxs("h4",{className:"font-bold text-yellow-900 mb-2",children:["📋 Unassigned Students (",_.length,")"]}),s.jsx("p",{className:"text-sm text-yellow-800 mb-3",children:"Drag these students to tables to assign them."}),s.jsx("div",{className:"flex flex-wrap gap-2",children:_.map($=>{const O=($.gender||"").toUpperCase(),y=O==="M"?"#3b82f6":O==="F"?"#ec4899":"#64748b";return s.jsxs("div",{draggable:!0,onDragStart:()=>b($.id,null),className:"px-3 py-2 bg-white border-2 border-yellow-400 rounded-lg cursor-move hover:shadow-md transition-all text-sm font-medium flex items-center gap-2",title:`Drag ${$.fullName} to a table`,children:[s.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:y}}),s.jsx("span",{children:$.fullName})]},String($.id))})})]}),w.length>0&&s.jsxs("div",{className:"mb-3 p-3 bg-indigo-50 border-2 border-indigo-200 rounded-lg",children:[s.jsx("h4",{className:"font-bold text-indigo-900 mb-2 text-sm",children:"Filter by Tag:"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{onClick:()=>j(null),className:`px-3 py-1 rounded-lg text-sm font-medium transition ${S===null?"bg-indigo-600 text-white":"bg-white border-2 border-indigo-300 text-indigo-900 hover:bg-indigo-100"}`,children:"All Students"}),w.map($=>{let O=0;m.forEach(R=>{R.forEach(z=>{var re;const X=h.get(String(z));(re=X==null?void 0:X.tagIds)!=null&&re.some(ie=>String(ie)===String($.id))&&O++})});const y=String(S)===String($.id);return s.jsxs("button",{onClick:()=>j(y?null:$.id),className:"px-3 py-1 rounded-lg text-sm font-medium transition flex items-center gap-2",style:{backgroundColor:y?$.color:"white",border:`2px solid ${$.color}`,color:y?"#fff":"#374151"},children:[$.icon&&s.jsx("span",{children:$.icon}),s.jsx("span",{children:$.name}),s.jsxs("span",{className:"text-xs opacity-70",children:["(",O,")"]})]},String($.id))})]})]}),s.jsx("div",{className:"relative border-2 border-slate-200 rounded-lg bg-slate-50 p-4 overflow-auto",style:{minHeight:`${je.height*xe+40}px`},onDragOver:$=>$.preventDefault(),onDrop:$=>{$.preventDefault();const O=$.dataTransfer.getData("tableId");if(O){const y=parseFloat($.dataTransfer.getData("startMouseX")),R=parseFloat($.dataTransfer.getData("startMouseY")),z=parseFloat($.dataTransfer.getData("startTableX")),X=parseFloat($.dataTransfer.getData("startTableY")),re=($.clientX-y)/xe,ie=($.clientY-R)/xe,we=Math.max(0,z+re),ee=Math.max(0,X+ie),ze={...ce,[O]:{x:we,y:ee}};$e(ze),oi(ze)}},children:s.jsx("div",{style:{transform:`scale(${xe})`,transformOrigin:"top left",width:`${je.width}px`,minHeight:`${je.height}px`,position:"relative"},children:m.map(($,O)=>{var Fe;const y=n.tables[O],R=!y,z=$.map(Ie=>h.get(String(Ie))).filter(Ie=>!!Ie),X=y?y.capacity:999,re=y?y.id:`temp-${O}`,ie=y?y.name:`⚠️ Temporary Table ${O+1}`,we=y?{width:y.width,height:y.height}:{width:200,height:150},ee=ae[re]||we,ze=y?vm(y.capacity,y.rotation||0):{minWidth:100,minHeight:100},Ce=ee.width<=ze.minWidth,ye=ee.height<=ze.minHeight,Ee=(y==null?void 0:y.position)||{x:20+O*220,y:20},pe=ce[re]||Ee,se={position:"absolute",left:`${pe.x}px`,top:`${pe.y}px`,width:`${ee.width}px`,minHeight:`${ee.height}px`},B=R?"border-orange-500":"border-teal-500",fe=R?"bg-orange-50":"bg-teal-50",Ae=R?"hover:border-orange-600":"hover:border-teal-600",Ke=R?"bg-orange-200":"bg-teal-200",Qe=R?"border-orange-400":"border-teal-400",Xe=R?"text-orange-900":"text-teal-900",rt=R?"text-orange-700":"text-teal-700",it=R?"bg-orange-600 hover:bg-orange-700":"bg-teal-600 hover:bg-teal-700";return s.jsxs("div",{className:`border-2 ${B} rounded-lg ${fe} ${Ae} transition-all overflow-visible`,style:se,children:[s.jsxs("div",{className:`${Ke} border-b-2 ${Qe} p-3 rounded-t-lg cursor-move`,draggable:!0,onDragStart:Ie=>{Ie.dataTransfer.setData("tableId",String(re)),Ie.dataTransfer.setData("startMouseX",String(Ie.clientX)),Ie.dataTransfer.setData("startMouseY",String(Ie.clientY)),Ie.dataTransfer.setData("startTableX",String((pe==null?void 0:pe.x)||0)),Ie.dataTransfer.setData("startTableY",String((pe==null?void 0:pe.y)||0)),Ie.dataTransfer.effectAllowed="move"},children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:`font-bold ${Xe}`,children:ie}),s.jsxs("div",{className:`text-xs ${rt}`,children:[z.length," / ",R?"∞":X," seats"]})]}),z.length>0&&s.jsx("button",{onClick:()=>{J({tableIndex:O,tableName:ie,students:z})},className:`px-2 py-1 ${it} text-white text-xs rounded`,title:"Reorder students",children:"⋮⋮"})]}),s.jsxs("div",{className:"flex gap-2 mt-2",children:[s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:()=>{if(y)F(y.id,-20,0,y);else{const Ie=Math.max(ze.minWidth,ee.width-20);Oe(re,{...ee,width:Ie})}},disabled:Ce,className:`px-1.5 py-0.5 rounded text-[10px] font-bold shadow ${Ce?"bg-slate-300 text-slate-500 cursor-not-allowed":"bg-red-500 hover:bg-red-600 text-white"}`,title:Ce?"Min width":"Decrease width",children:"-W"}),s.jsx("button",{onClick:()=>{if(y)F(y.id,20,0,y);else{const Ie=ee.width+20;Oe(re,{...ee,width:Ie})}},className:"px-1.5 py-0.5 rounded text-[10px] font-bold shadow bg-green-500 hover:bg-green-600 text-white",title:"Increase width",children:"+W"})]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:()=>{if(y)F(y.id,0,-20,y);else{const Ie=Math.max(ze.minHeight,ee.height-20);Oe(re,{...ee,height:Ie})}},disabled:ye,className:`px-1.5 py-0.5 rounded text-[10px] font-bold shadow ${ye?"bg-slate-300 text-slate-500 cursor-not-allowed":"bg-red-500 hover:bg-red-600 text-white"}`,title:ye?"Min height":"Decrease height",children:"-H"}),s.jsx("button",{onClick:()=>{if(y)F(y.id,0,20,y);else{const Ie=ee.height+20;Oe(re,{...ee,height:Ie})}},className:"px-1.5 py-0.5 rounded text-[10px] font-bold shadow bg-green-500 hover:bg-green-600 text-white",title:"Increase height",children:"+H"})]}),s.jsxs("div",{className:`text-[10px] ${rt}`,children:[ee.width,"×",ee.height,"px"]})]})]}),((Fe=p[O])==null?void 0:Fe.length)>0&&s.jsx("div",{className:"px-3 py-2",children:p[O].map((Ie,Ft)=>s.jsxs("div",{className:"mb-1 text-xs text-red-700 bg-red-50 border border-red-200 rounded px-2 py-1",children:["⚠️ ",Ie]},`${O}-warn-${Ft}`))}),s.jsxs("div",{className:"p-2 grid gap-2",style:{gridTemplateColumns:`repeat(${xm(X,ee.width,ee.height,(y==null?void 0:y.rotation)||0).cols}, minmax(0, 1fr))`},onDragOver:Ie=>{Ie.preventDefault(),Ie.currentTarget.classList.add("ring-2","ring-yellow-400")},onDragLeave:Ie=>{Ie.currentTarget.classList.remove("ring-2","ring-yellow-400")},onDrop:Ie=>{Ie.preventDefault(),Ie.currentTarget.classList.remove("ring-2","ring-yellow-400"),C(O)},children:[z.map(Ie=>{var $t;const Ft=le(Ie),vt=($t=Ie.tagIds)==null?void 0:$t.map(Re=>ge.find(vn=>String(vn.id)===String(Re))).filter(Re=>!!Re),qe=Ie.fullName||String(Ie.id),Pt=(qe.trim().charAt(0)||"?").toUpperCase(),Ts=(Ie.gender||"").toUpperCase(),xn=Ts==="M"?"bg-blue-500":Ts==="F"?"bg-pink-500":"bg-slate-400",an=vt&&vt.length>0?s.jsx("div",{className:"mt-1 flex flex-wrap justify-center gap-1",children:vt.map(Re=>s.jsx("span",{className:"flex h-4 w-4 items-center justify-center rounded-full text-[10px] font-semibold text-white shadow-sm",style:{backgroundColor:Re.color,border:`1px solid ${Re.color}`},title:`${Re.icon||""} ${Re.name}`,children:Re.icon||"•"},String(Re.id)))}):null,Ze=vt&&vt.length>0?vt.map(Re=>`${Re.icon||""} ${Re.name}`).join(", "):qe;return s.jsxs("div",{draggable:!0,onDragStart:()=>b(Ie.id,O),className:`flex min-h-[74px] cursor-move flex-col items-center justify-center rounded-xl border border-slate-200 bg-white px-1.5 py-1.5 text-center text-[11px] font-medium text-slate-700 shadow-sm transition hover:shadow-md ${Ft?"":"opacity-45"}`,title:Ze,children:[s.jsx("div",{className:`mb-1 flex h-5 w-5 items-center justify-center rounded-full text-[10px] font-bold text-white ${xn}`,children:Pt}),s.jsx("span",{className:"block w-full break-words text-[11px] font-semibold leading-tight",children:qe}),an]},String(Ie.id))}),z.length===0&&s.jsx("div",{className:"col-span-2 text-sm text-slate-400 text-center py-4",children:"Drag students here"})]})]},String(re))})})})]})]})}),L&&s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h4",{className:"text-xl font-bold mb-3",children:"Print Options"}),s.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Choose which student tags to include in the printed seating chart. Unchecked tags will not be visible."}),w.length>0?s.jsx("div",{className:"space-y-2 mb-4",children:w.map($=>s.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-slate-50",children:[s.jsx("input",{type:"checkbox",checked:W.some(O=>String(O)===String($.id)),onChange:O=>{O.target.checked?x([...W,$.id]):x(W.filter(y=>String(y)!==String($.id)))},className:"w-4 h-4"}),s.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 rounded",style:{backgroundColor:$.color+"22",border:`1px solid ${$.color}`},children:[$.icon&&s.jsx("span",{children:$.icon}),s.jsx("span",{className:"text-sm font-medium",children:$.name})]})]},String($.id)))}):s.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"No tags are currently used by students in this seating chart."}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 border rounded-lg hover:bg-slate-50",children:"Cancel"}),s.jsx("button",{onClick:oe,className:"px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg",children:"Print"})]})]})}),G&&s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[70]",onClick:()=>J(null),children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",onClick:$=>$.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-bold",children:["Reorder Students at ",G.tableName]}),s.jsx("button",{onClick:()=>J(null),className:"text-slate-500 hover:text-slate-700",children:"✕"})]}),s.jsx("p",{className:"text-sm text-slate-600 mb-3",children:"Drag students to reorder their seating positions"}),s.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border-2 border-blue-200 rounded-lg",children:[s.jsx("p",{className:"text-xs font-semibold text-blue-900 mb-2",children:"Seat Layout:"}),s.jsx("div",{className:"grid grid-cols-2 gap-2 max-w-[200px] mx-auto",children:G.students.map(($,O)=>s.jsx("div",{className:"bg-white border-2 border-blue-300 rounded p-2 text-center",children:s.jsxs("div",{className:"text-xs font-bold text-blue-700",children:["#",O+1]})},O))})]}),s.jsx("div",{className:"space-y-2",children:G.students.map(($,O)=>{const y=$.fullName||String($.id),R=(y.trim().charAt(0)||"?").toUpperCase(),z=($.gender||"").toUpperCase(),X=z==="M"?"bg-blue-500":z==="F"?"bg-pink-500":"bg-slate-400";return s.jsxs("div",{draggable:!0,onDragStart:()=>me(O),onDragOver:re=>re.preventDefault(),onDrop:()=>Pe(O),className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg border-2 border-slate-200 hover:border-teal-400 cursor-move transition",children:[s.jsx("span",{className:"text-slate-400 font-bold text-sm",children:O+1}),s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-bold ${X}`,children:R}),s.jsx("span",{className:"flex-1 font-medium",children:y}),s.jsx("span",{className:"text-slate-400 text-xs",children:"⋮⋮"})]},String($.id))})}),s.jsx("button",{onClick:()=>J(null),className:"mt-4 w-full px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg font-semibold",children:"Done"})]})})]})}function E0(){const[e,t]=d.useState(""),[n,r]=d.useState(null),[o,l]=d.useState(0),[i,a]=d.useState(!1),[c,u]=d.useState(0),[m,E]=d.useState(!1),[S,j]=d.useState(null),[L,N]=d.useState(null),[W,x]=d.useState(null),[f,v]=d.useState(!1),D=et(),M=D.currentId,G=d.useMemo(()=>mt().filter(F=>(F.periodIds||[]).some(oe=>String(oe)===String(M))),[M]),J=Fr(M),U=$s(),te=D.periods.find(F=>String(F.id)===String(M)),ae=(te==null?void 0:te.layoutId)??null,Y=U.find(F=>String(F.id)===String(ae)),[ce,$e]=d.useState("size"),[xe,H]=d.useState(2),[ge,ne]=d.useState(10),[h,k]=d.useState(!0),[_,A]=d.useState(!1),[p,P]=d.useState(!1),[w,b]=d.useState(null);d.useEffect(()=>{t("Legacy grouping engine ready.")},[]),d.useEffect(()=>{te!=null&&te.activeGrouping?(r({layoutId:ae,groups:te.activeGrouping}),b(te.activeGrouping.map(F=>F.slice()))):(r(null),b(null))},[M,c,ae]);const C=()=>{try{if(ce==="tables"&&!Y){t("Select a table layout first.");return}const F=y0({createGroupsImpl:S0,groupingMode:ce==="manual"?"tables":ce,groupSize:ce==="size"?Math.max(1,Math.floor(xe||0)):void 0,numberOfGroups:ce==="count"?Math.max(1,Math.floor(ge||0)):void 0,balanceByGender:h,randomizeMode:_?"ignore":"default",autoApproveUnequalGroups:!1,showWarnings:!0});let oe=F.groups||[];if(ce==="tables"&&Y&&(F!=null&&F.groups)&&F.groups.length>0&&h&&!_){const O=[];if(F.groups.forEach((y,R)=>{const z=Y.tables[R],X=(z==null?void 0:z.capacity)??y.length;y.length>X&&O.push({index:R,capacity:X,overflow:y.slice(X)})}),O.length>0&&window.confirm(`One or more tables need an extra student to satisfy gender balancing.

Click OK to split the extra students into temporary solo groups.
Click Cancel to allow tables with three students instead.`)){const R=F.groups.map((z,X)=>{const re=O.find(ie=>ie.index===X);return re?z.slice(0,re.capacity):z});O.forEach(z=>{z.overflow.forEach(X=>{R.push([X])})}),oe=R}}const $={...F,groups:oe};r($),t(`Generated ${(oe==null?void 0:oe.length)||0} group(s).`)}catch{t("Legacy algorithm not loaded. Ensure new-ui-vite/public/GroupingAlgorithm.js exists (or vendor the file to src/core/legacy) and refresh.")}},I=d.useMemo(()=>{if(!(n!=null&&n.groups))return[];if(ce!=="tables"||!Y)return n.groups;const F=Y.tables.length,oe=[],$=Math.max(F,n.groups.length);for(let O=0;O<$;O++)oe.push(n.groups[O]||[]);return oe},[n,ce,Y]),q=ce==="tables"&&Y?I:(n==null?void 0:n.groups)||[],K=()=>{if(!Y)return;const F={};return Y.tables.forEach((oe,$)=>{F[String($)]=String(oe.id)}),F},le=d.useMemo(()=>{if(!Y)return[];const F=w||(te==null?void 0:te.activeGrouping)||(n==null?void 0:n.groups)||[],oe=Math.max(Y.tables.length,F.length),$=[];for(let O=0;O<oe;O++)$.push(F[O]?[...F[O]]:[]);return $},[w,Y,te==null?void 0:te.activeGrouping,n]),je=(F,oe)=>{j(F),N(oe)},Te=(F,oe)=>{F.preventDefault(),x(oe)},me=()=>{x(null)},Pe=(F,oe)=>{var R;if(F.preventDefault(),x(null),S===null||L===null||L===oe||!(n!=null&&n.groups))return;const $=n.groups.map(z=>[...z]);for(;$.length<=oe;)$.push([]);const O=$[L],y=O.findIndex(z=>String(z)===String(S));y!==-1&&O.splice(y,1),$[oe].push(S),r({...n,groups:$}),j(null),N(null),t(`Moved student to ${ce==="tables"&&Y?((R=Y.tables[oe])==null?void 0:R.name)||`Table ${oe+1}`:`Group ${oe+1}`}`)},Le=(F,oe,$,O=!0)=>{ra(F),oi(oe),oc($);const y=K();y&&sa(y),b(F),r({layoutId:ae,groups:F}),t(O?"Manual grouping saved.":"Manual draft saved."),u(R=>R+1),O&&P(!1)},Oe=ce==="tables"||ce==="manual";return s.jsxs("div",{className:"p-6 space-y-4 bg-slate-50 min-h-screen",children:[s.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold mb-3",children:"Select Class Period"}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[(D.periods||[]).map(F=>{const oe=String(F.id)===String(M),$=mt().filter(O=>(O.periodIds||[]).some(y=>String(y)===String(F.id))).length;return s.jsxs("button",{className:(oe?"bg-violet-600 text-white":"bg-white border-2 border-slate-300 text-slate-800 hover:bg-slate-50")+" px-4 py-2 rounded-lg text-sm font-medium transition-colors",onClick:()=>{Ut(F.id),u(O=>O+1)},children:[F.name," (",$," students)"]},String(F.id))}),(D.periods||[]).length===0&&s.jsx("div",{className:"text-sm text-slate-500",children:"No periods yet. Add periods on the Room Setup tab."})]}),G.length===0&&M&&s.jsx("div",{className:"mt-3 text-sm text-orange-600",children:"⚠️ No students in this period. Add students in the Students tab."}),i&&s.jsx("div",{className:"text-xs text-slate-500 mt-2",children:"Loading legacy engine…"})]}),s.jsxs("div",{className:"bg-white border rounded-lg p-4 space-y-4",children:[s.jsx("h4",{className:"font-semibold",children:"Group Configuration"}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[s.jsxs("label",{className:"inline-flex items-center gap-2 border-2 border-slate-300 rounded-lg px-4 py-3 cursor-pointer hover:bg-slate-50",children:[s.jsx("input",{type:"radio",name:"mode",checked:ce==="size",onChange:()=>$e("size"),className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Group Size:"}),s.jsx("input",{type:"number",min:1,className:"w-16 border border-slate-300 rounded px-2 py-1 text-center text-sm",value:xe,onChange:F=>H(Math.max(1,Math.floor(parseInt(F.target.value||"0",10)))),onClick:F=>F.stopPropagation()}),s.jsx("span",{className:"text-sm text-slate-600",children:"students per group"})]}),s.jsxs("label",{className:"inline-flex items-center gap-2 border-2 border-slate-300 rounded-lg px-4 py-3 cursor-pointer hover:bg-slate-50",children:[s.jsx("input",{type:"radio",name:"mode",checked:ce==="count",onChange:()=>$e("count"),className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Number of Groups:"}),s.jsx("input",{type:"number",min:1,className:"w-16 border border-slate-300 rounded px-2 py-1 text-center text-sm",value:ge,onChange:F=>ne(Math.max(1,Math.floor(parseInt(F.target.value||"0",10)))),onClick:F=>F.stopPropagation()}),s.jsx("span",{className:"text-sm text-slate-600",children:"total groups"})]}),s.jsxs("label",{className:"inline-flex items-center gap-2 border-2 border-slate-300 rounded-lg px-4 py-3 cursor-pointer hover:bg-slate-50",children:[s.jsx("input",{type:"radio",name:"mode",checked:ce==="tables",onChange:()=>$e("tables"),className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Use Table Layout"})]}),s.jsxs("label",{className:"inline-flex items-center gap-2 border-2 border-slate-300 rounded-lg px-4 py-3 cursor-pointer hover:bg-slate-50",children:[s.jsx("input",{type:"radio",name:"mode",checked:ce==="manual",onChange:()=>$e("manual"),className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Manual"})]})]}),s.jsxs("div",{className:"rounded-lg p-4 border-2 transition "+(Oe?"bg-cyan-50 border-cyan-400":"bg-slate-100 border-slate-200 opacity-60"),children:[s.jsxs("h4",{className:"font-semibold mb-3 flex items-center justify-between",children:[s.jsx("span",{children:"Active Table Layout"}),!Oe&&s.jsx("span",{className:"text-xs text-slate-500",children:'Select "Use Table Layout" or "Manual" to sync tables with this layout.'})]}),s.jsxs("select",{className:"w-full border border-slate-300 rounded px-3 py-2 bg-white text-sm",value:ae??"",onChange:F=>{const oe=F.target.value;Ax(oe===""?null:oe),u(O=>O+1)},children:[s.jsx("option",{value:"",children:"Select Layout..."}),U.map(F=>s.jsxs("option",{value:String(F.id),children:[F.name," (",F.tables.length," tables, ",F.tables.reduce((oe,$)=>oe+($.capacity||0),0)," seats)"]},String(F.id)))]}),Y&&Oe&&s.jsxs("div",{className:"mt-2 text-sm text-slate-700",children:["✓ Using ",s.jsx("span",{className:"font-semibold",children:Y.name})," with ",Y.tables.length," tables"]}),!Y&&U.length===0&&s.jsx("div",{className:"mt-2 text-sm text-orange-700",children:"⚠️ No layouts available. Create a layout on the Room Setup tab first."})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("label",{className:"flex items-center gap-3 text-sm cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:h,onChange:F=>k(F.target.checked),className:"w-5 h-5"}),s.jsx("span",{className:"text-lg",children:"⚖️"}),s.jsx("span",{className:"font-medium",children:"Balance by Gender"}),s.jsx("span",{className:"text-slate-600",children:"(keeps students with same gender together when possible)"})]})}),s.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:s.jsxs("label",{className:"flex items-center gap-3 text-sm cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:_,onChange:F=>A(F.target.checked),className:"w-5 h-5"}),s.jsx("span",{className:"text-lg",children:"🔀"}),s.jsx("span",{className:"font-medium",children:"Randomize Groups"}),s.jsx("span",{className:"text-slate-600",children:"(ignore all preferences and history)"})]})}),ce==="manual"?s.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[s.jsx("button",{className:"px-6 py-3 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white font-semibold text-lg shadow-lg transition-colors disabled:opacity-50",disabled:!Y,onClick:()=>{Y&&P(!0)},children:"✍️ Open Manual Planner"}),!Y&&s.jsx("div",{className:"text-sm text-orange-700",children:"Select a table layout first."})]}):s.jsx("div",{className:"flex items-center justify-center",children:s.jsx("button",{className:"px-6 py-3 rounded-lg bg-indigo-600 hover:bg-indigo-700 text-white font-semibold text-lg shadow-lg transition-colors",onClick:C,children:"▶ Generate Groups"})}),e&&e!=="Legacy grouping engine ready."&&s.jsx("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded text-sm text-blue-900",children:e})]}),G.length===0&&s.jsxs("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-lg p-8 text-center",children:[s.jsx("div",{className:"text-6xl mb-4",children:"👥"}),s.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"No Students Added Yet"}),s.jsx("p",{className:"text-slate-600",children:"Go to the Students tab to add students before generating groups"})]}),n&&n.groups&&s.jsxs("div",{className:"mt-3 border-2 border-emerald-500 rounded-lg bg-emerald-50 p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsx("h4",{className:"text-lg font-bold text-emerald-900",children:"✨ Grouping Results"}),s.jsxs("div",{className:"flex gap-2",children:[Y&&(n==null?void 0:n.groups)&&s.jsx("button",{className:"px-4 py-2 rounded bg-teal-600 hover:bg-teal-700 text-white flex items-center gap-2",onClick:()=>E(!0),children:"👥 View Seating Chart"}),s.jsx("button",{className:"px-4 py-2 rounded bg-emerald-600 hover:bg-emerald-700 text-white disabled:opacity-50",disabled:f,onClick:()=>{if(f)return;v(!0);const F=Gn(M);for(let $=0;$<n.groups.length;$++){const O=n.groups[$];if(O.length===1){const y=String(O[0]);F.solos[y]=(F.solos[y]||0)+1}else if(O.length>=2)for(let y=0;y<O.length;y++)for(let R=y+1;R<O.length;R++){const z=[String(O[y]),String(O[R])].sort().join("|");F.work[z]=(F.work[z]||0)+1;const X=G.find(ie=>String(ie.id)===String(O[y])),re=G.find(ie=>String(ie.id)===String(O[R]));if(X){if((X.strongPreferences||[]).includes(O[R])){const ie=String(O[y]);F.gotChoice[ie]=(F.gotChoice[ie]||0)+2}else if((X.preferences||[]).includes(O[R])){const ie=String(O[y]);F.gotChoice[ie]=(F.gotChoice[ie]||0)+1}}if(re){if((re.strongPreferences||[]).includes(O[y])){const ie=String(O[R]);F.gotChoice[ie]=(F.gotChoice[ie]||0)+2}else if((re.preferences||[]).includes(O[y])){const ie=String(O[R]);F.gotChoice[ie]=(F.gotChoice[ie]||0)+1}}}}qs(M,F);let oe;Y&&ce==="tables"&&(oe={},n.groups.forEach(($,O)=>{const y=Y.tables[O];y&&(oe[String(O)]=String(y.id))})),Mu(M,{layoutId:ae,groups:n.groups,tableAssignments:oe}),l($=>$+1),t("Grouping saved and history updated!"),setTimeout(()=>v(!1),500)},children:"💾 Save Grouping"})]})]}),(()=>{const F=new Set;n.groups.forEach($=>$.forEach(O=>F.add(String(O))));const oe=G.filter($=>!F.has(String($.id)));return oe.length>0?s.jsxs("div",{className:"mb-3 p-3 bg-yellow-50 border-2 border-yellow-300 rounded",children:[s.jsxs("p",{className:"text-sm font-semibold text-yellow-900 mb-1",children:["⚠️ Unassigned Students (",oe.length,")"]}),s.jsx("p",{className:"text-xs text-yellow-800 mb-2",children:ce==="tables"?"Use the Seating Chart to assign them to tables.":"These students are not in any group yet."}),s.jsx("div",{className:"flex flex-wrap gap-2",children:oe.map($=>s.jsx("span",{className:"px-2 py-1 bg-white border border-yellow-400 rounded text-xs",children:$.fullName},String($.id)))})]}):null})(),s.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-3",children:ce==="tables"&&Y?q.map((F,oe)=>{const $=Y.tables[oe],O=pn(),y=W===oe,R=!$;return s.jsxs("div",{className:`border-2 rounded-lg bg-white transition-all ${y?"border-yellow-500 bg-yellow-50 border-4":R?"border-orange-400 bg-orange-50":"border-slate-300"}`,onDragOver:z=>Te(z,oe),onDragLeave:me,onDrop:z=>Pe(z,oe),children:[s.jsxs("div",{className:`border-b-2 px-3 py-2 rounded-t-lg ${R?"bg-orange-100 border-orange-300":"bg-slate-100 border-slate-300"}`,children:[s.jsx("div",{className:"font-bold text-slate-900",children:$?$.name:`⚠️ Temporary Table ${oe+1}`}),s.jsxs("div",{className:"text-xs text-slate-600",children:[F.length," / ",$?$.capacity:"∞"," student",F.length!==1?"s":""]})]}),s.jsxs("div",{className:"p-3 space-y-2",children:[F.map(z=>{const X=G.find(Ce=>String(Ce.id)===String(z));if(!X)return null;const re=X.fullName||String(z),ie=(re.trim().charAt(0)||"?").toUpperCase(),we=(X.gender||"").toUpperCase(),ee=we==="M"?"bg-blue-500":we==="F"?"bg-pink-500":"bg-slate-400",ze=(X.tagIds||[]).map(Ce=>O.find(ye=>String(ye.id)===String(Ce))).filter(Ce=>!!Ce);return s.jsxs("div",{draggable:!0,onDragStart:()=>je(z,oe),className:"flex items-start gap-2 p-2 bg-slate-50 rounded border border-slate-200 cursor-move hover:shadow-md transition-all",children:[s.jsx("span",{className:`w-6 h-6 ${ee} text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5`,children:ie}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"text-sm font-medium text-slate-900",children:re}),ze.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:ze.map(Ce=>s.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{backgroundColor:Ce.color+"33",border:`1px solid ${Ce.color}`,color:"#374151"},children:[Ce.icon&&s.jsxs("span",{children:[Ce.icon," "]}),Ce.name]},String(Ce.id)))})]})]},String(z))}),F.length===0&&s.jsx("div",{className:"text-sm text-slate-400 text-center py-4",children:"Empty table"})]})]},$?String($.id):`extra-${oe}`)}):q.map((F,oe)=>{const $=pn(),O=W===oe;return s.jsxs("div",{className:`border-2 rounded-lg bg-white transition-all ${O?"border-yellow-500 bg-yellow-50 border-4":"border-slate-300"}`,onDragOver:y=>Te(y,oe),onDragLeave:me,onDrop:y=>Pe(y,oe),children:[s.jsxs("div",{className:"bg-slate-100 border-b-2 border-slate-300 px-3 py-2 rounded-t-lg",children:[s.jsxs("div",{className:"font-bold text-slate-900",children:["Group ",oe+1]}),s.jsxs("div",{className:"text-xs text-slate-600",children:[F.length," student",F.length!==1?"s":""]})]}),s.jsxs("div",{className:"p-3 space-y-2",children:[F.map(y=>{const R=G.find(ee=>String(ee.id)===String(y));if(!R)return null;const z=R.fullName||String(y),X=(z.trim().charAt(0)||"?").toUpperCase(),re=(R.gender||"").toUpperCase(),ie=re==="M"?"bg-blue-500":re==="F"?"bg-pink-500":"bg-slate-400",we=(R.tagIds||[]).map(ee=>$.find(ze=>String(ze.id)===String(ee))).filter(ee=>!!ee);return s.jsxs("div",{draggable:!0,onDragStart:()=>je(y,oe),className:"flex items-start gap-2 p-2 bg-slate-50 rounded border border-slate-200 cursor-move hover:shadow-md transition-all",children:[s.jsx("span",{className:`w-6 h-6 ${ie} text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5`,children:X}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"text-sm font-medium text-slate-900",children:z}),we.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:we.map(ee=>s.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{backgroundColor:ee.color+"33",border:`1px solid ${ee.color}`,color:"#374151"},children:[ee.icon&&s.jsxs("span",{children:[ee.icon," "]}),ee.name]},String(ee.id)))})]})]},String(y))}),F.length===0&&s.jsx("div",{className:"text-sm text-slate-400 text-center py-4",children:"Empty group"})]})]},oe)})})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h4",{className:"font-semibold mb-1",children:"Saved Groupings"}),s.jsxs("div",{className:"space-y-2",children:[ii(M).map(F=>s.jsxs("div",{className:"border rounded p-2 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm",children:[F.name||"Grouping"," • ",new Date(F.savedAt).toLocaleString()," • ",F.groups.length," groups"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{className:"px-2 py-1 text-indigo-600 border border-indigo-600 rounded hover:bg-indigo-50",onClick:()=>{r({layoutId:ae,groups:F.groups}),ra(F.groups),F.tablePositions&&oi(F.tablePositions),F.tableDimensions&&oc(F.tableDimensions);const oe=F.tableAssignments||K();oe&&sa(oe),u($=>$+1),t("Grouping loaded!")},children:"Load"}),s.jsx("button",{className:"px-2 py-1 text-rose-600 border rounded",onClick:()=>{hm(M,F.id),l(oe=>oe+1)},children:"Delete"})]})]},F.id)),ii(M).length===0&&s.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-6 text-center",children:[s.jsx("div",{className:"text-4xl mb-3",children:"📁"}),s.jsx("p",{className:"text-slate-600 font-medium",children:"No Saved Groupings Yet"}),s.jsx("p",{className:"text-sm text-slate-500 mt-1",children:'Generate groups and click "Save Grouping" to save them here'})]})]})]}),m&&Y&&n&&n.groups&&te&&s.jsx(Ru,{isOpen:m,onClose:()=>E(!1),layout:Y,groups:I,students:G,period:te,onSave:(F,oe,$)=>{r({...n,groups:F}),ra(F);const O=K();O&&sa(O),Mu(M,{layoutId:ae,groups:F,tablePositions:oe,tableDimensions:$,tableAssignments:O}),l(y=>y+1),u(y=>y+1),t("Seating chart saved!")}}),p&&Y&&te&&s.jsx(Ru,{isOpen:p,onClose:()=>P(!1),layout:Y,groups:le,students:G,period:te,manualMode:!0,constraints:J,onSave:(F,oe,$)=>Le(F,oe,$,!0),onSaveDraft:(F,oe,$)=>Le(F,oe,$,!1)})]})}function I0(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${r}`}function _u(){return I0(new Date)}function Ct(e){const t=e.split("-");return t.length!==3?e:`${t[1]}-${t[2]}-${t[0]}`}function ym(e,t){const n=et(),r=n.periods.findIndex(l=>String(l.id)===String(e));if(r<0)return;const o=n.periods.slice();o[r]=t({...o[r]}),localStorage.setItem("newui_periods_state",JSON.stringify({periods:o,currentId:n.currentId}))}function wo(e,t,n,r){ym(e,o=>{const l={...o.attendance};return r==="unmarked"?l[n]&&(delete l[n][String(t)],Object.keys(l[n]).length===0&&delete l[n]):(l[n]||(l[n]={}),l[n][String(t)]=r),{...o,attendance:l}})}function Vo(e,t){return!e||!e.attendance?{}:e.attendance[t]||{}}function P0(e,t){if(!e||!e.attendance)return[];const n=[];for(const r in e.attendance){const o=e.attendance[r][String(t)];o&&n.push({date:r,status:o})}return n.sort((r,o)=>o.date.localeCompare(r.date))}function $0(e,t){if(!e)return{total:0,present:0,absent:0,tardy:0,leftEarly:0,presentPercentage:0,progressPercentage:0};const n=li(String(e.id)),r=n.length,o=Vo(e,t);let l=0,i=0,a=0,c=0;n.forEach(S=>{switch(o[String(S.id)]||"unmarked"){case"present":l++;break;case"absent":i++;break;case"tardy":a++;break;case"left_early":c++;break}});const u=r>0?Math.round(l/r*100):0,m=l+i+a+c,E=r>0?Math.round(m/r*100):0;return{total:r,present:l,absent:i,tardy:a,leftEarly:c,presentPercentage:u,progressPercentage:E}}function T0(e,t){const r=et().periods.find(i=>String(i.id)===String(e));if(!r)return;const o=li(String(e)),l=Vo(r,t);o.forEach(i=>{(l[String(i.id)]||"unmarked")==="unmarked"&&wo(e,i.id,t,"present")})}function D0(e,t){ym(e,n=>{const r={...n.attendance};return r[t]&&delete r[t],{...n,attendance:r}})}function M0(e,t,n){const o=et().periods.find(i=>String(i.id)===String(e));if(!o)return;const l=Vo(o,t);n.forEach(i=>{(l[String(i)]||"unmarked")==="unmarked"&&wo(e,i,t,"present")})}function la(e){switch(e){case"present":return"✓";case"absent":return"✗";case"tardy":return"⏰";case"left_early":return"⏪";case"unmarked":default:return"⬜"}}function ia(e){switch(e){case"present":return"bg-green-200";case"absent":return"bg-red-200";case"tardy":return"bg-yellow-200";case"left_early":return"bg-orange-200";case"unmarked":default:return"bg-gray-200"}}function wm(e,t){const n=et(),r=n.periods.findIndex(l=>String(l.id)===String(e));if(r<0)return;const o=n.periods.slice();o[r]=t({...o[r]}),localStorage.setItem("newui_periods_state",JSON.stringify({periods:o,currentId:n.currentId}))}function R0(e,t,n,r){wm(e,o=>{const l={...o.behaviorNotes};return!r||r.trim()===""?l[n]&&(delete l[n][String(t)],Object.keys(l[n]).length===0&&delete l[n]):(l[n]||(l[n]={}),l[n][String(t)]={note:r.trim(),timestamp:new Date().toISOString()}),{...o,behaviorNotes:l}})}function Sm(e,t,n){return!e||!e.behaviorNotes||!e.behaviorNotes[n]?null:e.behaviorNotes[n][String(t)]||null}function ao(e,t){return!e||!e.behaviorNotes?{}:e.behaviorNotes[t]||{}}function Nm(e,t,n,r){if(!e||!e.behaviorNotes)return[];const o=[];for(const l in e.behaviorNotes){if(n&&l<n||r&&l>r)continue;const i=e.behaviorNotes[l][String(t)];i&&o.push({date:l,note:i.note,timestamp:i.timestamp})}return o.sort((l,i)=>i.date.localeCompare(l.date))}function jm(e,t,n,r,o){n!==0&&wm(e,l=>{if(!l.pointsEnabled)return l;const i={...l.pointsByStudent||{}},a=[...l.pointsHistory||[]],c=l.startingPoints??50,u=i[String(t)]??c,m=Math.max(0,u+n);return i[String(t)]=m,a.push({studentId:t,delta:n,reason:r||"No reason provided",date:o}),{...l,pointsByStudent:i,pointsHistory:a}})}function Ko(e,t){if(!e||!e.pointsEnabled)return 0;const n=e.startingPoints??50;return(e.pointsByStudent||{})[String(t)]??n}function Yo(e,t,n,r){if(!e||!e.pointsHistory)return[];let o=e.pointsHistory.filter(l=>String(l.studentId)===String(t));return(n||r)&&(o=o.filter(l=>{const i=l.date.substring(0,10);return!(n&&i<n||r&&i>r)})),o.sort((l,i)=>new Date(i.date).getTime()-new Date(l.date).getTime())}function Qs(e){return e>=45?{label:"Good Standing",color:"green",emoji:"🟢",min:45}:e>=35?{label:"Caution",color:"yellow",emoji:"🟡",min:35,max:44}:e>=25?{label:"Warning",color:"orange",emoji:"🟠",min:25,max:34}:{label:"Alert",color:"red",emoji:"🔴",min:0,max:24}}function _0(e,t,n,r,o){n!==0&&t.forEach(l=>{jm(e,l,n,r,o)})}function ai(e){switch(e.color){case"green":return"bg-green-100 text-green-800 border-green-300";case"yellow":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"orange":return"bg-orange-100 text-orange-800 border-orange-300";case"red":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}}function A0({student:e,period:t,date:n,onClose:r,onSave:o}){const[l,i]=d.useState(""),[a,c]=d.useState(0),[u,m]=d.useState(""),E=d.useRef(null);d.useEffect(()=>{const f=Sm(t,e.id,n);f&&i(f.note),requestAnimationFrame(()=>{var v,D;(v=E.current)==null||v.focus(),(D=E.current)==null||D.setSelectionRange(l.length,l.length)})},[t,e.id,n]);const S=Ko(t,e.id),j=Qs(S),L=Math.max(0,S+a),N=Qs(L),W=()=>{if(a!==0&&!u.trim()){alert("Please provide a reason for the point change.");return}R0(t.id,e.id,n,l),a!==0&&jm(t.id,e.id,a,u,n),localStorage.setItem("newui_drive_dirty_reason",`note:${e.id}:${n}`),window.dispatchEvent(new CustomEvent("newui_drive_force_push",{detail:"note"})),o(),r()},x=f=>{i(v=>v?v+" "+f:f)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 z-30",onClick:r}),s.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"bg-gradient-to-r from-violet-600 to-indigo-600 text-white px-6 py-4 rounded-t-lg",children:[s.jsx("h2",{className:"text-xl font-bold",children:"📝 Behavior Notes"}),s.jsxs("p",{className:"text-sm text-violet-100",children:[e.fullName," - ",n]})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Behavior Note"}),s.jsxs("span",{className:"text-xs text-slate-500",children:[l.length," characters"]})]}),s.jsx("textarea",{value:l,onChange:f=>i(f.target.value),className:"w-full border-2 border-slate-300 rounded-lg px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none",rows:5,placeholder:"Enter behavior notes for this student...",ref:E,onMouseDown:f=>f.stopPropagation(),onClick:f=>f.stopPropagation()}),s.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[s.jsx("button",{onClick:()=>x("✅ Excellent participation and effort today."),className:"text-xs px-3 py-1 rounded-lg bg-green-100 hover:bg-green-200 text-green-800 border border-green-300",children:"✅ Positive"}),s.jsx("button",{onClick:()=>x("⚠️ Some behavioral concerns noted."),className:"text-xs px-3 py-1 rounded-lg bg-yellow-100 hover:bg-yellow-200 text-yellow-800 border border-yellow-300",children:"⚠️ Concern"}),s.jsx("button",{onClick:()=>x("🎯 Academic progress observed."),className:"text-xs px-3 py-1 rounded-lg bg-blue-100 hover:bg-blue-200 text-blue-800 border border-blue-300",children:"🎯 Academic"}),s.jsx("button",{onClick:()=>x("👥 Good social interactions with peers."),className:"text-xs px-3 py-1 rounded-lg bg-purple-100 hover:bg-purple-200 text-purple-800 border border-purple-300",children:"👥 Social"})]})]}),t.pointsEnabled&&s.jsxs("div",{className:"border-2 border-yellow-300 rounded-lg p-4 bg-yellow-50",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h3",{className:"font-semibold text-yellow-900 flex items-center gap-2",children:[s.jsx("span",{children:"🏆"})," Behavior Points Adjustment"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:`px-2 py-1 rounded font-bold text-sm ${ai(j)}`,children:[j.emoji," ",S]}),a!==0&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-slate-500",children:"→"}),s.jsx("span",{className:`px-2 py-1 rounded font-bold text-sm ${ai(N)}`,children:L})]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Point Change:"}),s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("button",{onClick:()=>c(2),className:`px-4 py-2 rounded border font-bold ${a===2?"bg-green-600 text-white border-green-600":"bg-white text-slate-700 border-slate-300 hover:bg-green-50"}`,children:"+2"}),s.jsx("button",{onClick:()=>c(1),className:`px-4 py-2 rounded border font-bold ${a===1?"bg-green-500 text-white border-green-500":"bg-white text-slate-700 border-slate-300 hover:bg-green-50"}`,children:"+1"}),s.jsx("button",{onClick:()=>c(0),className:`px-4 py-2 rounded border font-bold ${a===0?"bg-slate-600 text-white border-slate-600":"bg-white text-slate-700 border-slate-300 hover:bg-slate-50"}`,children:"0"}),s.jsx("button",{onClick:()=>c(-1),className:`px-4 py-2 rounded border font-bold ${a===-1?"bg-yellow-500 text-white border-yellow-500":"bg-white text-slate-700 border-slate-300 hover:bg-yellow-50"}`,children:"-1"}),s.jsx("button",{onClick:()=>c(-2),className:`px-4 py-2 rounded border font-bold ${a===-2?"bg-orange-500 text-white border-orange-500":"bg-white text-slate-700 border-slate-300 hover:bg-orange-50"}`,children:"-2"}),s.jsx("button",{onClick:()=>{const f=prompt("Enter custom point change:",String(a));f!==null&&c(parseInt(f)||0)},className:"px-4 py-2 rounded border bg-white text-slate-700 border-slate-300 hover:bg-slate-50 font-medium",children:"Custom"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Reason",a!==0&&s.jsx("span",{className:"text-red-500",children:"*"}),":"]}),s.jsx("input",{type:"text",value:u,onChange:f=>m(f.target.value),className:`w-full border-2 rounded-lg px-3 py-2 text-sm focus:outline-none ${a!==0&&!u.trim()?"border-red-300 focus:border-red-500":"border-slate-300 focus:border-indigo-500"}`,placeholder:"e.g., Helped classmate, Disrupted class, Excellent participation"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Quick Templates"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsx("button",{onClick:()=>{c(1),m("Positive Behavior")},className:"px-3 py-2 rounded bg-green-100 hover:bg-green-200 text-green-800 border border-green-300 text-sm font-medium flex items-center gap-2",children:"✅ Positive Behavior"}),s.jsx("button",{onClick:()=>{c(-1),m("Needs Attention")},className:"px-3 py-2 rounded bg-orange-100 hover:bg-orange-200 text-orange-800 border border-orange-300 text-sm font-medium flex items-center gap-2",children:"⚠️ Needs Attention"})]})]})]})]}),s.jsxs("div",{className:"bg-slate-50 px-6 py-4 rounded-b-lg flex items-center justify-between gap-3",children:[s.jsx("button",{onClick:r,className:"px-6 py-3 rounded-lg bg-slate-600 hover:bg-slate-700 text-white font-medium transition-colors",children:"Cancel"}),s.jsx("button",{onClick:W,disabled:a!==0&&!u.trim(),className:`px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 ${a!==0&&!u.trim()?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 text-white"}`,children:"📝 Save Note"})]})]})})]})}function L0({period:e,students:t,date:n,onClose:r,onEditStudent:o}){const l=[],i=new Set,a=ao(e,n);if(Object.keys(a).forEach(c=>{i.add(c)}),e.pointsEnabled&&e.pointsHistory){const c=n;e.pointsHistory.forEach(u=>{u.date.startsWith(c)&&i.add(String(u.studentId))})}return i.forEach(c=>{var S;const u=t.find(j=>String(j.id)===String(c));if(!u)return;const m=Sm(e,c,n),E=Yo(e,c,n,n);l.push({student:u,note:(m==null?void 0:m.note)||null,timestamp:(m==null?void 0:m.timestamp)||((S=E[0])==null?void 0:S.date)||null,pointChanges:E})}),l.sort((c,u)=>{const m=c.student.fullName||String(c.student.id),E=u.student.fullName||String(u.student.id);return m.localeCompare(E)}),s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 z-30",onClick:r}),s.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-3xl",children:"📝"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Behavior Notes & Points Summary"}),s.jsxs("p",{className:"text-purple-100 text-sm",children:[Ct(n)," - ",l.length," student",l.length!==1?"s":""]})]})]}),s.jsx("button",{onClick:r,className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2 transition",title:"Close",children:"✕"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:l.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("span",{className:"text-6xl",children:"📝"}),s.jsx("p",{className:"text-slate-500 mt-4 text-lg",children:"No behavior notes or point changes"}),s.jsxs("p",{className:"text-slate-400 text-sm mt-2",children:["No students have notes or point changes for ",Ct(n)]})]}):s.jsx("div",{className:"space-y-4",children:l.map(c=>{var m;const u=e.pointsEnabled?((m=e.pointsByStudent)==null?void 0:m[String(c.student.id)])??e.startingPoints??50:null;return s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border-2 border-purple-200",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("h3",{className:"text-lg font-bold text-purple-900",children:c.student.fullName||String(c.student.id)}),c.timestamp&&s.jsx("span",{className:"text-xs text-slate-500",children:new Date(c.timestamp).toLocaleTimeString()})]}),c.note&&s.jsx("p",{className:"text-sm text-slate-800 whitespace-pre-wrap mb-2",children:c.note}),c.pointChanges&&c.pointChanges.length>0&&s.jsx("div",{className:"mt-2 space-y-1",children:c.pointChanges.map((E,S)=>{const j=u!==null?u-c.pointChanges.slice(S+1).reduce((x,f)=>x+f.delta,0):0,L=Qs(j),N=E.delta>0,W=E.delta<0;return s.jsxs("div",{className:`rounded px-3 py-2 text-sm border ${ai(L)}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:`font-bold ${N?"text-green-700":W?"text-red-700":"text-slate-700"}`,children:[N?"+":"",E.delta," points"]}),s.jsx("span",{className:"text-slate-600",children:"→"}),s.jsxs("span",{className:"font-semibold",children:[j," total"]}),s.jsx("span",{className:"text-xs",children:L.emoji})]}),E.reason&&s.jsx("div",{className:"text-xs text-slate-600 mt-1",children:E.reason})]},S)})}),s.jsx("button",{onClick:()=>{o(c.student),r()},className:"mt-3 text-sm text-purple-700 hover:text-purple-900 font-semibold hover:underline",children:"✏️ Edit"})]},String(c.student.id))})})}),s.jsx("div",{className:"bg-slate-50 px-6 py-4 border-t-2 border-slate-200",children:s.jsx("button",{onClick:r,className:"w-full py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-semibold transition-colors",children:"Close"})})]})})]})}function O0({students:e,period:t,date:n,isTableSpecific:r=!1,onClose:o,onSave:l}){const[i,a]=d.useState("all"),[c,u]=d.useState(0),[m,E]=d.useState(""),S=d.useMemo(()=>{const N=Vo(t,n),W={};return e.forEach(x=>{W[String(x.id)]=N[String(x.id)]||"unmarked"}),W},[e,t,n]),j=d.useMemo(()=>{switch(i){case"present":return e.filter(N=>S[String(N.id)]==="present");case"absent":return e.filter(N=>S[String(N.id)]==="absent");case"tardy":return e.filter(N=>S[String(N.id)]==="tardy");default:return e}},[e,i,S]),L=()=>{if(!m.trim()){alert("Please provide a reason for the point adjustment.");return}const N=r?e:j;if(N.length===0){alert("No students in the selected group.");return}const W=N.map(x=>x.id);_0(t.id,W,c,m,n),l(),o()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 z-30",onClick:o}),s.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full",children:[s.jsxs("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 text-white px-6 py-4 rounded-t-lg",children:[s.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[s.jsx("span",{children:"📊"})," Bulk Adjust Points"]}),s.jsxs("p",{className:"text-sm text-green-100",children:["Applying to: ",r?`${e.length} students at this table`:`${j.length} students (filtered by: ${i==="all"?"All":i.charAt(0).toUpperCase()+i.slice(1)})`]})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[!r&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:"Select Target Students:"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx("button",{onClick:()=>a("all"),className:`px-4 py-3 rounded-lg font-medium transition-colors ${i==="all"?"bg-blue-600 text-white":"bg-white border-2 border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:"All Students"}),s.jsx("button",{onClick:()=>a("present"),className:`px-4 py-3 rounded-lg font-medium transition-colors ${i==="present"?"bg-blue-600 text-white":"bg-white border-2 border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:"All Present"}),s.jsx("button",{onClick:()=>a("absent"),className:`px-4 py-3 rounded-lg font-medium transition-colors ${i==="absent"?"bg-blue-600 text-white":"bg-white border-2 border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:"All Absent"}),s.jsx("button",{onClick:()=>a("tardy"),className:`px-4 py-3 rounded-lg font-medium transition-colors ${i==="tardy"?"bg-blue-600 text-white":"bg-white border-2 border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:"All Tardy"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:"Point Adjustment:"}),s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("button",{onClick:()=>u(-2),className:`px-4 py-2 rounded border font-bold ${c===-2?"bg-orange-500 text-white border-orange-500":"bg-white text-slate-700 border-slate-300 hover:bg-orange-50"}`,children:"-2"}),s.jsx("button",{onClick:()=>u(-1),className:`px-4 py-2 rounded border font-bold ${c===-1?"bg-yellow-500 text-white border-yellow-500":"bg-white text-slate-700 border-slate-300 hover:bg-yellow-50"}`,children:"-1"}),s.jsx("button",{onClick:()=>u(0),className:`px-4 py-2 rounded border font-bold ${c===0?"bg-slate-600 text-white border-slate-600":"bg-white text-slate-700 border-slate-300 hover:bg-slate-50"}`,children:"0"}),s.jsx("button",{onClick:()=>u(1),className:`px-4 py-2 rounded border font-bold ${c===1?"bg-green-500 text-white border-green-500":"bg-white text-slate-700 border-slate-300 hover:bg-green-50"}`,children:"+1"}),s.jsx("button",{onClick:()=>u(2),className:`px-4 py-2 rounded border font-bold ${c===2?"bg-green-600 text-white border-green-600":"bg-white text-slate-700 border-slate-300 hover:bg-green-50"}`,children:"+2"}),s.jsx("button",{onClick:()=>{const N=prompt("Enter custom point change:",String(c));N!==null&&u(parseInt(N)||0)},className:"px-4 py-2 rounded border bg-white text-slate-700 border-slate-300 hover:bg-slate-50 font-medium",children:"Custom"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:["Reason",s.jsx("span",{className:"text-red-500",children:"*"}),":"]}),s.jsx("input",{type:"text",value:m,onChange:N=>E(N.target.value),className:`w-full border-2 rounded-lg px-3 py-2 text-sm focus:outline-none ${m.trim()?"border-slate-300 focus:border-green-500":"border-red-300 focus:border-red-500"}`,placeholder:"e.g., Good behavior during class"})]})]}),s.jsxs("div",{className:"bg-slate-50 px-6 py-4 rounded-b-lg flex items-center justify-between gap-3",children:[s.jsx("button",{onClick:o,className:"px-6 py-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-medium transition-colors",children:"Cancel"}),s.jsx("button",{onClick:L,disabled:!m.trim()||(r?e.length===0:j.length===0),className:`px-6 py-3 rounded-lg font-medium transition-colors ${!m.trim()||(r?e.length===0:j.length===0)?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,children:"Apply Points"})]})]})})]})}function F0({student:e,period:t,onClose:n,onAddNote:r}){const o=Ko(t,e.id),l=Qs(o),i=t.startingPoints??50,a=d.useMemo(()=>{const u=Yo(t,e.id),m=[];let E=i;const S=[...u].sort((j,L)=>j.date.localeCompare(L.date));for(const j of S)E+=j.delta,m.push({date:j.date,delta:j.delta,reason:j.reason,total:E});return m.reverse()},[t,e.id,i]),c=u=>{let m;return u.includes("T")?m=new Date(u):m=new Date(u+"T12:00:00"),isNaN(m.getTime())?u:m.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 z-30",onClick:n}),s.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] flex flex-col",children:[s.jsxs("div",{className:`px-6 py-4 rounded-t-lg flex items-center gap-4 ${l.color==="green"?"bg-green-100 text-green-900":l.color==="yellow"?"bg-yellow-100 text-yellow-900":l.color==="orange"?"bg-orange-100 text-orange-900":"bg-red-100 text-red-900"}`,children:[s.jsx("div",{className:`w-12 h-12 rounded-full border-4 ${l.color==="green"?"bg-green-400 border-green-600":l.color==="yellow"?"bg-yellow-400 border-yellow-600":l.color==="orange"?"bg-orange-400 border-orange-600":"bg-red-400 border-red-600"}`}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:e.fullName}),s.jsxs("p",{className:"text-sm",children:["Current Points: ",o," - ",l.label]}),s.jsxs("p",{className:"text-xs opacity-75",children:["Started with ",i," points"]})]}),s.jsx("button",{onClick:n,className:"ml-auto hover:opacity-70 text-2xl",children:"×"})]}),s.jsx("div",{className:"flex-1 overflow-auto p-6",children:a.length===0?s.jsxs("div",{className:"text-center py-8 text-slate-500",children:[s.jsx("div",{className:"text-4xl mb-3",children:"📊"}),s.jsx("p",{className:"font-medium",children:"No Point History Yet"}),s.jsx("p",{className:"text-sm",children:"Point changes will appear here"})]}):s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b-2 border-slate-200",children:[s.jsx("th",{className:"text-left py-2 text-sm font-semibold text-slate-700",children:"Date"}),s.jsx("th",{className:"text-center py-2 text-sm font-semibold text-slate-700",children:"Change"}),s.jsx("th",{className:"text-left py-2 text-sm font-semibold text-slate-700",children:"Reason"}),s.jsx("th",{className:"text-right py-2 text-sm font-semibold text-slate-700",children:"New Total"})]})}),s.jsx("tbody",{children:a.map((u,m)=>s.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[s.jsx("td",{className:"py-3 text-sm text-blue-600",children:c(u.date)}),s.jsx("td",{className:"py-3 text-center",children:s.jsx("span",{className:`font-bold ${u.delta>0?"text-green-600":u.delta<0?"text-red-600":"text-slate-600"}`,children:u.delta>0?`+${u.delta}`:u.delta})}),s.jsx("td",{className:"py-3 text-sm text-slate-700",children:u.reason||"No reason provided"}),s.jsx("td",{className:"py-3 text-right",children:s.jsx("span",{className:"text-blue-600 font-semibold",children:u.total})})]},m))})]})}),s.jsxs("div",{className:"bg-slate-50 px-6 py-4 rounded-b-lg flex items-center justify-between gap-3",children:[s.jsx("button",{onClick:n,className:"px-6 py-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-medium transition-colors",children:"Close"}),r&&s.jsx("button",{onClick:r,className:"px-6 py-3 rounded-lg bg-purple-600 hover:bg-purple-700 text-white font-medium transition-colors flex items-center gap-2",children:"📝 Add Note/Adjust Points"})]})]})})]})}function z0(e,t,n,r){if(e<=0)return{cols:1,rows:0};if(r===90)return e<=4?{cols:1,rows:e}:{cols:2,rows:Math.ceil(e/2)};if(e<=2)return{cols:e,rows:1};if(e<=4)return{cols:2,rows:Math.ceil(e/2)};if(e<=6)return t/n>1.5?{cols:3,rows:Math.ceil(e/3)}:{cols:2,rows:Math.ceil(e/2)};{const l=t/n>1.8?4:3;return{cols:l,rows:Math.ceil(e/l)}}}function B0(){const[e,t]=d.useState([]),[n,r]=d.useState(null),o=d.useMemo(()=>window.localStorage.getItem("attendance:lastDate")||_u(),[]),[l,i]=d.useState(o),[a,c]=d.useState(0),[u,m]=d.useState(null),[E,S]=d.useState(!1),[j,L]=d.useState(!1),[N,W]=d.useState(null),[x,f]=d.useState(0),[v,D]=d.useState(1),[M,G]=d.useState({}),[J,U]=d.useState(!1),[te,ae]=d.useState("table"),[Y,ce]=d.useState({x:0}),[$e,xe]=d.useState(!1),[H,ge]=d.useState({x:0}),[ne,h]=d.useState(null);d.useEffect(()=>{const C=et();t(C.periods),n===null&&r(C.currentId)},[a]),d.useEffect(()=>{const C=()=>{c(I=>I+1)};return window.addEventListener("classseats-data-updated",C),()=>{window.removeEventListener("classseats-data-updated",C)}},[]),d.useEffect(()=>{if(n!==null){const C=e.find(I=>String(I.id)===String(n));if(C){const I=C.attendanceRotation||0;f(I);const q=C.attendanceZoomByRotation||{};G(q);const K=q[I]||1;D(K)}}},[n,e]);const k=e.find(C=>String(C.id)===String(n))||null,_=n?li(String(n)):[],A=Vo(k,l),p=$0(k,l);d.useEffect(()=>{window.localStorage.setItem("attendance:lastDate",l)},[l]);const P=C=>{const[I,q,K]=l.split("-").map(Number),le=new Date(I,q-1,K);le.setDate(le.getDate()+C);const je=le.getFullYear(),Te=String(le.getMonth()+1).padStart(2,"0"),me=String(le.getDate()).padStart(2,"0");i(`${je}-${Te}-${me}`)},w=()=>{i(_u())},b=new Map;return e.forEach(C=>{const I=li(String(C.id)).length;b.set(C.id,I)}),s.jsxs("div",{className:"p-6 space-y-4 bg-slate-50 min-h-screen",children:[s.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold mb-3",children:"Select Class Period"}),e.length===0?s.jsx("p",{className:"text-sm text-slate-600",children:"No periods loaded. Import periods from the Periods tab."}):s.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.map(C=>{const I=String(n)===String(C.id),q=b.get(C.id)||0;return s.jsxs("button",{onClick:()=>r(C.id),className:(I?"bg-violet-600 text-white":"bg-white border-2 border-slate-300 text-slate-800 hover:bg-slate-50")+" px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:[C.name," (",q," students)"]},String(C.id))})})]}),n&&s.jsxs("div",{className:"bg-white border rounded-lg p-3",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 mb-3",children:[s.jsx("button",{onClick:()=>P(-1),className:"px-3 py-1.5 rounded bg-slate-200 hover:bg-slate-300 text-slate-800 font-medium text-sm",title:"Previous day",children:"◄"}),s.jsx("span",{className:"px-3 py-1.5 bg-slate-100 rounded font-semibold text-slate-800 text-sm min-w-[100px] text-center",children:Ct(l)}),s.jsx("button",{onClick:()=>P(1),className:"px-3 py-1.5 rounded bg-slate-200 hover:bg-slate-300 text-slate-800 font-medium text-sm",title:"Next day",children:"►"}),s.jsx("button",{onClick:w,className:"px-3 py-1.5 rounded bg-indigo-600 hover:bg-indigo-700 text-white font-medium text-sm",children:"Today"}),s.jsx("div",{className:"w-px h-6 bg-slate-300 mx-1"}),s.jsx("select",{className:"px-3 py-1.5 rounded border-2 border-slate-300 bg-white text-sm font-medium",defaultValue:"current",children:s.jsx("option",{value:"current",children:"Current Groups"})}),s.jsxs("button",{onClick:()=>{if(!n)return;const C=(x+90)%360;f(C),Lx(n,C);const I=M[C]??1;D(I)},className:"px-3 py-1.5 rounded border-2 border-slate-300 bg-white hover:bg-slate-50 text-sm font-medium flex items-center gap-1",title:"Rotate classroom view",children:["🔄 Rotate (",x,"°)"]}),s.jsx("button",{onClick:()=>{if(!n)return;const C=Math.max(.5,v-.1);D(C),G(I=>({...I,[x]:C})),oa(n,x,C)},disabled:v<=.5,className:`px-2 py-1.5 rounded border-2 border-slate-300 text-sm font-bold ${v<=.5?"bg-slate-100 text-slate-400 cursor-not-allowed":"bg-white hover:bg-slate-50"}`,title:"Zoom out",children:"-"}),s.jsxs("span",{className:"px-2 py-1.5 text-sm font-semibold",children:[Math.round(v*100),"%"]}),s.jsx("button",{onClick:()=>{if(!n)return;const C=Math.min(2,v+.1);D(C),G(I=>({...I,[x]:C})),oa(n,x,C)},disabled:v>=2,className:`px-2 py-1.5 rounded border-2 border-slate-300 text-sm font-bold ${v>=2?"bg-slate-100 text-slate-400 cursor-not-allowed":"bg-white hover:bg-slate-50"}`,title:"Zoom in",children:"+"}),s.jsx("button",{onClick:()=>{n&&(D(1),G(C=>({...C,[x]:1})),oa(n,x,1))},className:"px-2 py-1.5 rounded border-2 border-slate-300 bg-white hover:bg-slate-50 text-sm font-medium",title:"Reset zoom to 100%",children:"Reset"}),s.jsx("div",{className:"w-px h-6 bg-slate-300 mx-1"}),s.jsxs("button",{onClick:()=>{T0(n,l),c(C=>C+1)},className:"px-3 py-1.5 rounded bg-green-600 hover:bg-green-700 text-white font-medium text-sm",children:["✓ Mark Rest (",p.total-p.present-p.absent-p.tardy-p.leftEarly,")"]}),(()=>{const C=ao(k||null,l),I=new Set;return Object.keys(C).forEach(q=>I.add(q)),k!=null&&k.pointsEnabled&&_.forEach(q=>{Yo(k,q.id,l,l).length>0&&I.add(String(q.id))}),s.jsxs("button",{onClick:()=>S(!0),className:"px-3 py-1.5 rounded bg-purple-600 hover:bg-purple-700 text-white font-medium text-sm",children:["📝 Notes (",I.size,")"]})})(),(k==null?void 0:k.pointsEnabled)&&s.jsx("button",{onClick:()=>{h(null),L(!0)},className:"px-3 py-1.5 rounded bg-amber-600 hover:bg-amber-700 text-white font-medium text-sm",children:"🏆 Bulk Points"}),s.jsx("button",{onClick:()=>U(!J),className:`px-3 py-1.5 rounded border-2 text-sm font-medium ${J?"bg-blue-600 text-white border-blue-600":"bg-white border-slate-300 hover:bg-slate-50"}`,title:"Toggle seat numbers display",children:J?"🪑 Hide Seats":"🪑 Show Seats"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs text-slate-600 font-semibold",children:"View:"}),s.jsxs("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:te,onChange:C=>ae(C.target.value),children:[s.jsx("option",{value:"table",children:"Table View"}),s.jsx("option",{value:"list-last-first",children:"List (Last, First)"}),s.jsx("option",{value:"list-first-last",children:"List (First Last)"})]})]}),s.jsx("button",{onClick:()=>{D0(n,l),c(C=>C+1)},className:"px-3 py-1.5 rounded bg-rose-600 hover:bg-rose-700 text-white font-medium text-sm",children:"↺ Reset"})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 text-sm",children:[s.jsxs("span",{className:"font-semibold text-slate-700",children:["Progress: ",p.progressPercentage,"% • Present:"," ",p.presentPercentage,"%"]}),s.jsxs("span",{className:"px-2 py-0.5 rounded bg-green-100 text-green-800 font-medium border border-green-300",children:["✓ Present: ",p.present]}),s.jsxs("span",{className:"px-2 py-0.5 rounded bg-red-100 text-red-800 font-medium border border-red-300",children:["✗ Absent: ",p.absent]}),s.jsxs("span",{className:"px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 font-medium border border-yellow-300",children:["⏰ Tardy: ",p.tardy]}),s.jsxs("span",{className:"px-2 py-0.5 rounded bg-orange-100 text-orange-800 font-medium border border-orange-300",children:["⏪ Left Early: ",p.leftEarly]})]})]}),n&&_.length>0&&(()=>{const C=$s(),I=e.find(me=>String(me.id)===String(n)),q=I==null?void 0:I.layoutId,K=C.find(me=>String(me.id)===String(q)),le=(I==null?void 0:I.activeGrouping)||[];pn();const je=mt();if(!K)return s.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold mb-3",children:"Students"}),s.jsx("p",{className:"text-sm text-slate-600 mb-3",children:"No layout assigned to this period. Assign a layout from the Room Setup tab to see seating chart view."}),s.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-3",children:_.map(me=>{var O;const Pe=A[String(me.id)]||"unmarked",Le=ia(Pe),Oe=la(Pe),oe=!!ao(I||null,l)[String(me.id)],$=((O=I==null?void 0:I.pointsHistory)==null?void 0:O.some(y=>String(y.studentId)===String(me.id)&&y.date.startsWith(l)))??!1;return s.jsx(Au,{student:me,status:Pe,bgColor:Le,icon:Oe,showNoteBadge:oe||$,onStatusChange:y=>{wo(n,me.id,l,y),localStorage.setItem("newui_drive_dirty_reason",`attendance:${n}:${me.id}:${l}`),c(R=>R+1)},onOpenBehaviorModal:()=>m(me)},String(me.id))})})]});if(te!=="table"){const me=[..._].sort((Le,Oe)=>{const[F,...oe]=Le.fullName.split(" "),$=oe.join(" "),[O,...y]=Oe.fullName.split(" "),R=y.join(" ");return te==="list-last-first"?$.localeCompare(R)||F.localeCompare(O):F.localeCompare(O)||$.localeCompare(R)}),Pe=ao(I||null,l);return s.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold mb-3",children:"Students"}),s.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-3",children:me.map(Le=>{var y;const Oe=A[String(Le.id)]||"unmarked",F=ia(Oe),oe=la(Oe),$=!!Pe[String(Le.id)],O=((y=I==null?void 0:I.pointsHistory)==null?void 0:y.some(R=>String(R.studentId)===String(Le.id)&&R.date.startsWith(l)))??!1;return s.jsx(Au,{student:Le,status:Oe,bgColor:F,icon:oe,showNoteBadge:$||O,onStatusChange:R=>{wo(n,Le.id,l,R),localStorage.setItem("newui_drive_dirty_reason",`attendance:${n}:${Le.id}:${l}`),c(z=>z+1)},onOpenBehaviorModal:()=>m(Le)},String(Le.id))})})]})}return s.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold mb-3",children:"Seating Chart Attendance"}),s.jsx("div",{className:"relative bg-slate-50 border-2 border-slate-300 rounded flex items-center justify-center overflow-visible",style:(()=>{let Pe=1/0,Le=1/0,Oe=-1/0,F=-1/0;le.forEach((re,ie)=>{var Ce,ye,Ee,pe,se;const we=(Ce=I==null?void 0:I.tableAssignments)==null?void 0:Ce[String(ie)];let ee=null;if(we&&(ee=K.tables.find(B=>String(B.id)===String(we))||null),ee||(ee=K.tables[ie]||null),!ee){const B=we||`temp-${ie}`,fe=(ye=I==null?void 0:I.tablePositions)==null?void 0:ye[B],Ae=(fe==null?void 0:fe.position)||fe||{x:20+ie*220,y:20},Ke=(Ee=I==null?void 0:I.tableDimensions)==null?void 0:Ee[B],Qe=(fe==null?void 0:fe.width)||(Ke==null?void 0:Ke.width)||200,Xe=(fe==null?void 0:fe.height)||(Ke==null?void 0:Ke.height)||150;Pe=Math.min(Pe,Ae.x),Le=Math.min(Le,Ae.y),Oe=Math.max(Oe,Ae.x+Qe),F=Math.max(F,Ae.y+Xe)}else{const B=(pe=I==null?void 0:I.tablePositions)==null?void 0:pe[ee.id],fe=(se=I==null?void 0:I.tableDimensions)==null?void 0:se[ee.id],Ae=(B==null?void 0:B.position)||B||ee.position||{x:100,y:100},Ke=(B==null?void 0:B.width)||(fe==null?void 0:fe.width)||ee.width||240,Qe=(B==null?void 0:B.height)||(fe==null?void 0:fe.height)||ee.height||200;Pe=Math.min(Pe,Ae.x),Le=Math.min(Le,Ae.y),Oe=Math.max(Oe,Ae.x+Ke),F=Math.max(F,Ae.y+Qe)}});const oe=Oe-Pe+100*2,$=F-Le+100*2,O=x*Math.PI/180,y=Math.abs(Math.cos(O)),R=Math.abs(Math.sin(O));return{minHeight:`${(oe*R+$*y)*v}px`,paddingTop:`${Math.max(20,40*v)}px`,paddingBottom:`${Math.max(20,40*v)}px`}})(),children:s.jsx("div",{className:"relative",style:(()=>{let Pe=1/0,Le=1/0,Oe=-1/0,F=-1/0;le.forEach((O,y)=>{var re,ie,we,ee,ze;const R=(re=I==null?void 0:I.tableAssignments)==null?void 0:re[String(y)];let z=null;if(R&&(z=K.tables.find(Ce=>String(Ce.id)===String(R))||null),z||(z=K.tables[y]||null),!z){const Ce=R||`temp-${y}`,ye=(ie=I==null?void 0:I.tablePositions)==null?void 0:ie[Ce],Ee=(ye==null?void 0:ye.position)||ye||{x:20+y*220,y:20},pe=(we=I==null?void 0:I.tableDimensions)==null?void 0:we[Ce],se=(ye==null?void 0:ye.width)||(pe==null?void 0:pe.width)||200,B=(ye==null?void 0:ye.height)||(pe==null?void 0:pe.height)||150;Pe=Math.min(Pe,Ee.x),Le=Math.min(Le,Ee.y),Oe=Math.max(Oe,Ee.x+se),F=Math.max(F,Ee.y+B)}else{const Ce=(ee=I==null?void 0:I.tablePositions)==null?void 0:ee[z.id],ye=(ze=I==null?void 0:I.tableDimensions)==null?void 0:ze[z.id],Ee=(Ce==null?void 0:Ce.position)||Ce||z.position||{x:100,y:100},pe=(Ce==null?void 0:Ce.width)||(ye==null?void 0:ye.width)||z.width||240,se=(Ce==null?void 0:Ce.height)||(ye==null?void 0:ye.height)||z.height||200;Pe=Math.min(Pe,Ee.x),Le=Math.min(Le,Ee.y),Oe=Math.max(Oe,Ee.x+pe),F=Math.max(F,Ee.y+se)}});const oe=Oe-Pe+100*2,$=F-Le+100*2;return{width:`${oe}px`,height:`${$}px`,transform:`translateX(${Y.x}px) scale(${v}) rotate(${x}deg)`,transformOrigin:"center center",transition:$e?"none":"transform 0.3s",backgroundImage:"radial-gradient(circle, #d1d5db 1px, transparent 1px)",backgroundSize:"20px 20px",cursor:$e?"grabbing":"grab"}})(),onMouseDown:me=>{xe(!0),ge({x:me.clientX-Y.x}),me.preventDefault()},onMouseMove:me=>{$e&&ce({x:me.clientX-H.x})},onMouseUp:()=>xe(!1),onMouseLeave:()=>xe(!1),children:(()=>{let Pe=1/0,Le=1/0;return le.forEach((Oe,F)=>{var O,y,R;const oe=(O=I==null?void 0:I.tableAssignments)==null?void 0:O[String(F)];let $=null;if(oe&&($=K.tables.find(z=>String(z.id)===String(oe))||null),$||($=K.tables[F]||null),$){const z=(y=I==null?void 0:I.tablePositions)==null?void 0:y[$.id],X=(z==null?void 0:z.position)||z||$.position||{x:100,y:100};Pe=Math.min(Pe,X.x),Le=Math.min(Le,X.y)}else{const z=oe||`temp-${F}`,X=(R=I==null?void 0:I.tablePositions)==null?void 0:R[z],re=(X==null?void 0:X.position)||X||{x:20+F*220,y:20};Pe=Math.min(Pe,re.x),Le=Math.min(Le,re.y)}}),le.map((Oe,F)=>{var ee,ze,Ce,ye,Ee;const oe=(ee=I==null?void 0:I.tableAssignments)==null?void 0:ee[String(F)];let $=null;oe&&($=K.tables.find(pe=>String(pe.id)===String(oe))||null),$||($=K.tables[F]||null);const O=!$,y=Oe.map(pe=>je.find(se=>String(se.id)===String(pe))).filter(pe=>!!pe);O?F+1:$.name;let R,z,X;if(O){const pe=oe||`temp-${F}`,se=(ze=I==null?void 0:I.tablePositions)==null?void 0:ze[pe];R=(se==null?void 0:se.position)||se||{x:20+F*220,y:20};const B=(Ce=I==null?void 0:I.tableDimensions)==null?void 0:Ce[pe];z=(se==null?void 0:se.width)||(B==null?void 0:B.width)||200,X=(se==null?void 0:se.height)||(B==null?void 0:B.height)||150}else{const pe=(ye=I==null?void 0:I.tablePositions)==null?void 0:ye[$.id];R=(pe==null?void 0:pe.position)||pe||$.position||{x:100+F%3*280,y:100+Math.floor(F/3)*280};const se=(Ee=I==null?void 0:I.tableDimensions)==null?void 0:Ee[$.id];z=(pe==null?void 0:pe.width)||(se==null?void 0:se.width)||$.width||240,X=(pe==null?void 0:pe.height)||(se==null?void 0:se.height)||$.height||150}const re=R.x-Pe+100,ie=R.y-Le+100,we=z0(($==null?void 0:$.capacity)||y.length,z,X,($==null?void 0:$.rotation)||0);return s.jsxs("div",{className:`absolute border-2 rounded-lg bg-white shadow-md ${O?"border-orange-500":"border-slate-300"}`,style:{left:`${re}px`,top:`${ie}px`,width:`${z}px`},children:[s.jsx("div",{className:`border-b-2 px-2 py-1 rounded-t-lg flex items-center justify-end gap-1 ${O?"bg-orange-50 border-orange-300":"bg-slate-100 border-slate-300"}`,style:{transform:x===180?"rotate(-180deg)":"none",transition:"transform 0.3s ease"},children:y.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>{M0(n,l,y.map(pe=>pe.id)),c(pe=>pe+1)},className:"text-xs px-2 py-1 rounded bg-blue-600 hover:bg-blue-700 text-white font-medium",title:"Mark all unmarked students in this table as present",children:"Mark Rest ✓"}),(I==null?void 0:I.pointsEnabled)&&s.jsx("button",{onClick:()=>{const pe=y.map(se=>String(se.id));h(pe),L(!0)},className:"text-xs px-2 py-1 rounded bg-green-600 hover:bg-green-700 text-white",title:"Adjust behavior points for this table",children:"📊"})]})}),s.jsx("div",{className:"p-1",style:{display:"grid",gridTemplateColumns:`repeat(${we.cols}, 1fr)`,gap:"4px"},children:y.length===0?s.jsx("div",{className:"col-span-2 text-xs text-slate-400 italic text-center py-4",children:"Empty table"}):y.map((pe,se)=>{var it,Fe,Ie;const B=A[String(pe.id)]||"unmarked",fe=ia(B),Ae=la(B),Qe=!!ao(I||null,l)[String(pe.id)],Xe=((it=I==null?void 0:I.pointsHistory)==null?void 0:it.some(Ft=>String(Ft.studentId)===String(pe.id)&&Ft.date.startsWith(l)))??!1;let rt=null;if(J&&!O){const Ft=(Ie=(Fe=I==null?void 0:I.tableNumbering)==null?void 0:Fe.perTableSeatNumbers)==null?void 0:Ie[$.id];if(Ft&&Ft[se])rt=Ft[se];else{const vt=K.tables.find(qe=>String(qe.id)===String($.id));vt!=null&&vt.seatNumbers&&vt.seatNumbers[se]&&(rt=vt.seatNumbers[se])}}return s.jsx(W0,{student:pe,period:I,status:B,bgColor:fe,icon:Ae,showNoteBadge:Qe||Xe,showSeatNumbers:J,seatNumber:rt,rotation:x,onStatusChange:Ft=>{wo(n,pe.id,l,Ft),localStorage.setItem("newui_drive_dirty_reason",`attendance:${n}:${pe.id}:${l}`),c(vt=>vt+1)},onOpenBehaviorModal:()=>m(pe),onOpenHistory:()=>W(pe)},String(pe.id))})})]},O?`temp-${F}`:String($.id))})})()})})]})})(),!n&&e.length>0&&s.jsx("div",{className:"bg-white border rounded-lg p-6 text-center text-slate-600",children:s.jsx("p",{children:"Select a period to view attendance"})}),u&&k&&s.jsx(A0,{student:u,period:k,date:l,onClose:()=>m(null),onSave:()=>c(C=>C+1)}),E&&k&&s.jsx(L0,{period:k,students:_,date:l,onClose:()=>S(!1),onEditStudent:C=>{m(C),S(!1)}}),j&&k&&s.jsx(O0,{students:ne?_.filter(C=>ne.includes(String(C.id))):_,period:k,date:l,isTableSpecific:ne!==null,onClose:()=>{L(!1),h(null)},onSave:()=>c(C=>C+1)}),N&&k&&s.jsx(F0,{student:N,period:k,onClose:()=>W(null),onAddNote:()=>{m(N),W(null)}})]})}function Au({student:e,status:t,bgColor:n,icon:r,initial:o,chip:l,studentTags:i,onStatusChange:a,onOpenBehaviorModal:c,showNoteBadge:u}){const[m,E]=d.useState(!1),S=e.fullName||String(e.id),j=t==="unmarked"?"animate-pulse-slow":"";return s.jsxs("div",{className:`relative flex items-start gap-2 p-2 ${n} rounded border-2 border-slate-300 ${j}`,children:[o&&l&&s.jsx("span",{className:`${l} text-white rounded-full w-7 h-7 flex items-center justify-center text-xs font-bold flex-shrink-0`,children:o}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"font-medium text-sm leading-tight flex items-center gap-1",children:[S,u&&s.jsx("span",{className:"text-purple-600",title:"Has behavior note or point change",children:"📝"})]}),i&&i.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:i.map(L=>s.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{backgroundColor:L.color+"40",color:L.color},children:L.name},String(L.id)))})]}),s.jsx("span",{className:"text-lg flex-shrink-0",children:r}),s.jsx("button",{onClick:()=>E(!m),className:"text-slate-600 hover:text-slate-900 font-bold flex-shrink-0 px-1",title:"Mark attendance",children:"⋮"}),m&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-90",onClick:()=>E(!1)}),s.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white border-2 border-slate-300 rounded-lg shadow-lg z-9999 min-w-[160px]",children:[s.jsxs("button",{onClick:()=>{a("present"),E(!1)},className:"w-full text-left px-3 py-2 hover:bg-green-100 flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-green-600 font-bold",children:"✓"})," Present"]}),s.jsxs("button",{onClick:()=>{a("absent"),E(!1)},className:"w-full text-left px-3 py-2 hover:bg-red-100 flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-red-600 font-bold",children:"✗"})," Absent"]}),s.jsxs("button",{onClick:()=>{a("tardy"),E(!1)},className:"w-full text-left px-3 py-2 hover:bg-yellow-100 flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-yellow-600 font-bold",children:"⏰"})," Tardy"]}),s.jsxs("button",{onClick:()=>{a("left_early"),E(!1)},className:"w-full text-left px-3 py-2 hover:bg-orange-100 flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-orange-600 font-bold",children:"⏪"})," Left Early"]}),s.jsx("div",{className:"border-t border-gray-200 my-1"}),s.jsxs("button",{onClick:()=>{a("unmarked"),E(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-gray-600 font-bold",children:"⬜"})," Clear"]}),c&&s.jsxs("button",{onClick:()=>{c(),E(!1)},className:"w-full text-left px-3 py-2 hover:bg-purple-100 flex items-center gap-2 text-sm text-purple-700",children:[s.jsx("span",{children:"📝"})," Behavior Notes"]})]})]})]})}function W0({student:e,period:t,status:n,bgColor:r,icon:o,showNoteBadge:l,showSeatNumbers:i,seatNumber:a,rotation:c,onStatusChange:u,onOpenBehaviorModal:m,onOpenHistory:E}){var M;const[S,j]=d.useState(!1),L=d.useRef(null),N=e.fullName||String(e.id);d.useEffect(()=>{if(!S)return;const G=U=>{L.current&&!L.current.contains(U.target)&&j(!1)},J=setTimeout(()=>{document.addEventListener("click",G)},0);return()=>{clearTimeout(J),document.removeEventListener("click",G)}},[S]);const W=N.trim().split(" "),x=W[0]||"",f=W.length>1?W.slice(1).join(" "):"",v=t.pointsEnabled?((M=t.pointsByStudent)==null?void 0:M[String(e.id)])??t.startingPoints??50:null,D=v!==null?Qs(v):null;return s.jsxs("div",{className:`relative border border-slate-300 rounded ${r} px-1 py-1 text-xs`,style:{transform:c===180?"rotate(-180deg)":"none",transition:"transform 0.3s ease",zIndex:S?100:"auto"},children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 mb-0.5",children:[s.jsx("button",{onClick:()=>j(!S),className:"text-slate-600 hover:text-slate-900 font-bold text-sm leading-none px-1.5 py-1 rounded border border-transparent hover:border-slate-500",title:"Mark attendance",children:"⋮"}),s.jsxs("div",{className:`w-4 h-4 border-2 border-slate-400 rounded flex items-center justify-center ${n==="present"?"bg-green-500":n==="absent"?"bg-red-500":""}`,children:[n==="present"&&s.jsx("span",{className:"text-white text-xs leading-none",children:"✓"}),n==="absent"&&s.jsx("span",{className:"text-white text-xs leading-none",children:"✗"}),n==="tardy"&&s.jsx("span",{className:"text-xs leading-none",children:"⏰"}),n==="left_early"&&s.jsx("span",{className:"text-xs leading-none",children:"⏪"})]}),v!==null&&D&&s.jsx("span",{className:`font-bold px-1 py-0.5 rounded text-white text-xs ${D.color==="green"?"bg-green-600":D.color==="yellow"?"bg-yellow-500":D.color==="orange"?"bg-orange-500":D.color==="red"?"bg-red-600":"bg-slate-600"}`,children:v}),l&&s.jsx("button",{onClick:m,className:"text-purple-600 hover:text-purple-800",title:"Has behavior note or point change",children:"📝"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold text-slate-900 leading-tight text-xs",children:x}),f&&s.jsx("div",{className:"font-bold text-slate-900 leading-tight text-xs",children:f})]})]}),i&&a&&s.jsx("div",{className:"text-center py-0.5 mt-0.5",children:s.jsxs("span",{className:"text-xs bg-slate-600 text-white rounded px-2 py-0.5 font-semibold",title:`Seat number ${a}`,children:["Seat ",a]})}),S&&s.jsx(s.Fragment,{children:s.jsxs("div",{ref:L,className:"absolute bg-white border-2 border-slate-300 rounded-lg shadow-lg z-[100] min-w-[160px]",style:{transform:c===90?"rotate(-90deg)":c===270?"rotate(-270deg)":"none",transformOrigin:c===90?"top right":c===270?"bottom left":"top left",...c===0?{left:0,top:"100%",marginTop:"4px"}:c===90?{right:0,top:0}:c===180?{left:0,top:"100%",marginTop:"4px"}:c===270?{left:0,bottom:0}:{}},children:[s.jsx("div",{className:"px-3 py-2 bg-slate-100 border-b border-slate-200 rounded-t-lg",children:s.jsx("div",{className:"text-sm font-bold text-slate-900",children:N})}),D&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"px-3 py-2 bg-green-50 border-b border-green-200",children:[s.jsxs("div",{className:"text-sm font-medium",children:["Behavior Points:"," ",s.jsx("span",{className:ai(D),children:D.emoji})," ",v]}),s.jsx("div",{className:"text-xs text-slate-600",children:D.label})]})}),s.jsxs("button",{onClick:()=>{u("present"),j(!1)},className:"w-full text-left px-3 py-2 hover:bg-green-100 flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-green-600 font-bold",children:"✓"})," Present"]}),s.jsxs("button",{onClick:()=>{u("absent"),j(!1)},className:"w-full text-left px-3 py-2 hover:bg-red-100 flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-red-600 font-bold",children:"✗"})," Absent"]}),s.jsxs("button",{onClick:()=>{u("tardy"),j(!1)},className:"w-full text-left px-3 py-2 hover:bg-yellow-100 flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-yellow-600 font-bold",children:"⏰"})," Tardy"]}),s.jsxs("button",{onClick:()=>{u("left_early"),j(!1)},className:"w-full text-left px-3 py-2 hover:bg-orange-100 flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-orange-600 font-bold",children:"⏪"})," Left Early"]}),s.jsx("div",{className:"border-t border-gray-200 my-1"}),s.jsxs("button",{onClick:()=>{u("unmarked"),j(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-100 flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-gray-600 font-bold",children:"⬜"})," Clear/Unmarked"]}),s.jsxs("button",{onClick:()=>{m(),j(!1)},className:"w-full text-left px-3 py-2 hover:bg-purple-100 flex items-center gap-2 text-sm text-purple-700",children:[s.jsx("span",{children:"📝"})," Behavior Notes"]}),E&&D&&s.jsxs("button",{onClick:()=>{E(),j(!1)},className:"w-full text-left px-3 py-2 hover:bg-blue-100 flex items-center gap-2 text-sm text-blue-700",children:[s.jsx("span",{children:"📊"})," View Point History"]})]})})]})}function G0(){const[e,t]=d.useState([]),[n,r]=d.useState(null),[o,l]=d.useState(0),[i,a]=d.useState(!0),[c,u]=d.useState(!1),[m,E]=d.useState(null),[S,j]=d.useState(""),[L,N]=d.useState(""),[W,x]=d.useState(1),[f,v]=d.useState(""),[D,M]=d.useState(0),[G,J]=d.useState(0);d.useEffect(()=>{const p=et();t(p.periods),r(p.currentId)},[o]);const U=d.useMemo(()=>n?mt().filter(p=>(p.periodIds||[]).some(P=>String(P)===String(n))):[],[n,o]),te=d.useMemo(()=>n?Gn(n):{work:{},solos:{},gotChoice:{}},[n,o]),ae=d.useMemo(()=>n?ii(n):[],[n,o]),Y=e.find(p=>String(p.id)===String(n)),ce=d.useMemo(()=>U.map(p=>({student:p,gotChoice:te.gotChoice[String(p.id)]||0,solos:te.solos[String(p.id)]||0})).sort((p,P)=>p.student.fullName.localeCompare(P.student.fullName)),[U,te]),$e=d.useMemo(()=>{const p=[],P=new Map(U.map(w=>[String(w.id),w]));for(const w in te.work){const b=w.includes("|")?w.split("|"):w.split("-");if(b.length!==2)continue;const[C,I]=b,q=P.get(C),K=P.get(I);q&&K&&p.push({id1:q.id,id2:K.id,student1:q,student2:K,times:te.work[w]})}return p.sort((w,b)=>b.times-w.times)},[U,te]),xe=()=>{if(!n||!S||!L||S===L){alert("Please select two different students.");return}c0(n,S,L,W),l(p=>p+1),j(""),N(""),x(1)},H=()=>{if(!n||!f){alert("Please select a student.");return}i0(n,f,D),l(p=>p+1)},ge=()=>{if(!n||!f){alert("Please select a student.");return}a0(n,f,G),l(p=>p+1)},ne=()=>{n&&window.confirm("Clear all pair work history for this period? This cannot be undone.")&&(d0(n),l(p=>p+1))},h=()=>{n&&window.confirm("Clear all Got Choice counts for this period? This cannot be undone.")&&(u0(n),l(p=>p+1))},k=()=>{n&&window.confirm("Clear all Solo counts for this period? This cannot be undone.")&&(f0(n),l(p=>p+1))},_=()=>{n&&window.confirm("Clear all saved groupings for this period? This cannot be undone.")&&(ii(n).forEach(P=>hm(n,P.id)),l(P=>P+1))},A=p=>{try{return new Date(p).toLocaleDateString("en-US",{month:"numeric",day:"numeric",year:"numeric"})}catch{return p}};return s.jsxs("div",{className:"p-6 space-y-6 bg-slate-50 min-h-screen",children:[s.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold mb-3",children:"Select Class Period"}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.map(p=>{const P=String(p.id)===String(n),w=mt().filter(b=>(b.periodIds||[]).some(C=>String(C)===String(p.id))).length;return s.jsxs("button",{className:(P?"bg-violet-600 text-white":"bg-white border-2 border-slate-300 text-slate-800 hover:bg-slate-50")+" px-4 py-2 rounded-lg text-sm font-medium transition-colors",onClick:()=>{Ut(p.id),r(p.id)},children:[p.name," (",w," students)"]},String(p.id))}),e.length===0&&s.jsx("div",{className:"text-sm text-slate-500",children:"No periods yet. Add periods on the Room Setup tab."})]})]}),n&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Work History & Statistics"}),s.jsx("p",{className:"text-sm text-slate-600",children:"Track student collaborations and preferences"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>u(!c),className:`px-4 py-2 rounded-lg font-medium flex items-center gap-2 ${c?"bg-amber-600 hover:bg-amber-700 text-white":"bg-white border-2 border-slate-300 hover:bg-slate-50 text-slate-700"}`,children:c?"* Done Editing":"* Edit History"}),s.jsx("button",{onClick:()=>a(!i),className:"px-4 py-2 rounded-lg bg-slate-600 hover:bg-slate-700 text-white font-medium",children:i?"Hide Details":"Show Details"})]})]}),c&&s.jsxs("div",{className:"mt-4 border-2 border-blue-200 rounded-lg p-4 bg-blue-50",children:[s.jsx("h3",{className:"text-lg font-bold text-blue-800 mb-4",children:"Manual History Editor"}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h4",{className:"font-semibold text-slate-700 mb-3",children:"Add/Edit Pair Work History"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Student 1:"}),s.jsxs("select",{value:S,onChange:p=>j(p.target.value),className:"w-full border border-slate-300 rounded px-3 py-2",children:[s.jsx("option",{value:"",children:"Select..."}),U.map(p=>s.jsx("option",{value:String(p.id),children:p.fullName},String(p.id)))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Student 2:"}),s.jsxs("select",{value:L,onChange:p=>N(p.target.value),className:"w-full border border-slate-300 rounded px-3 py-2",children:[s.jsx("option",{value:"",children:"Select..."}),U.map(p=>s.jsx("option",{value:String(p.id),children:p.fullName},String(p.id)))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Times:"}),s.jsx("input",{type:"number",min:0,value:W,onChange:p=>x(parseInt(p.target.value)||0),className:"w-full border border-slate-300 rounded px-3 py-2"})]}),s.jsx("button",{onClick:xe,className:"px-4 py-2 rounded bg-blue-600 hover:bg-blue-700 text-white font-medium",children:"Set"})]})]}),s.jsx("hr",{className:"border-slate-300 my-4"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-slate-700 mb-3",children:"Edit Individual Student Stats"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Student:"}),s.jsxs("select",{value:f,onChange:p=>v(p.target.value),className:"w-full border border-slate-300 rounded px-3 py-2",children:[s.jsx("option",{value:"",children:"Select..."}),U.map(p=>s.jsx("option",{value:String(p.id),children:p.fullName},String(p.id)))]})]}),s.jsxs("div",{className:"flex items-end gap-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Got Choice:"}),s.jsx("input",{type:"number",min:0,value:D,onChange:p=>M(parseInt(p.target.value)||0),className:"w-full border border-slate-300 rounded px-3 py-2"})]}),s.jsx("button",{onClick:H,className:"px-4 py-2 rounded bg-blue-600 hover:bg-blue-700 text-white font-medium",children:"Set"})]}),s.jsxs("div",{className:"flex items-end gap-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Solo Count:"}),s.jsx("input",{type:"number",min:0,value:G,onChange:p=>J(parseInt(p.target.value)||0),className:"w-full border border-slate-300 rounded px-3 py-2"})]}),s.jsx("button",{onClick:ge,className:"px-4 py-2 rounded bg-green-600 hover:bg-green-700 text-white font-medium",children:"Set"})]})]})]})]})]}),i&&s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-amber-100 border-2 border-amber-300 rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"bg-amber-600 text-white px-4 py-3",children:[s.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[s.jsx("span",{children:"*"})," Student Statistics"]}),s.jsx("p",{className:"text-sm text-amber-100",children:"Individual student tracking"})]}),s.jsx("div",{className:"max-h-96 overflow-y-auto bg-white",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"sticky top-0 bg-white border-b-2 border-amber-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left px-4 py-2 text-sm font-semibold",children:"Student"}),s.jsx("th",{className:"text-center px-4 py-2 text-sm font-semibold",children:"Got Choice"}),s.jsx("th",{className:"text-center px-4 py-2 text-sm font-semibold",children:"Solos"})]})}),s.jsxs("tbody",{children:[ce.map((p,P)=>s.jsxs("tr",{className:P%2===0?"bg-white":"bg-amber-50",children:[s.jsxs("td",{className:"px-4 py-2 text-sm flex items-center gap-2",children:[s.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white ${["bg-red-500","bg-orange-500","bg-yellow-500","bg-green-500","bg-blue-500","bg-purple-500"][P%6]}`,children:p.student.fullName.charAt(0)}),p.student.fullName]}),s.jsx("td",{className:"px-4 py-2 text-center",children:s.jsx("span",{className:"text-blue-600 font-semibold",children:p.gotChoice})}),s.jsx("td",{className:"px-4 py-2 text-center",children:s.jsx("span",{className:"text-orange-600 font-semibold",children:p.solos})})]},String(p.student.id))),ce.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:3,className:"px-4 py-8 text-center text-slate-500",children:"No students in this period"})})]})]})})]}),s.jsxs("div",{className:"bg-cyan-100 border-2 border-cyan-300 rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"bg-cyan-600 text-white px-4 py-3",children:[s.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[s.jsx("span",{children:"*"})," Pair Work History"]}),s.jsx("p",{className:"text-sm text-cyan-100",children:"Student collaboration tracking"})]}),s.jsx("div",{className:"max-h-96 overflow-y-auto bg-white",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"sticky top-0 bg-white border-b-2 border-cyan-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left px-4 py-2 text-sm font-semibold",children:"Student 1"}),s.jsx("th",{className:"text-left px-4 py-2 text-sm font-semibold",children:"Student 2"}),s.jsx("th",{className:"text-center px-4 py-2 text-sm font-semibold",children:"Times"})]})}),s.jsxs("tbody",{children:[$e.map((p,P)=>s.jsxs("tr",{className:P%2===0?"bg-white":"bg-cyan-50",children:[s.jsx("td",{className:"px-4 py-2 text-sm text-blue-600",children:p.student1.fullName}),s.jsx("td",{className:"px-4 py-2 text-sm text-blue-600",children:p.student2.fullName}),s.jsx("td",{className:"px-4 py-2 text-center",children:s.jsx("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded font-semibold",children:p.times})})]},`${p.id1}-${p.id2}`)),$e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:3,className:"px-4 py-8 text-center text-slate-500",children:"No pair work history recorded"})})]})]})})]})]}),s.jsxs("div",{className:"bg-green-100 border-2 border-green-300 rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"bg-green-600 text-white px-4 py-3",children:[s.jsx("h3",{className:"font-bold",children:"Saved Groupings"}),s.jsxs("p",{className:"text-sm text-green-100",children:[ae.length," grouping(s) saved"]})]}),s.jsxs("div",{className:"p-4 bg-white space-y-3",children:[ae.map((p,P)=>s.jsxs("div",{className:"flex items-center justify-between border border-slate-200 rounded-lg p-3",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold text-slate-900",children:p.name||`Grouping #${P+1}`}),s.jsxs("span",{className:"text-sm text-slate-600 ml-2",children:[A(p.savedAt)," - ",p.groups.length," groups"]})]}),s.jsx("button",{onClick:()=>E(p),className:"px-4 py-2 rounded bg-slate-700 hover:bg-slate-800 text-white font-medium",children:"View Groups"})]},p.id)),ae.length===0&&s.jsx("div",{className:"text-center py-6 text-slate-500",children:s.jsx("p",{children:"No saved groupings for this period"})})]})]}),s.jsxs("div",{className:"bg-rose-50 border-2 border-rose-300 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-lg font-bold text-rose-700 mb-3 flex items-center gap-2",children:[s.jsx("span",{children:"*"})," Danger Zone - Clear History Data (",(Y==null?void 0:Y.name)||"Period",")"]}),s.jsxs("div",{className:"flex flex-wrap gap-3",children:[s.jsx("button",{onClick:ne,className:"px-4 py-2 rounded border-2 border-rose-500 bg-white hover:bg-rose-50 text-rose-700 font-medium",children:"Clear Work History"}),s.jsx("button",{onClick:h,className:"px-4 py-2 rounded border-2 border-rose-500 bg-white hover:bg-rose-50 text-rose-700 font-medium",children:"Clear Got Choice"}),s.jsx("button",{onClick:k,className:"px-4 py-2 rounded border-2 border-rose-500 bg-white hover:bg-rose-50 text-rose-700 font-medium",children:"Clear Solos"}),s.jsx("button",{onClick:_,className:"px-4 py-2 rounded border-2 border-rose-500 bg-white hover:bg-rose-50 text-rose-700 font-medium",children:"Clear Saved Groupings"})]}),s.jsxs("p",{className:"text-sm text-rose-600 mt-3",children:["* These actions only affect ",(Y==null?void 0:Y.name)||"this period"," and cannot be undone. Export a backup first!"]})]})]}),m&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 z-30",onClick:()=>E(null)}),s.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[80vh] flex flex-col",children:[s.jsxs("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 text-white px-6 py-4 rounded-t-lg",children:[s.jsx("h2",{className:"text-xl font-bold",children:m.name||"Saved Grouping"}),s.jsxs("p",{className:"text-sm text-green-100",children:["Saved on ",A(m.savedAt)," - ",m.groups.length," groups"]})]}),s.jsx("div",{className:"flex-1 overflow-auto p-6 space-y-4",children:m.groups.map((p,P)=>{const w=p.map(b=>U.find(C=>String(C.id)===String(b))).filter(Boolean);return s.jsxs("div",{className:"border-2 border-slate-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"font-semibold text-slate-700 mb-2",children:["Group ",P+1]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.map(b=>s.jsx("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:b.fullName},String(b.id))),w.length===0&&s.jsx("span",{className:"text-slate-500 text-sm",children:"No students found"})]})]},P)})}),s.jsx("div",{className:"bg-slate-50 px-6 py-4 rounded-b-lg",children:s.jsx("button",{onClick:()=>E(null),className:"px-6 py-3 rounded-lg bg-slate-600 hover:bg-slate-700 text-white font-medium",children:"Close"})})]})})]})]})}const Lu=[{id:"attendance",label:"Attendance",icon:"📅",description:"Attendance summary"},{id:"behavior",label:"Behavior",icon:"📝",description:"Notes & points"},{id:"combined",label:"Combined",icon:"📊",description:"Attendance + behavior"},{id:"roster",label:"Roster",icon:"📋",description:"Printable roster"},{id:"seating",label:"Seating Chart",icon:"🪑",description:"Current seating chart"}],H0=[["attendance","behavior","combined"],["roster","seating"]],U0=[{label:"Last 7",days:7},{label:"Last 30",days:30}];function Ou(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${r}`}function aa(e){var t;return e.currentId??((t=e.periods[0])==null?void 0:t.id)??null}function V0(){var Ee,pe,se;const[e,t]=d.useState(()=>et()),[n,r]=d.useState(()=>mt()),[o,l]=d.useState(()=>pn()),[i,a]=d.useState(()=>aa(et())),[c,u]=d.useState("all"),[m,E]=d.useState("attendance"),[S,j]=d.useState(""),[L,N]=d.useState(""),[W,x]=d.useState(null),[f,v]=d.useState(0),[D,M]=d.useState(null),[G,J]=d.useState("summary"),[U,te]=d.useState("lastName"),[ae,Y]=d.useState(!0),[ce,$e]=d.useState(null),[xe,H]=d.useState(!1),[ge,ne]=d.useState([]),[h,k]=d.useState(!0),[_,A]=d.useState(!1),[p,P]=d.useState(!0),[w,b]=d.useState(null),[C,I]=d.useState(!1),[q,K]=d.useState([]),[le,je]=d.useState(null),Te=d.useCallback(()=>{x(null),M(null)},[]);d.useEffect(()=>{const B=()=>{t(et()),r(mt()),l(pn())};return window.addEventListener("focus",B),()=>window.removeEventListener("focus",B)},[]);const me=d.useMemo(()=>o.map(B=>String(B.id)),[o]);d.useEffect(()=>{if(xe){const B=ce===null?me:ce?ce.slice():[];ne(B)}},[xe,ce,me]),d.useEffect(()=>{if(C){const B=w===null?me:w?w.slice():[];K(B)}},[C,w,me]),d.useEffect(()=>{if(!i){a(aa(e)),u("all");return}e.periods.some(fe=>String(fe.id)===String(i))||(a(aa(e)),u("all"))},[e,i]);const Pe=d.useMemo(()=>i?n.filter(B=>(B.periodIds||[]).some(fe=>String(fe)===String(i))).sort((B,fe)=>(B.fullName||"").localeCompare(fe.fullName||"")):[],[n,i]),Le=((Ee=Lu.find(B=>B.id===m))==null?void 0:Ee.label)??"Report";(pe=e.periods.find(B=>String(B.id)===String(i)))!=null&&pe.name,c==="all"||(se=Pe.find(B=>String(B.id)===String(c)))!=null&&se.fullName;const Oe=w===null?"All tags visible":w.length===0?"Tags hidden":`${w.length} tag${w.length===1?"":"s"} selected`,F=B=>{Te();const fe=B.target.value;a(fe||null),u("all")},oe=B=>{Te(),u(B.target.value)},$=B=>{Te(),j(B.target.value)},O=B=>{Te(),N(B.target.value)},y=B=>{Te();const fe=new Date,Ae=new Date;Ae.setDate(fe.getDate()-(B-1)),j(Ou(Ae)),N(Ou(fe))},R=B=>{ne(fe=>fe.includes(B)?fe.filter(Ae=>Ae!==B):[...fe,B])},z=B=>{K(fe=>fe.includes(B)?fe.filter(Ae=>Ae!==B):[...fe,B])},X=B=>{je(B),I(!0)},re=B=>{if(!i){alert("Please select a period before generating a report.");return}const fe=et();t(fe);const Ae=fe.periods.find(Fe=>String(Fe.id)===String(i));if(!Ae){alert("The selected period could not be found.");return}const Ke=mt();r(Ke);const Qe=pn();l(Qe);const Xe=Ke.filter(Fe=>(Fe.periodIds||[]).some(Ie=>String(Ie)===String(i))).sort((Fe,Ie)=>(Fe.fullName||"").localeCompare(Ie.fullName||""));if(Xe.length===0){alert("No students are assigned to this period.");return}const it=sv(Ae,Xe,Qe,typeof B>"u"?w:B);if(!it){alert("Unable to generate the seating chart. Make sure this period has an active grouping and a layout selected.");return}x(it),M({type:"seating",label:Le}),v(Fe=>Fe+1)},ie=B=>{const fe=me.length;let Ae;fe===0?Ae=[]:q.length===0?Ae=[]:q.length===fe?Ae=null:Ae=q.slice(),Te(),b(Ae),I(!1);const Ke=B||le==="generate";je(null),Ke&&re(Ae)},we=()=>{if(!i){alert("Please select a period before generating a report.");return}if(!["roster","seating"].includes(m)){if(!S||!L){alert("Please select both start and end dates.");return}if(S>L){alert("Start date must be on or before the end date.");return}}if(m==="seating"){X("generate");return}const B=et();t(B);const fe=B.periods.find(Fe=>String(Fe.id)===String(i));if(!fe){alert("The selected period could not be found.");return}const Ae=mt();r(Ae);const Ke=pn();l(Ke);const Qe=Ae.filter(Fe=>(Fe.periodIds||[]).some(Ie=>String(Ie)===String(i))).sort((Fe,Ie)=>(Fe.fullName||"").localeCompare(Ie.fullName||"")),Xe=m==="roster"||c==="all"?Qe:Qe.filter(Fe=>String(Fe.id)===String(c));if(Xe.length===0){alert("No students match your selection.");return}let rt=null,it=m;if(m==="attendance"){const Fe=K0(fe,Xe,S,L,G);rt=Y0(Fe)}else if(m==="combined"){const Fe=Em(fe,Xe,S,L);rt=X0(Fe)}else if(m==="behavior"){const Fe=Z0(fe,Xe,S,L);rt=q0(Fe)}else if(m==="points"){if(!fe.pointsEnabled){alert("Points tracking is not enabled for this period. Enable it from Room Setup first.");return}const Fe=ev(fe,Xe,S,L);rt=tv(Fe)}else if(m==="roster"){const Fe=rv(fe,Xe,{sortBy:U,showTags:ae,showPoints:h,showSeatNumbers:_,showNotes:p,tagFilter:ce},Ke);rt=ov(Fe)}else{alert("Only the Attendance, Combined, Seating, Behavior, Points, and Roster reports are available right now.");return}if(!rt){alert("Failed to generate report. Please try again.");return}x(rt),M({type:it,label:Le}),v(Fe=>Fe+1)},ee=()=>{if(!W)return;const B=window.open("","_blank");if(!B){alert("Please allow pop-ups to print this report.");return}B.document.open(),B.document.write(W),B.document.close(),B.focus(),B.print()},ze=W?s.jsx("iframe",{className:"w-full min-h-[520px] rounded-2xl border-0 bg-white shadow-inner",srcDoc:W,title:"Report Preview",sandbox:"allow-same-origin"},f):s.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center text-slate-400 p-8",children:[s.jsx("div",{className:"text-5xl mb-4",role:"img","aria-label":"report placeholder",children:"🖨️"}),s.jsx("p",{className:"text-xl font-semibold text-slate-500",children:"No Report Generated"}),s.jsx("p",{className:"text-sm",children:"Configure options and click Generate Report"})]}),Ce=!!W,ye=D?`Print ${D.label} Report`:"Print Report";return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white border border-indigo-100 rounded-2xl shadow-sm p-6 space-y-5",children:[s.jsxs("div",{className:"grid gap-4 lg:grid-cols-[220px_minmax(0,1fr)_260px]",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Period"}),s.jsx("select",{className:"mt-1 w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm",value:i?String(i):"",onChange:F,children:e.periods.length===0?s.jsx("option",{value:"",children:"No periods available"}):e.periods.map(B=>s.jsx("option",{value:String(B.id),children:B.name},String(B.id)))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Report Type"}),s.jsx("div",{className:"mt-1 space-y-2",children:H0.map((B,fe)=>s.jsx("div",{className:"flex flex-wrap gap-2",children:B.map(Ae=>{const Ke=Lu.find(rt=>rt.id===Ae);if(!Ke)return null;const Qe=Ke.id===m,Xe=!!Ke.disabled;return s.jsxs("button",{type:"button",className:"flex items-center gap-2 rounded-xl border px-3 py-2 text-sm transition-all "+(Qe?"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":"border-slate-200 bg-white text-slate-600 hover:border-indigo-200")+(Xe?" opacity-50 pointer-events-none":""),onClick:()=>{Te(),E(Ke.id)},children:[s.jsx("span",{className:"text-lg","aria-hidden":!0,children:Ke.icon}),s.jsxs("div",{className:"flex flex-col leading-tight text-left",children:[s.jsx("span",{className:"font-semibold",children:Ke.label}),s.jsx("span",{className:"text-[11px] text-slate-500",children:Ke.description})]})]},Ke.id)})},fe))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Date Range"}),s.jsxs("div",{className:"mt-1 grid grid-cols-1 gap-2 sm:grid-cols-2",children:[s.jsx("input",{type:"date",className:"rounded-lg border border-slate-200 px-3 py-2 text-sm",value:S,onChange:$}),s.jsx("input",{type:"date",className:"rounded-lg border border-slate-200 px-3 py-2 text-sm",value:L,onChange:O})]})]})]}),s.jsxs("div",{className:"grid gap-4 lg:grid-cols-[220px_minmax(0,1fr)_360px]",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Student"}),s.jsxs("select",{className:"mt-1 w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm",value:c,onChange:oe,disabled:Pe.length===0,children:[s.jsx("option",{value:"all",children:"All Students"}),Pe.map(B=>s.jsx("option",{value:String(B.id),children:B.fullName},String(B.id)))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Quick Dates"}),s.jsx("div",{className:"mt-1 flex flex-wrap gap-2",children:U0.map(B=>s.jsx("button",{type:"button",className:"rounded-xl border border-slate-200 bg-slate-50 px-4 py-2 text-sm font-semibold text-slate-600 hover:bg-slate-100",onClick:()=>y(B.days),children:B.label},B.label))})]}),s.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[m==="attendance"&&s.jsxs("div",{className:"flex-1 min-w-[220px]",children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Attendance Detail"}),s.jsx("div",{className:"mt-1 inline-flex rounded-xl border border-slate-200 bg-slate-50 p-1",children:["summary","detailed"].map(B=>s.jsx("button",{type:"button",className:"flex-1 rounded-lg px-3 py-2 text-sm font-semibold transition "+(G===B?"bg-white text-indigo-700 shadow":"text-slate-500 hover:text-slate-700"),onClick:()=>{G!==B&&(Te(),J(B))},children:B==="summary"?"Summary":"Detailed"},B))})]}),s.jsxs("div",{className:"flex min-w-[280px] flex-1 gap-3",children:[s.jsx("button",{type:"button",className:"flex-1 rounded-xl bg-gradient-to-r from-indigo-500 to-purple-500 px-4 py-3 text-base font-semibold text-white shadow-lg shadow-indigo-200 transition hover:brightness-110 focus:outline-none focus:ring-2 focus:ring-indigo-300",onClick:we,children:s.jsxs("span",{className:"inline-flex items-center justify-center gap-2",children:[s.jsx("span",{role:"img","aria-label":"generate report",children:"📊"}),"Generate Report"]})}),s.jsx("button",{type:"button",disabled:!Ce,className:"rounded-xl border px-4 py-3 text-base font-semibold transition "+(Ce?"border-indigo-200 bg-white text-indigo-700 hover:bg-indigo-50":"border-slate-200 bg-slate-100 text-slate-400 cursor-not-allowed"),onClick:ee,children:ye})]})]})]}),m==="roster"&&s.jsx("div",{className:"mt-4 space-y-4 border-t border-slate-200 pt-4",children:s.jsxs("div",{className:"grid gap-4 lg:grid-cols-[220px_minmax(0,1fr)_260px]",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Sort By"}),s.jsxs("select",{className:"mt-1 w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm",value:U,onChange:B=>{Te();const fe=B.target.value;te(fe)},children:[s.jsx("option",{value:"lastName",children:"Last Name"}),s.jsx("option",{value:"firstName",children:"First Name"}),s.jsx("option",{value:"seatNumber",children:"Seat Number"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Options"}),s.jsxs("div",{className:"mt-2 grid gap-2 md:grid-cols-3 text-sm",children:[s.jsxs("label",{className:"inline-flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:ae,onChange:B=>{Te(),Y(B.target.checked),$e(null)}}),"Tags"]}),ae&&s.jsx("button",{type:"button",disabled:o.length===0,className:`inline-flex items-center justify-center rounded border px-2 py-1 text-xs ${o.length===0?"border-slate-200 text-slate-300 cursor-not-allowed":"border-slate-300 text-slate-600 hover:bg-slate-100"}`,onClick:()=>{o.length!==0&&H(!0)},children:"Select Tags"}),s.jsxs("label",{className:"inline-flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:h,onChange:B=>{Te(),k(B.target.checked)}}),"Points"]}),s.jsxs("label",{className:"inline-flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:_,onChange:B=>{Te(),A(B.target.checked)}}),"Seat #"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Notes Column"}),s.jsx("div",{className:"mt-1",children:s.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[s.jsx("input",{type:"checkbox",checked:p,onChange:B=>{Te(),P(B.target.checked)}}),"Include notes column"]})})]})]})}),m==="seating"&&s.jsxs("div",{className:"mt-4 space-y-3 border-t border-slate-200 pt-4",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Tag Visibility"}),s.jsx("p",{className:"text-sm font-semibold text-slate-700",children:Oe})]}),s.jsx("button",{type:"button",className:"rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-600 hover:border-indigo-200 hover:text-indigo-700",onClick:()=>X("manual"),children:"Select Tags"})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Pick which student tags appear as emoji chips on the seating chart preview and printout."})]})]}),s.jsx("div",{className:"bg-white border border-purple-100 rounded-2xl shadow-inner min-h-[280px]",children:ze}),xe&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:s.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-xl",children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Select Tags for Roster"}),s.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Choose which tags to display. Leave all selected to show every tag."}),s.jsxs("div",{className:"mt-4 flex gap-2 text-sm",children:[s.jsx("button",{type:"button",className:"rounded border border-slate-300 px-3 py-1 text-slate-600 hover:bg-slate-50",onClick:()=>ne(me),children:"Select All"}),s.jsx("button",{type:"button",className:"rounded border border-slate-300 px-3 py-1 text-slate-600 hover:bg-slate-50",onClick:()=>ne([]),children:"Clear"})]}),s.jsx("div",{className:"mt-4 max-h-64 overflow-y-auto rounded border border-slate-200 p-3",children:o.length===0?s.jsx("p",{className:"text-sm text-slate-500",children:"No tags available."}):o.map(B=>{const fe=String(B.id),Ae=ge.includes(fe);return s.jsxs("label",{className:"flex items-center gap-2 py-1 text-sm text-slate-700",children:[s.jsx("input",{type:"checkbox",checked:Ae,onChange:()=>R(fe)}),s.jsx("span",{children:B.name})]},fe)})}),s.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[s.jsx("button",{type:"button",className:"rounded border border-slate-300 px-4 py-2 text-sm text-slate-600 hover:bg-slate-50",onClick:()=>H(!1),children:"Cancel"}),s.jsx("button",{type:"button",className:"rounded bg-indigo-600 px-4 py-2 text-sm font-semibold text-white hover:bg-indigo-500",onClick:()=>{const B=me.length;let fe;B?ge.length===0?fe=[]:ge.length===B?fe=null:fe=ge.slice():fe=[],Te(),$e(fe),H(!1)},children:"Apply"})]})]})}),C&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:s.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-xl",children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Seating Chart Tags"}),s.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Choose which tags render as colored emoji chips on the seating chart."}),s.jsxs("div",{className:"mt-4 flex gap-2 text-sm",children:[s.jsx("button",{type:"button",className:"rounded border border-slate-300 px-3 py-1 text-slate-600 hover:bg-slate-50",onClick:()=>K(me),children:"Select All"}),s.jsx("button",{type:"button",className:"rounded border border-slate-300 px-3 py-1 text-slate-600 hover:bg-slate-50",onClick:()=>K([]),children:"Clear"})]}),s.jsx("div",{className:"mt-4 max-h-64 overflow-y-auto rounded border border-slate-200 p-3",children:o.length===0?s.jsx("p",{className:"text-sm text-slate-500",children:"No tags available. Students will appear without chips."}):o.map(B=>{const fe=String(B.id),Ae=q.includes(fe);return s.jsxs("label",{className:"flex items-center gap-3 py-1 text-sm text-slate-700",children:[s.jsx("input",{type:"checkbox",checked:Ae,onChange:()=>z(fe)}),s.jsxs("span",{className:"inline-flex items-center gap-2",children:[B.icon&&s.jsx("span",{children:B.icon}),s.jsx("span",{children:B.name})]})]},fe)})}),s.jsxs("div",{className:"mt-6 flex flex-wrap justify-end gap-2",children:[s.jsx("button",{type:"button",className:"rounded border border-slate-300 px-4 py-2 text-sm text-slate-600 hover:bg-slate-50",onClick:()=>{I(!1),je(null)},children:"Cancel"}),s.jsx("button",{type:"button",className:"rounded border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>ie(!1),children:"Save Selection"}),s.jsx("button",{type:"button",className:"rounded bg-indigo-600 px-4 py-2 text-sm font-semibold text-white hover:bg-indigo-500",onClick:()=>ie(!0),children:le==="generate"?"Generate Report":"Apply & Generate"})]})]})})]})}function km(e,t,n,r){const l=P0(e,t.id).filter(a=>a.date>=n&&a.date<=r).sort((a,c)=>a.date.localeCompare(c.date)),i={total:l.length,present:l.filter(a=>a.status==="present").length,absent:l.filter(a=>a.status==="absent").length,tardy:l.filter(a=>a.status==="tardy").length,leftEarly:l.filter(a=>a.status==="left_early").length,presentPercentage:l.length?Math.round(l.filter(a=>a.status==="present").length/l.length*100):0};return{id:t.id,name:t.fullName||"Unnamed Student",gender:t.gender,stats:i,records:l}}function K0(e,t,n,r,o){const l=t.map(i=>km(e,i,n,r));return{periodName:e.name||"Class Period",startDate:n,endDate:r,generatedAt:new Date().toLocaleString(),studentsCount:l.length,detailLevel:o,students:l}}function Y0(e){const t=`
    :root {
      font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      color: #0f172a;
      background: #eef2ff;
    }
    body {
      margin: 0;
      background: #f4f6fb;
      padding: 40px;
      color: #0f172a;
    }
    .report-shell {
      max-width: 920px;
      margin: 0 auto;
      background: #fff;
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(79, 70, 229, 0.1);
      padding: 40px;
    }
    .report-header {
      border-bottom: 1px solid rgba(99, 102, 241, 0.2);
      padding-bottom: 24px;
      margin-bottom: 32px;
    }
    .eyebrow {
      text-transform: uppercase;
      letter-spacing: 0.2em;
      font-size: 12px;
      color: #6366f1;
      font-weight: 600;
    }
    .report-title {
      font-size: 32px;
      margin: 8px 0 4px;
      font-weight: 800;
    }
    .meta-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 12px;
      margin-top: 16px;
    }
    .meta-card {
      border: 1px solid rgba(15, 23, 42, 0.08);
      border-radius: 16px;
      padding: 12px 16px;
      background: #f8fafc;
    }
    .meta-label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #64748b;
      font-weight: 600;
    }
    .meta-value {
      font-size: 16px;
      font-weight: 600;
      margin-top: 4px;
    }
    .student-card {
      border: 1px solid rgba(148, 163, 184, 0.3);
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 20px;
      background: #fff;
      box-shadow: 0 8px 30px rgba(15, 23, 42, 0.04);
      page-break-inside: avoid;
      break-inside: avoid;
    }
    .student-header {
      display: flex;
      justify-content: space-between;
      gap: 16px;
      align-items: flex-start;
      margin-bottom: 16px;
    }
    .student-name {
      font-size: 22px;
      font-weight: 700;
      color: #0f172a;
    }
    .student-meta {
      font-size: 14px;
      color: #64748b;
    }
    .presence-badge {
      min-width: 120px;
      border-radius: 16px;
      background: linear-gradient(135deg, #e0e7ff, #f5f3ff);
      padding: 12px;
      text-align: center;
      border: 1px solid rgba(99, 102, 241, 0.2);
    }
    .presence-badge .percentage {
      font-size: 28px;
      font-weight: 800;
      color: #4c1d95;
      line-height: 1;
    }
    .presence-badge .label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: #4c1d95;
      margin-top: 4px;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
      margin-bottom: 20px;
    }
    .stat-box {
      border-radius: 16px;
      padding: 12px;
      text-align: center;
      border: 1px solid rgba(226, 232, 240, 0.9);
    }
    .stat-label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #475569;
    }
    .stat-value {
      font-size: 22px;
      font-weight: 700;
    }
    .stat-present { background: #ecfdf5; border-color: #bbf7d0; color: #047857; }
    .stat-absent { background: #fef2f2; border-color: #fecaca; color: #b91c1c; }
    .stat-tardy { background: #fffbeb; border-color: #fde68a; color: #b45309; }
    .stat-left-early { background: #fff7ed; border-color: #fed7aa; color: #b45309; }
    .status-panels {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin: 6px 0 8px;
    }
    .status-card {
      border-radius: 14px;
      border: 1px solid rgba(226, 232, 240, 0.9);
      padding: 12px 14px;
      min-width: 220px;
      background: #f8fafc;
    }
    .status-label {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-weight: 700;
      margin-bottom: 6px;
    }
    .status-dates {
      font-size: 13px;
      color: #1f2937;
      line-height: 1.4;
      word-break: break-word;
    }
    .status-absent { background: #fef2f2; border-color: #fecaca; color: #b91c1c; }
    .status-tardy { background: #fffbeb; border-color: #fde68a; color: #b45309; }
    .status-left_early { background: #fff7ed; border-color: #fed7aa; color: #b45309; }
    .records-section {
      border-top: 1px solid rgba(226, 232, 240, 0.9);
      padding-top: 16px;
    }
    .records-table th:first-child {
      width: 200px;
    }
    .summary-note {
      font-size: 13px;
      color: #475569;
      border: 1px dashed rgba(148, 163, 184, 0.7);
      border-radius: 12px;
      padding: 16px;
      background: #f8fafc;
    }
    .records-title {
      font-size: 14px;
      font-weight: 700;
      color: #0f172a;
      margin-bottom: 8px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 4px;
    }
    th, td {
      padding: 10px 12px;
      text-align: left;
      font-size: 14px;
      border-bottom: 1px solid rgba(226, 232, 240, 0.9);
    }
    th {
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-size: 12px;
      color: #475569;
      background: #f8fafc;
    }
    .status-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border-radius: 999px;
      padding: 4px 10px;
      font-weight: 600;
      font-size: 13px;
    }
    .status-present { background: #d1fae5; color: #047857; }
    .status-absent { background: #fee2e2; color: #b91c1c; }
    .status-tardy { background: #fef3c7; color: #b45309; }
    .status-left_early { background: #ffe4e6; color: #be185d; }
    .no-records {
      padding: 16px;
      border: 1px dashed #cbd5f5;
      border-radius: 12px;
      background: #f8fafc;
      color: #64748b;
      text-align: center;
      font-size: 14px;
    }
    .status-cell {
      display: flex;
      flex-direction: column;
      gap: 6px;
      align-items: flex-start;
    }
    .status-count {
      font-size: 13px;
      color: #475569;
      font-weight: 600;
    }
    .date-list {
      font-size: 13px;
      color: #334155;
      line-height: 1.5;
      white-space: normal;
    }
  `,n=e.students.map(o=>{const l=[{label:"Present",value:o.stats.present,className:"stat-box stat-present"},{label:"Absent",value:o.stats.absent,className:"stat-box stat-absent"},{label:"Tardy",value:o.stats.tardy,className:"stat-box stat-tardy"},{label:"Left Early",value:o.stats.leftEarly,className:"stat-box stat-left-early"}].map(c=>`<div class="${c.className}">
              <div class="stat-label">${c.label}</div>
              <div class="stat-value">${c.value}</div>
            </div>`).join(""),i=e.detailLevel==="detailed"?J0(o.records):"",a=Cm(o.records);return`
        <section class="student-card">
          <div class="student-header">
            <div>
              <div class="student-name">${st(o.name)}</div>
            </div>
            <div class="presence-badge">
              <div class="percentage">${o.stats.presentPercentage}%</div>
              <div class="label">Present</div>
            </div>
          </div>
          <div class="stats-grid">
            ${l}
          </div>
          ${a?`<div class="status-panels">
                  ${a}
                </div>`:""}
          ${e.detailLevel==="detailed"?`<div class="records-section">
                  <div class="records-title">Attendance Records</div>
                  <table class="records-table">
                    <thead>
                      <tr>
                        <th>Status</th>
                        <th>Dates</th>
                      </tr>
                    </thead>
                    <tbody>
                      ${i}
                    </tbody>
                  </table>
                </div>`:""}
        </section>
      `}).join(""),r=e.students.length===0?'<div class="no-records">No students were available for this report range.</div>':"";return`
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charSet="utf-8" />
        <title>Attendance Report · ${st(e.periodName)}</title>
        <style>${t}</style>
      </head>
      <body>
        <div class="report-shell">
          <header class="report-header">
            <div class="eyebrow">ClassSeats Reports</div>
            <div class="report-title">Attendance Report</div>
            ${e.detailLevel==="summary"?'<div class="summary-note">Detailed attendance breakdown hidden. Switch to Detailed mode to show date lists and individual entries.</div>':""}
            <div class="meta-grid">
              <div class="meta-card">
                <div class="meta-label">Period</div>
                <div class="meta-value">${st(e.periodName)}</div>
              </div>
              <div class="meta-card">
                <div class="meta-label">Students</div>
                <div class="meta-value">${e.studentsCount}</div>
              </div>
              <div class="meta-card">
                <div class="meta-label">Date Range</div>
                <div class="meta-value">${Ct(e.startDate)} – ${Ct(e.endDate)}</div>
              </div>
              <div class="meta-card">
                <div class="meta-label">Generated</div>
                <div class="meta-value">${st(e.generatedAt)}</div>
              </div>
            </div>
          </header>
          ${n||r}
        </div>
      </body>
    </html>
  `}function Q0(e){switch(e){case"present":return{label:"Present",className:"status-present",icon:"✅"};case"absent":return{label:"Absent",className:"status-absent",icon:"❌"};case"tardy":return{label:"Tardy",className:"status-tardy",icon:"⏰"};case"left_early":return{label:"Left Early",className:"status-left_early",icon:"🏃"};default:return{label:"Unmarked",className:"status-present",icon:"▫️"}}}function st(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function J0(e){return["present","absent","tardy","left_early"].map(n=>{const r=Q0(n),o=e.filter(i=>i.status===n).map(i=>Ct(i.date)),l=o.length?o.join(", "):"No entries";return`<tr>
        <td>
          <div class="status-cell">
            <span class="status-pill ${r.className}">${r.icon} ${r.label}</span>
            <span class="status-count">${o.length} ${o.length===1?"day":"days"}</span>
          </div>
        </td>
        <td><div class="date-list">${l}</div></td>
      </tr>`}).join("")}function Cm(e){return[{key:"absent",label:"Absent",className:"status-absent"},{key:"tardy",label:"Tardy",className:"status-tardy"},{key:"left_early",label:"Left Early",className:"status-left_early"}].map(({key:n,label:r,className:o})=>{const l=e.filter(i=>i.status===n).map(i=>Ct(i.date));return l.length?`<div class="status-card ${o}">
        <div class="status-label">${r}</div>
        <div class="status-dates">${l.join(", ")}</div>
      </div>`:""}).filter(Boolean).join("")}function Em(e,t,n,r){const o=t.map(l=>{const i=km(e,l,n,r),a=Nm(e,l.id,n,r),c=!!e.pointsEnabled,u=c?Ko(e,l.id):null,m=c?Yo(e,l.id,n,r):[],E=u!=null?Qs(u):null,S=a&&a.length?{totalNotes:a.length,notes:a.map(j=>({date:j.date,timestamp:j.timestamp,note:j.note})),pointsEnabled:c,currentPoints:u,pointHistory:m,tier:E}:{totalNotes:0,notes:[],pointsEnabled:c,currentPoints:u,pointHistory:m,tier:E};return{id:l.id,name:l.fullName||"Unnamed Student",attendance:i,behavior:S}});return{periodName:e.name||"Class Period",startDate:n,endDate:r,generatedAt:new Date().toLocaleString(),studentsCount:o.length,students:o}}function X0(e){const t=`
    :root {
      font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      color: #0f172a;
      background: #eef2ff;
    }
    body {
      margin: 0;
      background: #f4f6fb;
      padding: 40px;
      color: #0f172a;
    }
    .report-shell {
      max-width: 1024px;
      margin: 0 auto;
      background: #fff;
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(79, 70, 229, 0.15);
      padding: 40px;
    }
    .report-header {
      border-bottom: 1px solid rgba(99, 102, 241, 0.2);
      padding-bottom: 24px;
      margin-bottom: 32px;
    }
    .eyebrow {
      text-transform: uppercase;
      letter-spacing: 0.2em;
      font-size: 12px;
      color: #6366f1;
      font-weight: 600;
    }
    .report-title {
      font-size: 32px;
      margin: 8px 0 4px;
      font-weight: 800;
    }
    .meta-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 12px;
      margin-top: 16px;
    }
    .meta-card {
      border: 1px solid rgba(15, 23, 42, 0.08);
      border-radius: 16px;
      padding: 12px 16px;
      background: #f8fafc;
    }
    .meta-label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #64748b;
      font-weight: 600;
    }
    .meta-value {
      font-size: 16px;
      font-weight: 600;
      margin-top: 4px;
    }
    .student-card {
      border: 1px solid rgba(148, 163, 184, 0.3);
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 24px;
      background: #fff;
      box-shadow: 0 8px 30px rgba(15, 23, 42, 0.04);
      page-break-inside: avoid;
      break-inside: avoid;
    }
    .student-header {
      display: flex;
      justify-content: space-between;
      gap: 16px;
      align-items: center;
      margin-bottom: 16px;
    }
    .student-name {
      font-size: 22px;
      font-weight: 700;
      color: #0f172a;
    }
    .attendance-section,
    .behavior-section {
      border: 1px solid rgba(226, 232, 240, 0.9);
      border-radius: 16px;
      padding: 20px;
      margin-top: 12px;
    }
    .section-heading {
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .section-heading .badge {
      font-size: 26px;
    }
    .attendance-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
    }
    .attendance-stats .stat {
      border-radius: 14px;
      padding: 12px;
      text-align: center;
      border: 1px solid rgba(226, 232, 240, 0.9);
    }
    .stat-label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #475569;
    }
    .stat-value {
      font-size: 22px;
      font-weight: 700;
    }
    .behavior-note {
      border-radius: 12px;
      border: 1px solid rgba(216, 180, 254, 0.6);
      background: #faf5ff;
      padding: 12px;
      margin-bottom: 10px;
    }
    .note-meta {
      font-size: 12px;
      font-weight: 600;
      color: #6b21a8;
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 6px;
    }
    .note-text {
      font-size: 14px;
      color: #1f2937;
      line-height: 1.4;
    }
    .behavior-empty {
      font-size: 13px;
      color: #6b7280;
      font-style: italic;
    }
    .points-section {
      border: 1px solid rgba(16, 185, 129, 0.25);
      background: #ecfdf3;
      border-radius: 16px;
      padding: 12px 14px;
      margin-top: 10px;
    }
    .points-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      font-size: 13px;
    }
    .points-table th {
      text-align: left;
      padding: 6px 8px;
      background: #d1fae5;
      color: #065f46;
    }
    .points-table td {
      padding: 6px 8px;
      border-top: 1px solid #e5e7eb;
    }
    .points-table td.delta {
      text-align: center;
      font-weight: 700;
    }
    .status-panels {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin: 8px 0 4px;
    }
    .status-card {
      border-radius: 14px;
      border: 1px solid rgba(226, 232, 240, 0.9);
      padding: 12px 14px;
      min-width: 220px;
      background: #f8fafc;
    }
    .status-label {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-weight: 700;
      margin-bottom: 6px;
    }
    .status-dates {
      font-size: 13px;
      color: #1f2937;
      line-height: 1.4;
      word-break: break-word;
    }
    .status-absent { background: #fef2f2; border-color: #fecaca; color: #b91c1c; }
    .status-tardy { background: #fffbeb; border-color: #fde68a; color: #b45309; }
    .status-left_early { background: #fff7ed; border-color: #fed7aa; color: #b45309; }
  `,n=e.students.map(o=>{var E;const l=o.attendance,i=o.behavior,a=l?Cm(l.records):"",c=l?`<div class="attendance-section">
            <div class="section-heading">
              <span class="badge">📅</span>
              <span>Attendance</span>
              <span style="margin-left:auto;font-size:24px;font-weight:800;color:#4c1d95;">
                ${l.stats.presentPercentage}%
              </span>
            </div>
            <div class="attendance-stats">
              <div class="stat" style="background:#ecfdf5;border-color:#bbf7d0;color:#047857;">
                <div class="stat-value">${l.stats.present}</div>
                <div class="stat-label">Present</div>
              </div>
              <div class="stat" style="background:#fef2f2;border-color:#fecaca;color:#b91c1c;">
                <div class="stat-value">${l.stats.absent}</div>
                <div class="stat-label">Absent</div>
              </div>
              <div class="stat" style="background:#fffbeb;border-color:#fde68a;color:#b45309;">
                <div class="stat-value">${l.stats.tardy}</div>
                <div class="stat-label">Tardy</div>
              </div>
              <div class="stat" style="background:#fff7ed;border-color:#fed7aa;color:#b45309;">
                <div class="stat-value">${l.stats.leftEarly}</div>
                <div class="stat-label">Left Early</div>
              </div>
              <div class="stat" style="background:#f8fafc;border-color:#e2e8f0;color:#0f172a;">
                <div class="stat-value">${l.stats.total}</div>
                <div class="stat-label">Total Days</div>
              </div>
            </div>
            ${a?`<div class="status-panels">
                    ${a}
                  </div>`:""}
          </div>`:"",u=i!=null&&i.pointsEnabled&&((E=i.pointHistory)!=null&&E.length||i.currentPoints!==null)?`<div class="points-section">
              <div class="section-heading">
                <span class="badge">⭐</span>
                <span>Points</span>
                ${i.currentPoints!==null&&i.currentPoints!==void 0&&i.tier?`<span style="margin-left:auto;font-weight:700;color:#047857;">
                        ${i.currentPoints} · ${i.tier.label}
                      </span>`:""}
              </div>
              ${i.pointHistory&&i.pointHistory.length?`<table class="points-table">
                      <thead>
                        <tr><th>Date</th><th>Change</th><th>Reason</th></tr>
                      </thead>
                      <tbody>
                        ${i.pointHistory.map(S=>`<tr>
                              <td>${Ct(S.date)}</td>
                              <td class="delta" style="color:${S.delta>=0?"#047857":"#b91c1c"};">
                                ${S.delta>0?"+":""}${S.delta}
                              </td>
                              <td>${st(S.reason||"")}</td>
                            </tr>`).join("")}
                      </tbody>
                    </table>`:'<div class="behavior-empty">No point changes in this range.</div>'}
            </div>`:"",m=i?`<div class="behavior-section">
            <div class="section-heading">
              <span class="badge">📝</span>
              <span>Behavior Notes</span>
              <span style="margin-left:auto;font-weight:700;color:#6b21a8;">${i.totalNotes} note${i.totalNotes===1?"":"s"}</span>
            </div>
            ${i.notes.length?i.notes.map(S=>{const j=id(S.timestamp);return`<div class="behavior-note">
                        <div class="note-meta">
                          <span>${Ct(S.date)}</span>
                          ${j?`<span>${j}</span>`:""}
                        </div>
                        <div class="note-text">${st(S.note||"")}</div>
                      </div>`}).join(""):'<div class="behavior-empty">No behavior notes recorded in this date range.</div>'}
            ${u}
          </div>`:"";return`
        <section class="student-card">
          <div class="student-header">
            <div class="student-name">${st(o.name)}</div>
          </div>
          ${c}
          ${m}
        </section>
      `}).join(""),r=e.students.length===0?'<div class="behavior-empty">No students were available for this report.</div>':"";return`
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charSet="utf-8" />
        <title>Combined Report · ${st(e.periodName)}</title>
        <style>${t}</style>
      </head>
      <body>
        <div class="report-shell">
          <header class="report-header">
            <div class="eyebrow">ClassSeats Reports</div>
            <div class="report-title">Attendance + Behavior Report</div>
            <div class="meta-grid">
              <div class="meta-card">
                <div class="meta-label">Period</div>
                <div class="meta-value">${st(e.periodName)}</div>
              </div>
              <div class="meta-card">
                <div class="meta-label">Students</div>
                <div class="meta-value">${e.studentsCount}</div>
              </div>
              <div class="meta-card">
                <div class="meta-label">Date Range</div>
                <div class="meta-value">${Ct(e.startDate)} – ${Ct(e.endDate)}</div>
              </div>
              <div class="meta-card">
                <div class="meta-label">Generated</div>
                <div class="meta-value">${st(e.generatedAt)}</div>
              </div>
            </div>
          </header>
          ${n||r}
        </div>
      </body>
    </html>
  `}function id(e){if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})}function Z0(e,t,n,r){return Em(e,t,n,r)}function q0(e){const t=`
    :root {
      font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      color: #0f172a;
      background: #fdf4ff;
    }
    body {
      margin: 0;
      background: #f8fafc;
      padding: 40px;
      color: #0f172a;
    }
    .report-shell {
      max-width: 900px;
      margin: 0 auto;
      background: #fff;
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(99, 102, 241, 0.15);
      padding: 40px;
    }
    .report-header {
      border-bottom: 1px solid rgba(129, 140, 248, 0.4);
      padding-bottom: 24px;
      margin-bottom: 32px;
    }
    .eyebrow {
      text-transform: uppercase;
      letter-spacing: 0.2em;
      font-size: 12px;
      color: #6366f1;
      font-weight: 600;
    }
    .report-title {
      font-size: 32px;
      margin: 8px 0 4px;
      font-weight: 800;
    }
    .meta-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 12px;
      margin-top: 16px;
    }
    .meta-card {
      border: 1px solid rgba(99, 102, 241, 0.2);
      border-radius: 16px;
      padding: 12px 16px;
      background: #eef2ff;
    }
    .meta-label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #4338ca;
      font-weight: 600;
    }
    .meta-value {
      font-size: 16px;
      font-weight: 600;
      margin-top: 4px;
    }
    .student-card {
      border: 1px solid rgba(129, 140, 248, 0.35);
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 24px;
      background: #fff;
      box-shadow: 0 8px 30px rgba(79, 70, 229, 0.15);
      page-break-inside: avoid;
      break-inside: avoid;
    }
    .student-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
      margin-bottom: 12px;
    }
    .student-name {
      font-size: 22px;
      font-weight: 700;
      color: #312e81;
    }
    .note-count {
      font-size: 14px;
      color: #4338ca;
      font-weight: 700;
      background: #eef2ff;
      border-radius: 999px;
      padding: 6px 14px;
      border: 1px solid rgba(99, 102, 241, 0.35);
    }
    .behavior-note {
      border-radius: 16px;
      border: 1px solid rgba(129, 140, 248, 0.4);
      background: #f5f3ff;
      padding: 14px;
      margin-bottom: 12px;
    }
    .note-meta {
      font-size: 12px;
      font-weight: 700;
      color: #4c1d95;
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 6px;
    }
    .note-text {
      font-size: 14px;
      color: #111827;
      line-height: 1.5;
    }
    .behavior-empty {
      font-size: 13px;
      color: #4c1d95;
      font-style: italic;
    }
    .points-section {
      border: 1px solid rgba(16, 185, 129, 0.25);
      background: #ecfdf3;
      border-radius: 16px;
      padding: 12px 14px;
      margin-top: 10px;
    }
    .points-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      font-size: 13px;
    }
    .points-table th {
      text-align: left;
      padding: 6px 8px;
      background: #d1fae5;
      color: #065f46;
    }
    .points-table td {
      padding: 6px 8px;
      border-top: 1px solid #e5e7eb;
    }
    .points-table td.delta {
      text-align: center;
      font-weight: 700;
    }
  `,n=e.students.map(o=>{var c;const l=o.behavior;if(!l)return"";const i=l.pointsEnabled&&((c=l.pointHistory)!=null&&c.length||l.currentPoints!==null)?`<div class="points-section">
              <div class="section-heading" style="display:flex;align-items:center;gap:8px;font-weight:700;">
                <span>Points</span>
                ${l.currentPoints!==null&&l.currentPoints!==void 0&&l.tier?`<span style="margin-left:auto;font-weight:700;color:#047857;">
                        ${l.currentPoints} · ${l.tier.label}
                      </span>`:""}
              </div>
              ${l.pointHistory&&l.pointHistory.length?`<table class="points-table">
                      <thead>
                        <tr><th>Date</th><th>Change</th><th>Reason</th></tr>
                      </thead>
                      <tbody>
                        ${l.pointHistory.map(u=>`<tr>
                              <td>${Ct(u.date)}</td>
                              <td class="delta" style="color:${u.delta>=0?"#047857":"#b91c1c"};">
                                ${u.delta>0?"+":""}${u.delta}
                              </td>
                              <td>${st(u.reason||"")}</td>
                            </tr>`).join("")}
                      </tbody>
                    </table>`:'<div class="behavior-empty">No point changes recorded in this date range.</div>'}
            </div>`:"",a=l.notes.length===0?'<div class="behavior-empty">No behavior notes recorded in this date range.</div>':l.notes.map(u=>{const m=id(u.timestamp);return`<div class="behavior-note">
                    <div class="note-meta">
                      <span>${Ct(u.date)}</span>
                      ${m?`<span>${m}</span>`:""}
                    </div>
                    <div class="note-text">${st(u.note||"")}</div>
                  </div>`}).join("");return`
        <section class="student-card">
          <div class="student-header">
            <div class="student-name">${st(o.name)}</div>
            <div class="note-count">${l.totalNotes} note${l.totalNotes===1?"":"s"}</div>
          </div>
          ${a}
          ${i}
        </section>
      `}).join(""),r=e.students.length===0?'<div class="behavior-empty">No students were available for this report.</div>':"";return`
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charSet="utf-8" />
        <title>Behavior Report · ${st(e.periodName)}</title>
        <style>${t}</style>
      </head>
      <body>
        <div class="report-shell">
          <header class="report-header">
            <div class="eyebrow">ClassSeats Reports</div>
            <div class="report-title">Behavior Report</div>
            <div class="meta-grid">
              <div class="meta-card">
                <div class="meta-label">Period</div>
                <div class="meta-value">${st(e.periodName)}</div>
              </div>
              <div class="meta-card">
                <div class="meta-label">Students</div>
                <div class="meta-value">${e.studentsCount}</div>
              </div>
              <div class="meta-card">
                <div class="meta-label">Date Range</div>
                <div class="meta-value">${Ct(e.startDate)} – ${Ct(e.endDate)}</div>
              </div>
              <div class="meta-card">
                <div class="meta-label">Generated</div>
                <div class="meta-value">${st(e.generatedAt)}</div>
              </div>
            </div>
          </header>
          ${n||r}
        </div>
      </body>
    </html>
  `}function ev(e,t,n,r){const o=t.map(l=>{const i=Ko(e,l.id),a=Yo(e,l.id,n,r),c=Qs(i),u=Nm(e,l.id,n,r);return{id:l.id,name:l.fullName||"Unnamed Student",currentPoints:i,tier:c,history:a,behavior:{totalNotes:u.length,notes:u.map(m=>({date:m.date,timestamp:m.timestamp,note:m.note}))}}});return{periodName:e.name||"Class Period",startDate:n,endDate:r,generatedAt:new Date().toLocaleString(),studentsCount:o.length,students:o}}function tv(e){const t=`
    :root {
      font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      color: #0f172a;
      background: #f5f3ff;
    }
    body {
      margin: 0;
      background: #f8fafc;
      padding: 40px;
    }
    .report-shell {
      max-width: 1024px;
      margin: 0 auto;
      background: #fff;
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(109, 40, 217, 0.25);
      padding: 40px;
    }
    .report-header {
      border-bottom: 1px solid rgba(129, 140, 248, 0.4);
      padding-bottom: 24px;
      margin-bottom: 32px;
    }
    .eyebrow {
      text-transform: uppercase;
      letter-spacing: 0.2em;
      font-size: 12px;
      color: #818cf8;
      font-weight: 600;
    }
    .report-title {
      font-size: 32px;
      margin: 8px 0 4px;
      font-weight: 800;
    }
    .meta-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 12px;
      margin-top: 16px;
    }
    .meta-card {
      border: 1px solid rgba(99, 102, 241, 0.2);
      border-radius: 16px;
      padding: 12px 16px;
      background: #eef2ff;
    }
    .meta-label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #4338ca;
      font-weight: 600;
    }
    .meta-value {
      font-size: 16px;
      font-weight: 600;
      margin-top: 4px;
    }
    .student-card {
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 24px;
      background: #fff;
      box-shadow: 0 8px 30px rgba(99, 102, 241, 0.15);
      border: 1px solid rgba(165, 180, 252, 0.6);
      page-break-inside: avoid;
      break-inside: avoid;
    }
    .student-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      gap: 16px;
    }
    .student-name {
      font-size: 22px;
      font-weight: 700;
      color: #312e81;
    }
    .points-badge {
      min-width: 160px;
      padding: 12px 16px;
      border-radius: 16px;
      text-align: right;
      border: 2px solid;
      background: linear-gradient(135deg, rgba(199, 210, 254, 0.6), rgba(165, 180, 252, 0.4));
    }
    .points-value {
      font-size: 36px;
      font-weight: 800;
      line-height: 1;
    }
    .points-label {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }
    .history-section {
      border-top: 1px solid rgba(229, 231, 235, 0.9);
      margin-top: 16px;
      padding-top: 16px;
    }
    .history-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
    }
    .history-table th,
    .history-table td {
      padding: 10px;
      border-bottom: 1px solid rgba(229, 231, 235, 0.8);
      font-size: 14px;
      text-align: left;
    }
    .history-table th {
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-size: 12px;
      color: #6b7280;
      background: #eef2ff;
    }
    .delta-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
      border-radius: 999px;
      padding: 4px 10px;
    }
    .delta-positive {
      background: #dbeafe;
      color: #1d4ed8;
    }
    .delta-negative {
      background: #fee2e2;
      color: #b91c1c;
    }
    .behavior-section {
      margin-top: 20px;
      border-top: 1px dashed rgba(165, 180, 252, 0.6);
      padding-top: 16px;
    }
    .behavior-note {
      border-radius: 12px;
      border: 1px solid rgba(165, 180, 252, 0.4);
      background: #eef2ff;
      padding: 12px;
      margin-bottom: 10px;
    }
    .behavior-empty {
      font-size: 13px;
      color: #4c1d95;
      font-style: italic;
    }
    .points-section {
      border: 1px solid rgba(16, 185, 129, 0.25);
      background: #ecfdf3;
      border-radius: 16px;
      padding: 12px 14px;
      margin-top: 10px;
    }
    .points-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      font-size: 13px;
    }
    .points-table th {
      text-align: left;
      padding: 6px 8px;
      background: #d1fae5;
      color: #065f46;
    }
    .points-table td {
      padding: 6px 8px;
      border-top: 1px solid #e5e7eb;
    }
    .points-table td.delta {
      text-align: center;
      font-weight: 700;
    }
  `,n=e.students.map(o=>{var m;const{badgeBorder:l,badgeText:i,badgeBackground:a}=nv(o.tier),c=o.history.length?o.history.map(E=>`<tr>
                <td>${Ct(E.date.substring(0,10))}</td>
                <td>
                  <span class="delta-pill ${E.delta>=0?"delta-positive":"delta-negative"}">
                    ${E.delta>=0?"+":""}${E.delta}
                  </span>
                </td>
                <td>${st(E.reason||"No reason provided")}</td>
              </tr>`).join(""):'<tr><td colspan="3" class="behavior-empty">No point adjustments recorded in this range.</td></tr>',u=o.behavior&&o.behavior.notes.length?o.behavior.notes.map(E=>{const S=id(E.timestamp);return`<div class="behavior-note">
                    <div class="note-meta">
                      <span>${Ct(E.date)}</span>
                      ${S?`<span>${S}</span>`:""}
                    </div>
                    <div class="note-text">${st(E.note||"")}</div>
                  </div>`}).join(""):'<div class="behavior-empty">No behavior notes recorded in this date range.</div>';return`
        <section class="student-card">
          <div class="student-header">
            <div class="student-name">${st(o.name)}</div>
            <div class="points-badge" style="color:${i};border-color:${l};background:${a};">
              <div class="points-value">${o.currentPoints}</div>
              <div class="points-label">${o.tier.label}</div>
            </div>
          </div>
          <div class="history-section">
            <div class="section-heading" style="display:flex;align-items:center;gap:8px;font-weight:700;">
              <span>Point History</span>
            </div>
            <table class="history-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Change</th>
                  <th>Reason</th>
                </tr>
              </thead>
              <tbody>
                ${c}
              </tbody>
            </table>
          </div>
          <div class="behavior-section">
            <div class="section-heading" style="display:flex;align-items:center;gap:8px;font-weight:700;">
              <span>Behavior Notes (${((m=o.behavior)==null?void 0:m.totalNotes)||0})</span>
            </div>
            ${u}
          </div>
        </section>
      `}).join(""),r=e.students.length===0?'<div class="behavior-empty">No students were available for this report.</div>':"";return`
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charSet="utf-8" />
        <title>Points Report · ${st(e.periodName)}</title>
        <style>${t}</style>
      </head>
      <body>
        <div class="report-shell">
          <header class="report-header">
            <div class="eyebrow">ClassSeats Reports</div>
            <div class="report-title">Behavior Points Report</div>
            <div class="meta-grid">
              <div class="meta-card">
                <div class="meta-label">Period</div>
                <div class="meta-value">${st(e.periodName)}</div>
              </div>
              <div class="meta-card">
                <div class="meta-label">Students</div>
                <div class="meta-value">${e.studentsCount}</div>
              </div>
              <div class="meta-card">
                <div class="meta-label">Date Range</div>
                <div class="meta-value">${Ct(e.startDate)} – ${Ct(e.endDate)}</div>
              </div>
              <div class="meta-card">
                <div class="meta-label">Generated</div>
                <div class="meta-value">${st(e.generatedAt)}</div>
              </div>
            </div>
          </header>
          ${n||r}
        </div>
      </body>
    </html>
  `}function nv(e){switch(e.color){case"green":return{badgeBorder:"#a3e635",badgeText:"#166534",badgeBackground:"linear-gradient(135deg,#ecfccb,#bef264)"};case"yellow":return{badgeBorder:"#fcd34d",badgeText:"#78350f",badgeBackground:"linear-gradient(135deg,#fef3c7,#fde68a)"};case"orange":return{badgeBorder:"#fb923c",badgeText:"#9a3412",badgeBackground:"linear-gradient(135deg,#ffedd5,#fed7aa)"};case"red":default:return{badgeBorder:"#f87171",badgeText:"#7f1d1d",badgeBackground:"linear-gradient(135deg,#fee2e2,#fecaca)"}}}function sv(e,t,n,r){if(!e.layoutId||!e.activeGrouping||e.activeGrouping.length===0)return null;const l=$s().find(i=>String(i.id)===String(e.layoutId));return l?bm({layout:l,groups:e.activeGrouping,students:t,period:e,tablePositions:e.tablePositions||{},tableDimensions:e.tableDimensions||{},tags:n,selectedTagIds:r===null?void 0:r}):null}function rv(e,t,n,r){const l=$s().find(ce=>String(ce.id)===String(e.layoutId))||null,i=new Map(r.map(ce=>[String(ce.id),ce])),a=new Map,c=n.tagFilter?new Set(n.tagFilter.map(String)):null,u=7.5,m={seat:.45,nameMin:1.2,nameMax:3,tagsMin:.7,tagsMax:1.8,points:.6,blank:.25,notes:1.8},E=t.map(ce=>{const $e=lv(e,l,ce.id);a.set(ce.id,$e);let xe=[];return n.showTags&&ce.tagIds&&ce.tagIds.length&&(xe=ce.tagIds.filter(H=>c?c.has(String(H)):!0).map(H=>i.get(String(H))).filter(H=>!!H).map(H=>H.name||"").filter(Boolean)),{student:ce,seat:$e,tagsList:xe}});let L=E.reduce((ce,$e)=>Math.max(ce,($e.student.fullName||"").length),0)*.065+1;L=Math.min(m.nameMax,Math.max(m.nameMin,L));const N=E.reduce((ce,$e)=>{if(!n.showTags||$e.tagsList.length===0)return ce;const xe=$e.tagsList.join(", ");return Math.max(ce,xe.length)},0),W=N?Math.min(m.tagsMax,Math.max(m.tagsMin,N*.045+.6)):m.tagsMin;let x=L;n.showSeatNumbers&&(x+=m.seat);const f=n.showTags?W:0;n.showTags&&(x+=f),n.showPoints&&(x+=m.points),n.showNotes&&(x+=m.notes);const v=Math.max(0,u-x),D=Math.max(0,Math.floor((v+1e-6)/m.blank)),M=D*m.blank,G=Math.max(0,v-M);L=Math.min(m.nameMax,L+G);const J=new Array(D).fill("");let U=24;const te=E.length;te>28?U=16:te>20&&(U=18);const Y=E.sort((ce,$e)=>{const xe=ce.student.fullName||"",H=$e.student.fullName||"";if(n.sortBy==="seatNumber"){const k=ce.seat?parseInt(String(ce.seat),10):Number.MAX_SAFE_INTEGER,_=$e.seat?parseInt(String($e.seat),10):Number.MAX_SAFE_INTEGER;return k!==_?k-_:xe.localeCompare(H)}if(n.sortBy==="lastName"){const k=Fu(xe),_=Fu(H),A=k.localeCompare(_);return A!==0?A:xe.localeCompare(H)}const ge=zu(xe),ne=zu(H),h=ge.localeCompare(ne);return h!==0?h:xe.localeCompare(H)}).map(({student:ce,seat:$e,tagsList:xe})=>{const H=n.showTags&&xe.length?xe.join(", "):void 0,ge=n.showPoints&&e.pointsEnabled?Ko(e,ce.id):null;return{seatNumber:$e,name:ce.fullName||"",tagsText:H,points:ge}});return{periodName:e.name||"Class Period",generatedAt:new Date().toLocaleString(),studentsCount:Y.length,showSeatNumbers:n.showSeatNumbers,showTags:n.showTags,showPoints:n.showPoints&&!!e.pointsEnabled,showNotes:n.showNotes,blankColumns:D,blankHeaders:J,rows:Y,nameColumnWidth:L,tagsColumnWidth:f,rowHeight:U}}function ov(e){const t=`
    :root {
      font-family: 'Inter', Arial, sans-serif;
      color: #0f172a;
      background: #f8fafc;
    }
    body {
      margin: 0;
      padding: 32px;
    }
    .report-shell {
      max-width: 960px;
      margin: 0 auto;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.08);
      padding: 32px;
    }
    .report-header {
      margin-bottom: 24px;
      border-bottom: 1px solid #e2e8f0;
      padding-bottom: 16px;
    }
    .report-title {
      font-size: 28px;
      font-weight: 800;
      margin-bottom: 8px;
    }
    .meta-line {
      font-size: 14px;
      color: #475569;
    }
    table {
      width: 7.5in;
      margin: 0 auto;
      border-collapse: collapse;
      table-layout: fixed;
      font-size: 13px;
    }
    th, td {
      border: 1px solid #94a3b8;
      padding: 4px 6px;
      text-align: left;
      white-space: nowrap;
    }
    th {
      background: #f1f5f9;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-size: 11px;
    }
    .col-seat { width: 0.5in; text-align: center; }
    .col-name { width: ${e.nameColumnWidth}in; }
    .col-tags { width: ${e.tagsColumnWidth||.8}in; }
    .col-points { width: 0.6in; text-align: center; }
    .col-blank { width: 0.25in; text-align: center; }
    .col-notes { width: 1.8in; }
    td {
      height: ${e.rowHeight}px;
    }
  `,n=[];e.showSeatNumbers&&n.push('<th class="col-seat">Seat #</th>'),n.push('<th class="col-name">Student Name</th>'),e.showTags&&n.push('<th class="col-tags">Tags</th>'),e.showPoints&&n.push('<th class="col-points">Pts</th>');for(let o=0;o<e.blankColumns;o++)n.push(`<th class="col-blank">${st(e.blankHeaders[o]||"")}</th>`);e.showNotes&&n.push('<th class="col-notes">Notes</th>');const r=e.rows.map(o=>{const l=[];if(e.showSeatNumbers&&l.push(`<td class="col-seat">${o.seatNumber??""}</td>`),l.push(`<td class="col-name">${st(o.name)}</td>`),e.showTags){const i=o.tagsText?st(o.tagsText):"";l.push(`<td class="col-tags">${i}</td>`)}e.showPoints&&l.push(`<td class="col-points">${o.points??""}</td>`);for(let i=0;i<e.blankColumns;i++)l.push('<td class="col-blank"></td>');return e.showNotes&&l.push('<td class="col-notes"></td>'),`<tr>${l.join("")}</tr>`}).join("");return`
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charSet="utf-8" />
        <title>Roster · ${st(e.periodName)}</title>
        <style>${t}</style>
      </head>
      <body>
        <div class="report-shell">
          <header class="report-header">
            <div class="report-title">Class Roster</div>
            <div class="meta-line">${st(e.periodName)} · ${e.studentsCount} students</div>
            <div class="meta-line">Generated ${st(e.generatedAt)}</div>
          </header>
          <table class="roster-table">
            <thead>
              <tr>
                ${n.join("")}
              </tr>
            </thead>
            <tbody>
              ${r}
            </tbody>
          </table>
        </div>
      </body>
    </html>
  `}function lv(e,t,n){var E,S;if(!e.activeGrouping||!e.tableAssignments)return null;let r=-1,o=-1;if(e.activeGrouping.forEach((j,L)=>{const N=j.findIndex(W=>String(W)===String(n));N!==-1&&(r=L,o=N)}),r===-1||o===-1)return null;const l=e.tableAssignments[String(r)];if(!l)return null;const i=String(l),a=((E=e.tableNumbering)==null?void 0:E.perTableSeatNumbers)&&e.tableNumbering.perTableSeatNumbers[i],c=(S=t==null?void 0:t.tables.find(j=>String(j.id)===i))==null?void 0:S.seatNumbers,u=a||c;if(!u)return null;const m=u[o];return m!=null?String(m):null}function Fu(e){const t=(e||"").trim().split(/\s+/);return(t.length?t[t.length-1]:e||"").toLowerCase()}function zu(e){const t=(e||"").trim().split(/\s+/);return(t.length?t[0]:e||"").toLowerCase()}const Im=d.createContext(null);function iv({children:e}){const[t,n]=d.useState([]),r=d.useCallback(i=>{n(a=>a.filter(c=>c.id!==i))},[]),o=d.useCallback(i=>{const a=`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`,c=i.tone||"info",u=i.duration??4e3;n(m=>[...m,{...i,id:a,tone:c}]),u>0&&typeof window<"u"&&window.setTimeout(()=>r(a),u)},[r]),l=d.useMemo(()=>o,[o]);return s.jsxs(Im.Provider,{value:l,children:[e,s.jsx("div",{className:"pointer-events-none fixed top-6 left-1/2 -translate-x-1/2 z-[1000] flex flex-col gap-4 w-full max-w-lg items-center",children:t.map(i=>{const a=i.tone==="success"?"bg-emerald-600 text-white shadow-emerald-500/40":i.tone==="error"?"bg-rose-600 text-white shadow-rose-500/40":i.tone==="warning"?"bg-amber-500 text-slate-900 shadow-amber-400/40":"bg-slate-800 text-white shadow-slate-900/40";return s.jsxs("div",{className:`pointer-events-auto rounded-3xl px-5 py-4 shadow-2xl flex items-start gap-4 text-base font-semibold w-full ${a}`,children:[s.jsx("div",{className:"flex-1 text-sm font-semibold",children:i.message}),s.jsx("button",{className:"text-base font-bold opacity-80 hover:opacity-100",onClick:()=>r(i.id),"aria-label":"Dismiss notification",children:"×"})]},i.id)})})]})}function Pm(){const e=d.useContext(Im);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}function ar(e,t){const n=et().currentId,r=e!=null?String(e):n!=null?String(n):null;return{version:1,exportedAt:new Date().toISOString(),layouts:$s(),periodsState:et(),lastEditedPeriodId:r,lastEditedDate:t||null,students:mt(),tags:pn(),constraintsState:t0(),historyState:p0(),groupingsState:N0()}}var Uu,Vu;const lc=((Vu=(Uu=import.meta)==null?void 0:Uu.env)==null?void 0:Vu.VITE_GOOGLE_CLIENT_ID)??"403722152172-rm3rvd6kba8s10a8svv60jbj2s93kv1e.apps.googleusercontent.com",$m="https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/userinfo.email",Bu="ClassSeats",Tm="classseats_mobile_drive_session_v2",ad="classseats_mobile_drive_folder_v1",av={classseats:"data_v1"},Dm="https://us-east1-classseats-sync.cloudfunctions.net/exchangecode",Dl="classseats_mobile_drive_pkce_verifier",So="classseats_mobile_drive_return_to",Ml="classseats_mobile_drive_redirect_uri",Mm="https://app.classseats.app/ClassSeatsMobile",cv="ClassSeatsMobile";function dv(){if(typeof window>"u")return Mm;const e=window.location.origin,t="./",n=t.endsWith("/")?t:t+"/";return`${e}${n}${cv}`}const uv=45*60*1e3,fv="classseats_auth",pv=1,Cs="driveSession",ci="singleton";let Os=null,Fn=null,co=!1,Rl="none";function mv(e){const{sessionLoaded:t}=e,n=(e.lastWriteReason||"").trim();return t?"ok":n?n==="explicit-disconnect"?"user-logged-out":n==="fatal-oauth-error"?"oauth-failure":n==="login-success"?"device-storage-wipe":"unknown":"no-session-yet"}function cd(){return new Promise((e,t)=>{const n=indexedDB.open(fv,pv);n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(Cs)||r.createObjectStore(Cs,{keyPath:"id"})},n.onsuccess=()=>e(n.result),n.onerror=()=>t(n.error||new Error("IndexedDB open failed"))})}async function gv(){const e=await cd();return new Promise((t,n)=>{const l=e.transaction(Cs,"readonly").objectStore(Cs).get(ci);l.onsuccess=()=>{const i=l.result;if(i){Fn={lastWriteAt:i.lastWriteAt,lastWriteReason:i.lastWriteReason};const{id:a,lastWriteAt:c,lastWriteReason:u,...m}=i;t(m)}else t(null)},l.onerror=()=>n(l.error||new Error("IDB get failed"))})}async function Rm(e,t){const n=await cd();return new Promise((r,o)=>{const l=n.transaction(Cs,"readwrite"),i=l.objectStore(Cs);if(!e)console.info("[Drive][IDB] CLEAR session",{reason:t}),i.delete(ci),Fn={lastWriteAt:Date.now(),lastWriteReason:t};else{const a={id:ci,...e,lastWriteAt:Date.now(),lastWriteReason:t};console.info("[Drive][IDB] WRITE session",{reason:t,hasRefresh:!!e.refreshToken,expiresAt:e.expiresAt}),i.put(a),Fn={lastWriteAt:a.lastWriteAt,lastWriteReason:a.lastWriteReason}}l.oncomplete=()=>r(),l.onerror=()=>o(l.error||new Error("IDB put/delete failed"))})}async function hv(){try{const e=await cd();return await new Promise((t,n)=>{const l=e.transaction(Cs,"readonly").objectStore(Cs).get(ci);l.onsuccess=()=>{const i=l.result;i?(Fn={lastWriteAt:i.lastWriteAt,lastWriteReason:i.lastWriteReason},t(i)):t(null)},l.onerror=()=>n(l.error||new Error("IDB get failed"))})}catch(e){return console.warn("[Drive][IDB] getDriveSessionRecord failed",e),null}}async function xv(){const e=await hv(),t=!!e,n=!!(e!=null&&e.refreshToken),r=(e==null?void 0:e.expiresAt)??null,o=(e==null?void 0:e.lastWriteAt)??(Fn==null?void 0:Fn.lastWriteAt)??null,l=(e==null?void 0:e.lastWriteReason)??(Fn==null?void 0:Fn.lastWriteReason)??null,i=e?"idb":"none",a=e==null?void 0:e.profile,c=mv({sessionLoaded:t,lastWriteReason:l}),u={sessionLoaded:t,hasRefresh:n,expiresAt:r,source:i,lastWriteAt:o,lastWriteReason:l,state:c,profile:a};return console.info("startup:",u),console.info("[Drive] startupSessionState",{state:c,lastWriteReason:l}),u}function vv(){if(typeof window>"u")return null;try{const e=window.localStorage.getItem(Tm);return e?JSON.parse(e):null}catch{return null}}function bv(){typeof window>"u"||window.localStorage.removeItem(Tm)}async function Ii(){if(co)return Os;try{const t=await gv();if(t)return Os=t,Rl="idb",co=!0,Os}catch{}const e=vv();if(e){Os=e,Rl="legacy",co=!0;try{await Rm(e,"startup-migration")}catch{}return Os}return Os=null,Rl="none",co=!0,null}async function dd(e,t){Os=e,co=!0,Rl=e?"idb":"none";try{await Rm(e,t)}catch(n){console.warn("[Drive][IDB] persistSession failed",n)}}async function _m(e){await dd(null,e),bv()}async function Am(){return Ii()}function yv(e,t=5*60*1e3){return!e||e.expiresAt<=Date.now()+t}function wv(e){return e.replace(/^#/,"").split("&").map(t=>t.split("=")).reduce((t,[n,r])=>(n&&(t[decodeURIComponent(n)]=decodeURIComponent(r||"")),t),{})}function Lm(e,t,n,r){const o=t?t*1e3:uv;return{accessToken:e,expiresAt:Date.now()+o-60*1e3,refreshToken:n,profile:r}}async function Om(e){try{const t=await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)return;const n=await t.json();return{email:n.email,name:n.name,picture:n.picture}}catch{return}}async function Sv(){const e=new Uint8Array(32);return crypto.getRandomValues(e),btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Nv(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),o=Array.from(new Uint8Array(r));return btoa(String.fromCharCode(...o)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function jv(e,t=$m,n){const r=await Sv(),o=await Nv(r),l=btoa(JSON.stringify({v:r,r:n||null}));return window.localStorage.setItem(Dl,r),n?window.localStorage.setItem(So,n):window.localStorage.removeItem(So),window.localStorage.setItem(Ml,e),`https://accounts.google.com/o/oauth2/v2/auth?${new URLSearchParams({client_id:lc,redirect_uri:e,response_type:"code",scope:t,include_granted_scopes:"true",state:l,prompt:"consent",access_type:"offline",code_challenge:o,code_challenge_method:"S256"}).toString()}`}async function kv(e,t,n){const r={grant_type:"authorization_code",code:e,code_verifier:t,redirect_uri:n,client_id:lc};console.info("[Drive] Exchanging code",{redirect_uri:n,client_id:lc,code_preview:e?`${e.slice(0,4)}...${e.slice(-4)}`:"none"});const o=await fetch(Dm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!o.ok){const l=await o.text().catch(()=>"");throw new Error(l||"Failed to exchange code for tokens.")}return o.json()}async function Cv(){if(typeof window>"u")return null;const e=window.location.search||"",t=new URLSearchParams(e);let n=t.get("code"),r=t.get("state");if(!n&&window.location.hash){const a=wv(window.location.hash);n=a.code||n,r=a.state||r}if(!n)return null;let o=null,l=null,i=null;if(r)try{const a=JSON.parse(atob(r));a!=null&&a.v&&typeof a.v=="string"&&(o=a.v),a!=null&&a.r&&typeof a.r=="string"&&(l=a.r),a!=null&&a.d&&typeof a.d=="string"&&(i=a.d)}catch{}if(o||(o=window.localStorage.getItem(Dl)),l||(l=window.localStorage.getItem(So)),i||(i=window.localStorage.getItem(Ml)||Mm),!o)return null;try{const a=await kv(n,o,i),c=await Om(a.access_token),u=Lm(a.access_token,a.expires_in,a.refresh_token,c||void 0);return await dd(u,"login-success"),window.localStorage.removeItem(Dl),window.localStorage.removeItem(So),window.localStorage.removeItem(Ml),l&&l!==i?window.location.replace(l):window.history.replaceState(null,document.title,i),u}catch{return window.localStorage.removeItem(Dl),window.localStorage.removeItem(So),window.localStorage.removeItem(Ml),null}}async function Fm(e=$m,t,n){if(typeof window>"u")throw new Error("Browser required.");const r=n||dv(),o=await jv(r,e,t||window.location.href);return window.location.href=o,new Promise(()=>{})}async function zm(){const e=await Ii();if(!e)return console.warn("[Drive] refreshDriveSession: no stored session"),null;if(e.expiresAt>Date.now()+60*1e3)return console.debug("[Drive] refreshDriveSession: not expiring soon; skipping refresh",{expiresAt:e.expiresAt}),e;if(!e.refreshToken)return console.warn("[Drive] refreshDriveSession: missing refresh token; cannot refresh; keeping existing session",{expiresAt:e.expiresAt}),e;try{const t=await fetch(Dm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({grant_type:"refresh_token",refresh_token:e.refreshToken})});if(!t.ok){const l=await t.text().catch(()=>"");throw console.warn("[Drive] refreshDriveSession: HTTP error from token endpoint",{status:t.status,statusText:t.statusText,bodySnippet:l.slice(0,200)}),new Error("Refresh failed: "+t.status)}const n=await t.json(),r=await Om(n.access_token),o=Lm(n.access_token,n.expires_in,e.refreshToken,r||e.profile);return await dd(o,"refresh-success"),o}catch(t){const n=String((t==null?void 0:t.message)||"");return console.warn("[Drive] refreshDriveSession: caught error",{message:n}),/invalid_grant|invalid_client/i.test(n)?(console.warn("[Drive] refreshDriveSession: treating as fatal OAuth error; clearing session"),await _m("fatal-oauth-error")):console.warn("[Drive] refreshDriveSession: non-fatal error; keeping stored session in IDB"),null}}async function No(e){let t=e??await Ii();return t?yv(t)?await zm():t:null}async function Bm(){const e=await Cv();if(e)return e;const t=await Ii();return t&&t.expiresAt>Date.now()+60*1e3?t:zm()}async function Wm(){await _m("explicit-disconnect")}async function Js(e,t,n){const r=await fetch(t,{...n,headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json",...(n==null?void 0:n.headers)||{}}});if(!r.ok){const o=await r.text().catch(()=>"");throw new Error(o||"Google Drive request failed.")}return r}async function Gm(e){const t=Ev();if(t){if(await Pv(e,t))return t;Iv()}const n=new URLSearchParams({q:`name='${Bu}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,fields:"files(id)",spaces:"drive"}),o=await(await Js(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json();if(Array.isArray(o.files)&&o.files.length>0)return Wu(o.files[0].id),o.files[0].id;const i=await(await Js(e,"https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:Bu,mimeType:"application/vnd.google-apps.folder"})})).json();return Wu(i.id),i.id}function Wu(e){typeof window>"u"||window.localStorage.setItem(ad,e)}function Ev(){return typeof window>"u"?null:window.localStorage.getItem(ad)}function Iv(){typeof window>"u"||window.localStorage.removeItem(ad)}async function Pv(e,t){try{return(await Js(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id`)).ok}catch{return!1}}async function ic(e){const t=await Gm(e),n=new URLSearchParams({q:`'${t}' in parents and trashed=false`,fields:"files(id,name,modifiedTime,size,headRevisionId)",orderBy:"modifiedTime desc",spaces:"drive"});return((await(await Js(e,`https://www.googleapis.com/drive/v3/files?${n.toString()}`)).json()).files||[]).map(Pi)}async function ud(e,t,n){const r=await Gm(e),o="classseats_drive_boundary",l={name:t,mimeType:"application/json",parents:[r],appProperties:av},i=[`--${o}`,"Content-Type: application/json; charset=UTF-8","",JSON.stringify(l),`--${o}`,"Content-Type: application/json","",n,`--${o}--`,""].join(`\r
`),a=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,modifiedTime,size,headRevisionId",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":`multipart/related; boundary=${o}`},body:i});if(!a.ok){const u=await a.text().catch(()=>"");throw new Error(u||"Failed to create Google Drive file.")}const c=await a.json();return Pi(c)}async function Sr(e,t){return(await Js(e,`https://www.googleapis.com/drive/v3/files/${t}?alt=media`,{method:"GET"})).text()}async function Hm(e,t,n){const r=await fetch(`https://www.googleapis.com/upload/drive/v3/files/${t}?uploadType=media`,{method:"PATCH",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:n});if(!r.ok){const i=await r.text().catch(()=>"");throw new Error(i||"Failed to upload file to Google Drive.")}const l=await(await Js(e,`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime,size,headRevisionId`,{method:"GET"})).json();return Pi(l)}function Pi(e){var t;return e?{id:e.id,name:e.name,modifiedTime:e.modifiedTime,size:e.size,revisionId:e.headRevisionId||e.revisionId||((t=e==null?void 0:e.appProperties)==null?void 0:t.revisionId)}:{id:"",name:""}}async function Um(e){const t=new URLSearchParams({q:"mimeType='application/json' and trashed=false",fields:"files(id,name,modifiedTime,size,headRevisionId)",orderBy:"modifiedTime desc",spaces:"drive"});return((await(await Js(e,`https://www.googleapis.com/drive/v3/files?${t.toString()}`)).json()).files||[]).map(Pi)}async function $v(e,t,n){const r=await Sr(e,t);return ud(e,n,r)}function Tv(){var e;return typeof window<"u"&&!!((e=window.desktopBridge)!=null&&e.getDriveStatus)}function Dv(e){return{kind:"desktop",getStatus:async()=>e!=null&&e.getDriveStatus?await e.getDriveStatus():{connected:!1},connect:async()=>e!=null&&e.connectDrive?await e.connectDrive():{connected:!1,error:"Drive unavailable."},disconnect:async()=>e!=null&&e.disconnectDrive?await e.disconnectDrive():{connected:!1},listFiles:e!=null&&e.listDriveFiles?async()=>e.listDriveFiles():async()=>({error:"Drive unavailable."}),listAnyJsonFiles:e!=null&&e.listAnyJsonFiles?async()=>e.listAnyJsonFiles():async()=>({error:"Drive unavailable."}),createFile:e!=null&&e.createDriveFile?async t=>e.createDriveFile(t):async()=>({error:"Drive unavailable."}),getFileMetadata:e!=null&&e.getDriveFileMetadata?async t=>e.getDriveFileMetadata(t):async()=>({error:"Drive unavailable."}),downloadFile:e!=null&&e.downloadDriveFile?async t=>e.downloadDriveFile(t):async()=>({error:"Drive unavailable."}),uploadFile:e!=null&&e.uploadDriveFile?async t=>e.uploadDriveFile(t):async()=>({error:"Drive unavailable."}),importFile:e!=null&&e.importDriveFile?async t=>e.importDriveFile(t):async()=>({error:"Drive unavailable."}),openExternal:e==null?void 0:e.openExternal}}let cr=null;async function is(){try{if(cr){const n=await No(cr);if(n)return cr=n,n}const e=await Bm();if(e)return cr=e,e;const t=await Am();if(t){const n=await No(t);if(n)return cr=n,n}return null}catch{return null}}async function Mv(e,t){var o;const n=await fetch(`https://www.googleapis.com/drive/v3/files/${t}?fields=id,name,modifiedTime,size,headRevisionId,appProperties,parents`,{headers:{Authorization:`Bearer ${e}`}});if(!n.ok){const l=await n.text().catch(()=>"");throw new Error(l||"Unable to load file metadata.")}const r=await n.json();return{id:r.id,name:r.name,modifiedTime:r.modifiedTime,size:r.size,revisionId:r.headRevisionId||r.revisionId||((o=r==null?void 0:r.appProperties)==null?void 0:o.revisionId)}}function Rv(){return{kind:"web",getStatus:async()=>{const e=await is();return e?{connected:!0,profile:e.profile}:{connected:!1}},connect:async()=>{try{const e=typeof window<"u"?window.location.href:void 0,t=typeof window<"u"?`${window.location.origin}${window.location.pathname}${window.location.search}`:void 0;return Fm(void 0,e,t),{connected:!1,error:"Redirecting to Google for sign-in…"}}catch(e){return{connected:!1,error:(e==null?void 0:e.message)||"Unable to start Google sign-in."}}},disconnect:async()=>(await Wm(),cr=null,{connected:!1}),listFiles:async()=>{const e=await is();if(!e)return{error:"Sign in with Google Drive first."};try{return{files:await ic(e.accessToken)}}catch(t){return{error:(t==null?void 0:t.message)||"Unable to list Drive files."}}},listAnyJsonFiles:async()=>{const e=await is();if(!e)return{error:"Sign in with Google Drive first."};try{return{files:await Um(e.accessToken)}}catch(t){return{error:(t==null?void 0:t.message)||"Unable to list Drive files."}}},createFile:async({name:e,content:t})=>{const n=await is();if(!n)return{error:"Sign in with Google Drive first."};try{return{file:await ud(n.accessToken,e,t)}}catch(r){return{error:(r==null?void 0:r.message)||"Unable to create Drive file."}}},getFileMetadata:async e=>{const t=await is();if(!t)return{error:"Sign in with Google Drive first."};try{return{file:await Mv(t.accessToken,e)}}catch(n){return{error:(n==null?void 0:n.message)||"Unable to load file metadata."}}},downloadFile:async e=>{const t=await is();if(!t)return{error:"Sign in with Google Drive first."};try{return{data:await Sr(t.accessToken,e)}}catch(n){return{error:(n==null?void 0:n.message)||"Unable to download Drive file."}}},uploadFile:async({fileId:e,content:t})=>{const n=await is();if(!n)return{error:"Sign in with Google Drive first."};try{return{file:await Hm(n.accessToken,e,t)}}catch(r){return{error:(r==null?void 0:r.message)||"Unable to upload Drive file."}}},importFile:async({fileId:e,name:t})=>{const n=await is();if(!n)return{error:"Sign in with Google Drive first."};try{return{file:await $v(n.accessToken,e,t||"ClassSeats Import")}}catch(r){return{error:(r==null?void 0:r.message)||"Unable to import Drive file."}}},openExternal:e=>{typeof window<"u"&&window.open(e,"_blank","noopener,noreferrer")}}}const _v=["room","students","grouping","attendance","history","reports"],Av="https://app.classseats.app/ClassSeatsMobile",or="classseats_drive_file_v1",Lv="201";function Nn(e){var t;return e?{...e,revisionId:e.headRevisionId||e.revisionId||((t=e==null?void 0:e.appProperties)==null?void 0:t.revisionId)}:null}const as=e=>{if(!e)return!1;const t=e.toLowerCase();return t.includes("enotfound")||t.includes("econnreset")||t.includes("eai_again")||t.includes("getaddrinfo")||t.includes("network")||t.includes("offline")};function Gu(e){const t={};return!e||typeof e!="object"||Object.entries(e).forEach(([n,r])=>{if(!r||typeof r!="object")return;const o={},l=r.note&&typeof r.note=="object"?r.note:r;Object.entries(l).forEach(([i,a])=>{a&&typeof a=="object"&&typeof a.note=="string"&&(o[String(i)]={note:a.note,timestamp:a.timestamp||new Date().toISOString()})}),Object.keys(o).length>0&&(t[n]=o)}),t}function Ov(e){var E,S;if(!(Array.isArray(e.periods)&&e.periods.length>0&&Array.isArray((E=e.periods[0])==null?void 0:E.students)))return null;const n=(e.tableLayouts||[]).map(j=>({id:j.id,name:j.name,tables:(j.tables||[]).map(L=>({id:L.id,name:L.name,capacity:L.capacity||2,width:L.width||120,height:L.height||140,rotation:L.rotation||0,position:L.position||{x:0,y:0}}))})),r=new Map,o=[],l={byPeriod:{}},i={byPeriod:{}},a={byPeriod:{}};for(const j of e.periods||[]){const L=String(j.id),N={},W=[];if(j.pointsData)for(const M in j.pointsData){const G=j.pointsData[M];if(N[M]=G.currentPoints,G.history)for(const J of G.history)W.push({studentId:M,delta:J.change,reason:J.reason||"No reason provided",date:J.timestamp||J.date})}const x={id:j.id,name:j.name,layoutId:j.layoutId||e.currentLayoutId||null,pointsEnabled:j.pointsEnabled??!1,startingPoints:j.startingPoints??50,pointsByStudent:Object.keys(N).length>0?N:j.pointsByStudent||{},pointsHistory:W.length>0?W:j.pointsHistory||[],attendance:j.attendance||{},behaviorNotes:j.behaviorNotes||{},tablePositions:j.tablePositions||{},tableDimensions:j.tableDimensions||{},tableAssignments:j.tableAssignments||{},activeGrouping:j.currentGroups?j.currentGroups.map(M=>M.map(G=>typeof G=="object"?G.id:G)):void 0,attendanceSelectedGroupingId:j.attendanceSelectedGroupingId||null,attendanceRotation:j.attendanceRotation||0};o.push(x);for(const M of j.students||[]){const G=String(M.id);if(r.has(G)){const J=r.get(G);(S=J.periodIds)!=null&&S.includes(j.id)||(J.periodIds=[...J.periodIds||[],j.id])}else{const J={id:M.id,fullName:M.name,gender:M.gender||"",tagIds:M.tags||[],notes:M.notes||"",happyWithAnyone:M.happyWithAnyone??!1,canWorkSolo:M.canWorkSolo??!1,mustWorkAlone:M.mustWorkAlone??!1,strongPreferences:M.strongPreferences||[],preferences:M.preferences||[],periodIds:[j.id],gotChoice:M.gotChoice||0,solo:M.solo||0};r.set(G,J)}}l.byPeriod[L]={together:j.mustWorkTogether||[],apart:j.mustStayApart||[]};const f={},v={};for(const M in j.workHistory||{}){const G=M.includes("|")?M:M.replace(/-/g,"|");f[G]=j.workHistory[M]}for(const M in j.soloHistory||{})v[M]=j.soloHistory[M];i.byPeriod[L]={work:f,solos:v,gotChoice:{}};const D=(j.savedGroupings||[]).map(M=>({id:M.id||Date.now()+Math.random(),name:M.name||"Grouping",savedAt:M.savedAt||new Date().toISOString(),layoutId:M.layoutId||j.layoutId||null,groups:(M.groups||[]).map(G=>G.map(J=>typeof J=="object"?J.id:J)),tablePositions:M.tablePositions||{},tableDimensions:M.tableDimensions||{}}));a.byPeriod[L]=D}const c=Array.from(r.values()),u=(e.tags||[]).map(j=>({id:j.id,name:j.name,color:j.color||"#888888",icon:j.icon||"",description:j.description||""})),m=o.length>0?o[0].id:null;return{layouts:n,periodsState:{periods:o,currentId:m},students:c,tags:u,constraintsState:l,historyState:i,groupingsState:a}}function Fv(){var Wr;const[e,t]=d.useState("room"),[n,r]=d.useState(et()),o=d.useRef(null),l=Pm(),i=d.useMemo(()=>Tv(),[]),a=d.useMemo(()=>i?Dv(window.desktopBridge):Rv(),[i]),c=!!a,[u,m]=d.useState({connected:!1}),[E,S]=d.useState(!1),[j,L]=d.useState(null),[N,W]=d.useState([]),[x,f]=d.useState(!1),[v,D]=d.useState(null),[M,G]=d.useState(!1),[J,U]=d.useState(!1),[te,ae]=d.useState(!1),[Y,ce]=d.useState(""),[$e,xe]=d.useState(!1),[H,ge]=d.useState(null),[ne,h]=d.useState(!1),[k,_]=d.useState(!1),[A,p]=d.useState(!1),[P,w]=d.useState(null),[b,C]=d.useState(null),[I,q]=d.useState(null),[K,le]=d.useState(0),[je,Te]=d.useState("unknown"),[me,Pe]=d.useState(!navigator.onLine),[Le,Oe]=d.useState(!1),[F,oe]=d.useState([]),[$,O]=d.useState(!1),[y,R]=d.useState(null),[z,X]=d.useState(!1),[re,ie]=d.useState(!1),[we,ee]=d.useState(""),[ze,Ce]=d.useState(!1),[ye,Ee]=d.useState(null),pe=d.useRef(null),[se,B]=d.useState(()=>{if(typeof window>"u")return null;try{const T=window.localStorage.getItem(or);return T?Nn(JSON.parse(T)):null}catch{return null}});d.useEffect(()=>{document.title="ClassSeats - New UI"},[]);const fe=d.useCallback(()=>{const T=new Date,V=He=>String(He).padStart(2,"0"),de=`${T.getFullYear()}-${V(T.getMonth()+1)}-${V(T.getDate())}-${V(T.getHours())}-${V(T.getMinutes())}-${V(T.getSeconds())}`,he=ar(),Ge=new Blob([JSON.stringify(he,null,2)],{type:"application/json"}),at=URL.createObjectURL(Ge),Ve=document.createElement("a");Ve.href=at,Ve.download=`ClassSeats-Backup-${de}.json`,document.body.appendChild(Ve),Ve.click(),Ve.remove(),URL.revokeObjectURL(at),l({tone:"info",message:"Local backup downloaded."})},[l]),Ae=d.useCallback(()=>{var T;(T=o.current)==null||T.click()},[]),Ke=d.useCallback(()=>{On([]),En([]),us([]),to({byPeriod:{}}),no({byPeriod:{}}),so({byPeriod:{}}),lr({periods:[],currentId:null}),Ut(null),r({periods:[],currentId:null}),le(T=>T+1),Ze.current=!1,$t.current=0,Rt.current=null,vn.current=null,pe.current=null,Te("desktop"),C(null),Oe(!1)},[On,En,us,to,no,so,lr,Ut]),Qe=d.useCallback(async()=>{if(ze)return;const T=(we||"").trim()||"New ClassSeats File";Ee(null),Ce(!0);try{if(c&&u.connected&&a.createFile){const V=new Date().toISOString(),de={version:1,exportedAt:V,layouts:[],periodsState:{periods:[],currentId:null},lastEditedPeriodId:null,lastEditedDate:null,students:[],tags:[],constraintsState:{byPeriod:{}},historyState:{byPeriod:{}},groupingsState:{byPeriod:{}},lastWriter:"desktop",updatedAt:V},he=await a.createFile({name:T,content:JSON.stringify(de,null,2)});if(he!=null&&he.error)throw new Error(he.error);const Ge=he!=null&&he.file?Nn(he.file):null;Ge&&(B(Ge),window.localStorage.setItem(or,JSON.stringify(Ge)),pe.current=Ge.revisionId||null)}else B(null),window.localStorage.removeItem(or);Ke(),l({tone:"success",message:`Created new file: ${T}`}),ie(!1)}catch(V){const de=(V==null?void 0:V.message)||"Unable to create new file.";Ee(de),l({tone:"error",message:de})}finally{Ce(!1)}},[c,u.connected,a,ze,we,Ke,l]),Xe=d.useCallback(()=>{ee(""),Ee(null),ie(!0)},[]);d.useEffect(()=>{const T=V=>{if(!zr.current)return V.preventDefault(),V.returnValue="You have unsaved changes. Are you sure you want to leave?",V.returnValue};return window.addEventListener("beforeunload",T),()=>window.removeEventListener("beforeunload",T)},[]),d.useEffect(()=>{const T=()=>r(et());return window.addEventListener("focus",T),()=>window.removeEventListener("focus",T)},[]),d.useEffect(()=>{typeof window>"u"||(se?window.localStorage.setItem(or,JSON.stringify(se)):window.localStorage.removeItem(or))},[se]);const rt=d.useCallback(async()=>{try{const T=await a.getStatus();m(T);const V=(T==null?void 0:T.error)||null;L(V),as(V||"")||!navigator.onLine?Pe(!0):navigator.onLine&&(T!=null&&T.connected)&&Pe(!1)}catch(T){const V=(T==null?void 0:T.message)||"Unable to check Google Drive.";as(V)?(Pe(!0),L("Offline — network unavailable.")):(m({connected:!1}),L(V))}},[a]);d.useCallback(async()=>{if(!a.listAnyJsonFiles){R("Import requires the desktop helper.");return}O(!0),R(null);try{const T=await a.listAnyJsonFiles();if(T!=null&&T.error)R(T.error);else{const V=((T==null?void 0:T.files)||[]).map(de=>Nn(de)).filter(de=>!!de);oe(V)}}catch(T){R((T==null?void 0:T.message)||"Unable to list Drive files.")}finally{O(!1)}},[a]),d.useEffect(()=>{c&&rt()},[c,rt]),d.useEffect(()=>{const T=()=>{const V=!navigator.onLine||(j?as(j):!1)||(u!=null&&u.error?as(u.error):!1);Pe(V)};return window.addEventListener("online",T),window.addEventListener("offline",T),()=>{window.removeEventListener("online",T),window.removeEventListener("offline",T)}},[j,u]),d.useEffect(()=>{const T=window.setInterval(()=>{const V=!navigator.onLine||(j?as(j):!1)||(u!=null&&u.error?as(u.error):!1);Pe(V)},5e3);return()=>window.clearInterval(T)},[j,u]),d.useEffect(()=>{if(!navigator.onLine){Pe(!0);return}if(j&&as(j)){Pe(!0);return}if(u!=null&&u.error&&as(u.error)){Pe(!0);return}u!=null&&u.connected&&Pe(!1)},[j,u]),d.useEffect(()=>{if(!c)return;const T=window.setInterval(()=>{rt()},2e4);return()=>window.clearInterval(T)},[c,rt]);const it=d.useCallback(async(T,V)=>{if(!T||!a.getFileMetadata)return null;try{const de=await a.getFileMetadata(T);if(de!=null&&de.error)return V!=null&&V.silent||w(de.error),null;const he=Nn(de.file);return he&&(B(he),ge(he)),he}catch(de){return V!=null&&V.silent||w((de==null?void 0:de.message)||"Unable to load file info."),null}},[a,B]),Fe=d.useCallback(async()=>{var T;S(!0);try{a.kind==="web"&&(zr.current=!0);const V=await a.connect();if(m(V),L((V==null?void 0:V.error)||null),V!=null&&V.connected){const de=(T=V.profile)!=null&&T.email?` (${V.profile.email})`:"";l({tone:"success",message:`Connected to Google Drive${de}.`})}else V!=null&&V.error&&l({tone:"info",message:V.error})}catch(V){L((V==null?void 0:V.message)||"Unable to connect to Google Drive."),l({tone:"error",message:(V==null?void 0:V.message)||"Unable to connect to Google Drive."})}finally{S(!1)}},[a,l]),Ie=d.useCallback(async()=>{S(!0);try{const T=await a.disconnect();m(T),L(null),l({tone:"info",message:"Disconnected from Google Drive."})}catch(T){L((T==null?void 0:T.message)||"Unable to disconnect from Google Drive."),l({tone:"error",message:(T==null?void 0:T.message)||"Unable to disconnect from Google Drive."})}finally{S(!1)}},[a,l]),Ft=d.useCallback(()=>{B(null),ge(null),localStorage.removeItem(or),l({tone:"info",message:"Cleared active Drive file selection."})},[l]),vt=d.useCallback(()=>{if(!(se!=null&&se.id))return;const T=`https://drive.google.com/file/d/${se.id}/view`;a.openExternal?a.openExternal(T):typeof window<"u"&&window.open(T,"_blank","noopener,noreferrer")},[se,a]),qe=d.useCallback(async()=>{if(!a.listFiles){W([]),D("Drive sync is only available in the desktop helper.");return}f(!0),D(null);try{const T=await a.listFiles();if(T!=null&&T.error)D(T.error);else{const V=((T==null?void 0:T.files)||[]).map(de=>Nn(de)).filter(de=>!!de);W(V)}}catch(T){D((T==null?void 0:T.message)||"Unable to load Drive files.")}finally{f(!1)}},[a]);d.useEffect(()=>{M&&(ge(se),qe())},[M,se,qe]);const Pt=d.useCallback((T,V)=>{var cn,Vn,en;if(!T)return!1;const de=et(),he=Ov(T);if(he)return On(he.layouts),En(he.students),us(he.tags),to(he.constraintsState),no(he.historyState),so(he.groupingsState),lr(he.periodsState),alert("Legacy format detected and converted successfully! Your data has been imported with all attendance, behavior points, and history preserved."),window.location.reload(),!0;if(T.version&&T.layouts&&T.periodsState&&T.students&&T.tags){if(On(T.layouts||[]),En(T.students||[]),us(T.tags||[]),T.constraintsState&&to(T.constraintsState),T.historyState&&no(T.historyState),T.groupingsState&&so(T.groupingsState),(cn=T.periodsState)!=null&&cn.periods){const bt={...T.periodsState,periods:(T.periodsState.periods||[]).map(Qo=>({...Qo,behaviorNotes:Gu(Qo.behaviorNotes)}))},os=V!=null&&V.preserveCurrent?{...bt,currentId:de.currentId}:bt;lr(os),r(os)}const nt=V!=null&&V.preserveCurrent?de.currentId:(Vn=T.periodsState)==null?void 0:Vn.currentId;return Ut(nt??de.currentId??null),r(et()),V!=null&&V.preserveCurrent||le(bt=>bt+1),!0}const Ge=T.layouts||T.tableLayouts||[],at=T.tags||[],Ve=(T.periods||[]).map(nt=>({id:nt.id,name:nt.name,layoutId:nt.layoutId??T.currentLayoutId??null,behaviorNotes:Gu(nt.behaviorNotes)})),He=[];for(const nt of T.periods||[])for(const bt of nt.students||[])He.push({id:bt.id,fullName:bt.name,gender:bt.gender,tagIds:bt.tags||[],notes:bt.notes||"",happyWithAnyone:!!bt.happyWithAnyone,canWorkSolo:!!bt.canWorkSolo,mustWorkAlone:!!bt.mustWorkAlone,strongPreferences:bt.strongPreferences||[],preferences:bt.preferences||[],periodIds:[nt.id]});On(Ge),us(at),En(He),rc(Ve);const Ye=V!=null&&V.preserveCurrent?de.currentId:((en=Ve[0])==null?void 0:en.id)??null;return Ut(Ye??null),le(nt=>nt+1),!0},[On,En,us,to,no,so,lr,rc,Ut]),Ts=d.useCallback(async()=>{if(!c||!a.createFile){D("Drive sync requires the desktop helper.");return}const T=Y.trim();if(!T){D("Enter a file name first.");return}xe(!0),D(null);try{const V=ar(),de=await a.createFile({name:T,content:JSON.stringify(V,null,2)});if(de!=null&&de.error)D(de.error);else if(de!=null&&de.file){const he=Nn(de.file);l({tone:"success",message:`Created ${de.file.name} in Google Drive.`}),ce(""),await qe(),he&&B(he)}}catch(V){D((V==null?void 0:V.message)||"Unable to create cloud file.")}finally{xe(!1)}},[c,a,Y,qe,l]),xn=d.useCallback(T=>{ge(T),l({tone:"info",message:`Selected ${T.name}. Click "Load Selected File" to use it.`})},[l]),an=d.useCallback(async()=>{if(!H){D("Select a cloud file first.");return}if(!a.downloadFile){D("Drive sync requires the desktop helper.");return}h(!0),D(null);try{const T=await a.downloadFile(H.id);if(T!=null&&T.error)throw new Error(T.error);const V=T==null?void 0:T.data;if(!V)throw new Error("Drive returned an empty file.");const de=typeof V=="string"?JSON.parse(V):V;if(Pt(de,{preserveCurrent:!1})){const he=await it(H.id,{silent:!0});B(he||H),w("Drive file loaded."),l({tone:"success",message:`Loaded ${H.name}.`})}}catch(T){const V=(T==null?void 0:T.message)||"Unable to load Drive file.";D(V),l({tone:"error",message:V})}finally{h(!1)}},[Pt,H,it,l]),Ze=d.useRef(!1),$t=d.useRef(0),Re=d.useRef(!1),vn=d.useRef(null),Hn=d.useRef(null),er=d.useRef(0),wt=d.useRef(null),Xt=d.useRef(null),Mn=d.useRef(!1),Rt=d.useRef(null),zr=d.useRef(!1),Zt=d.useCallback(T=>{Ze.current=!0,$t.current+=1,T&&(Xt.current=T)},[]),Un=d.useCallback(()=>Ze.current?(console.log("[Drive][Desktop] skip apply (dirty)",{dirty:Ze.current}),!1):!0,[]),qt=d.useCallback(T=>{if(!(!c||!u.connected||!(se!=null&&se.id))){if(me){Zt(),Oe(!0);return}T&&(Xt.current=T),Hn.current&&window.clearTimeout(Hn.current),Hn.current=window.setTimeout(async()=>{if(Re.current){console.log("[Drive][Desktop] skip auto-upload (sync lock)",{reason:Xt.current||T});return}Re.current=!0;const V=$t.current;if(!a.uploadFile||!a.downloadFile||!a.listFiles){Re.current=!1;return}try{p(!0),w(`Auto upload${Xt.current?` (${Xt.current})`:""}…`),console.log("[DriveSync] auto-upload start",{reason:Xt.current||T});const de=await it(se.id,{silent:!0});if(de!=null&&de.revisionId&&de.revisionId!==pe.current){const Ve=await a.downloadFile(se.id),He=Ve==null?void 0:Ve.data;if(He)try{const Ye=typeof He=="string"?JSON.parse(He):He;if(Un()){if(Pt(Ye,{preserveCurrent:!0})){Ye!=null&&Ye.lastEditedPeriodId&&(Ye==null?void 0:Ye.lastWriter)!=="desktop"&&Ut(String(Ye.lastEditedPeriodId)),(Ye==null?void 0:Ye.lastWriter)==="mobile"&&(Ye!=null&&Ye.lastEditedDate)&&le(en=>en+1),r(et()),pe.current=de.revisionId,er.current=Date.now(),Te((Ye==null?void 0:Ye.lastWriter)||"unknown");const Vn=new Date().toISOString();C(Vn),w(`Pulled latest at ${new Date(Vn).toLocaleTimeString()}`),le(en=>en+1)}}else console.log("[Drive][Desktop] skip pull during auto-upload")}catch{}}const he=et().currentId,Ge=ar(he!=null?String(he):null,null),at=JSON.stringify({periodsState:Ge.periodsState,students:Ge.students,tags:Ge.tags,layouts:Ge.layouts,constraintsState:Ge.constraintsState,historyState:Ge.historyState,groupingsState:Ge.groupingsState});if(Rt.current===at)w("No changes to push.");else{const Ve={...Ge,lastWriter:"desktop",updatedAt:new Date().toISOString()},He=await a.uploadFile({fileId:se.id,content:JSON.stringify(Ve,null,2)});if(He!=null&&He.error)throw new Error(He.error);const Ye=Nn(He==null?void 0:He.file);Ye&&(B(Ye),Ye.revisionId&&(pe.current=Ye.revisionId)),Rt.current=at;const cn=new Date().toISOString();vn.current=Date.now(),C(cn),Te("desktop"),w(`Auto upload complete at ${new Date(cn).toLocaleTimeString()}`),console.log("[DriveSync] auto-upload complete",{reason:Xt.current||T,at:cn}),$t.current===V?(Ze.current=!1,console.log("[Drive][Desktop] dirty cleared after upload",{dirtySeq:$t.current,uploadSeq:V})):(Ze.current=!0,console.log("[Drive][Desktop] not clearing dirty after upload (new edits)",{uploadSeq:V,currentSeq:$t.current}))}}catch{}finally{p(!1),Xt.current=null,Re.current=!1}},1200)}},[se,Pt,a,c,u.connected,Re,it,r,Un]);d.useEffect(()=>{const T=["newui_periods_state","newui_students_state_v1","newui_tags_state_v1","newui_constraints_v1","newui_groupings_v1","newui_history_v1","newui_drive_dirty_reason","newui_app_state"],V=de=>{!de.key||!T.includes(de.key)||(Zt(),qt())};return window.addEventListener("storage",V),()=>{window.removeEventListener("storage",V),Hn.current&&window.clearTimeout(Hn.current)}},[Zt,qt]),d.useEffect(()=>{me&&Ze.current&&Oe(!0)},[me]),d.useEffect(()=>{if(typeof window>"u"||wt.current)return;const T=["newui_periods_state","newui_students_state_v1","newui_tags_state_v1","newui_constraints_v1","newui_history_v1","newui_groupings_v1","newui_app_state","newui_drive_dirty_reason"];return wt.current=window.localStorage.setItem.bind(window.localStorage),window.localStorage.setItem=(V,de)=>{const he=wt.current?wt.current(V,de):void 0;return T.includes(V)&&(Zt(),qt()),he},()=>{wt.current&&(window.localStorage.setItem=wt.current)}},[Zt,qt]),d.useEffect(()=>{const T=V=>{const de=(V==null?void 0:V.detail)||"force";Zt(de),qt(de)};return window.addEventListener("newui_drive_force_push",T),()=>window.removeEventListener("newui_drive_force_push",T)},[Zt,qt]),d.useEffect(()=>{const T=window.setInterval(()=>{Ze.current&&!A&&!k&&!Re.current&&qt("interval")},8e3);return()=>window.clearInterval(T)},[A,Re,k,qt]),d.useEffect(()=>{const T=window.setInterval(async()=>{if(Mn.current||Re.current){console.log("[Drive][Desktop] skip heartbeat (sync lock/running)",{running:Mn.current,syncLock:Re.current});return}if(!(!c||!u.connected||!(se!=null&&se.id))&&!me){if(Ze.current||A||k){console.log("[Drive][Desktop] skip auto-pull (dirty or syncing)",{dirty:Ze.current,syncing:Re.current||k||A});return}if(!(!a.downloadFile||!a.uploadFile)){Mn.current=!0,Re.current=!0;try{const V=await it(se.id,{silent:!0});if(V!=null&&V.revisionId&&V.revisionId!==pe.current){const at=await a.downloadFile(se.id),Ve=at==null?void 0:at.data;if(Ve)try{const He=typeof Ve=="string"?JSON.parse(Ve):Ve;if(Un()){if(Pt(He,{preserveCurrent:!0})){He!=null&&He.lastEditedPeriodId&&(He==null?void 0:He.lastWriter)!=="desktop"&&Ut(String(He.lastEditedPeriodId)),r(et()),pe.current=V.revisionId,er.current=Date.now(),Te((He==null?void 0:He.lastWriter)||"unknown");const cn=new Date().toISOString();C(cn),w(`Pulled latest at ${new Date(cn).toLocaleTimeString()}`),le(Vn=>Vn+1)}}else console.log("[Drive][Desktop] skip heartbeat apply (guard/freshness)")}catch{}}const de=et().currentId,he=ar(de!=null?String(de):null,null),Ge=JSON.stringify({periodsState:he.periodsState,students:he.students,tags:he.tags,layouts:he.layouts,constraintsState:he.constraintsState,historyState:he.historyState,groupingsState:he.groupingsState});if(Rt.current!==Ge){const at={...he,lastWriter:"desktop",updatedAt:new Date().toISOString()},Ve=await a.uploadFile({fileId:se.id,content:JSON.stringify(at,null,2)}),He=Nn(Ve==null?void 0:Ve.file);He!=null&&He.revisionId&&(pe.current=He.revisionId),Rt.current=Ge;const Ye=new Date().toISOString();vn.current=Date.now(),C(Ye),Te("desktop"),w(`Auto sync at ${new Date(Ye).toLocaleTimeString()}`)}}catch(V){console.log("[DriveSync] heartbeat error",V)}finally{Mn.current=!1,Re.current=!1}}}},9e3);return()=>window.clearInterval(T)},[se,Pt,A,a,c,u.connected,Re,k,it,r,Un]),d.useCallback(async T=>{if(!a.importFile||!a.downloadFile){D("Import requires the desktop helper.");return}O(!0),R(null);try{const V=await a.importFile({fileId:T.id,name:T.name});if(V!=null&&V.error)throw new Error(V.error);const de=Nn((V==null?void 0:V.file)||V);if(!de)throw new Error("Import failed.");const he=await a.downloadFile(de.id);if(he!=null&&he.error)throw new Error(he.error);const Ge=he==null?void 0:he.data,at=typeof Ge=="string"?JSON.parse(Ge):Ge;if(Pt(at,{preserveCurrent:!1}))B(de),ge(de),l({tone:"success",message:`Imported and loaded ${de.name}.`});else throw new Error("Imported file could not be parsed.");await qe()}catch(V){const de=(V==null?void 0:V.message)||"Import failed.";R(de),l({tone:"error",message:de})}finally{O(!1)}},[Pt,a,qe,l]);const rs=d.useCallback(async()=>{if(!c){w("Drive sync is only available in the desktop helper.");return}if(!u.connected){w("Connect to Google Drive first.");return}if(!(se!=null&&se.id)){w("Select a cloud file before syncing."),G(!0);return}if(Re.current){w("Sync already running.");return}if(!a.downloadFile||!a.uploadFile){w("Drive sync helpers are unavailable.");return}Re.current=!0,_(!0),console.log("[Drive][Desktop] manual sync",{dirty:Ze.current,mode:Ze.current?"push":"pull"}),w(null);try{const T=$t.current;if(Ze.current){const de={...ar(),lastWriter:"desktop",updatedAt:new Date().toISOString()},he=await a.uploadFile({fileId:se.id,content:JSON.stringify(de,null,2)});if(he!=null&&he.error)throw new Error(he.error);const Ge=Nn(he==null?void 0:he.file);Ge&&B(Ge),Ge!=null&&Ge.revisionId&&(pe.current=Ge.revisionId);const at=new Date().toISOString();vn.current=Date.now(),C(at),Te("desktop"),w("Synced with Google Drive."),l({tone:"success",message:"Local changes saved to Drive."}),$t.current===T?(Ze.current=!1,console.log("[Drive][Desktop] dirty cleared after upload",{dirtySeq:$t.current,uploadSeq:T})):(Ze.current=!0,console.log("[Drive][Desktop] not clearing dirty after manual sync (new edits)",{uploadSeq:T,currentSeq:$t.current}))}else{const V=await it(se.id,{silent:!0});if(V!=null&&V.revisionId){const de=await a.downloadFile(se.id);if(de!=null&&de.error)throw new Error(de.error);const he=de==null?void 0:de.data;if(!he)throw new Error("Drive returned an empty file.");const Ge=typeof he=="string"?JSON.parse(he):he;Un()?Pt(Ge,{preserveCurrent:!0})&&(r(et()),le(He=>He+1),C(new Date().toISOString()),er.current=Date.now(),Te((Ge==null?void 0:Ge.lastWriter)||"unknown"),l({tone:"info",message:"Latest Drive data loaded into ClassSeats."})):console.log("[Drive][Desktop] skip apply on manual sync (dirty/syncing)");const at=Nn(V.file||V);at&&B(at),V.revisionId&&(pe.current=V.revisionId)}}}catch(T){w((T==null?void 0:T.message)||"Sync failed."),l({tone:"error",message:(T==null?void 0:T.message)||"Sync failed."})}finally{_(!1),Re.current=!1}},[se,Pt,c,a,u.connected,Re,Zt,it,Un,l]);d.useEffect(()=>{if(me||!Le||!c||!u.connected||!(se!=null&&se.id)||k)return;(async()=>{w("Reconnected — syncing pending changes…"),await rs(),Oe(!1)})()},[me,Le,c,u.connected,se,k,rs]),d.useEffect(()=>{se!=null&&se.revisionId&&(pe.current=se.revisionId)},[se]),d.useEffect(()=>{if(!c||!u.connected||!(se!=null&&se.id)||me)return;const T=window.setInterval(async()=>{try{X(!0);const V=await it(se.id,{silent:!0});if(V!=null&&V.revisionId&&V.revisionId!==pe.current){const de=a.downloadFile?await a.downloadFile(se.id):null;if(de!=null&&de.data)try{const he=typeof de.data=="string"?JSON.parse(de.data):de.data;Pt(he,{preserveCurrent:!0})&&(r(et()),le(at=>at+1),C(new Date().toISOString()),er.current=Date.now(),Te((he==null?void 0:he.lastWriter)||"unknown")),pe.current=V.revisionId,l({tone:"info",message:"Updated from Drive."})}catch{}}}catch{}finally{X(!1)}},2e4);return()=>window.clearInterval(T)},[c,u.connected,se,me,it,Pt,l,a]);const bn=()=>{if(!window.confirm(`Start New Semester?

This will clear all data (layouts, periods, students, tags, constraints, history, and saved groupings) from this browser.

Consider clicking Save first to back up your work.`))return;["newui_app_state","newui_periods_state","newui_students_state_v1","newui_tags_state_v1","newui_constraints_v1","newui_history_v1","newui_groupings_v1"].forEach(de=>window.localStorage.removeItem(de)),window.location.reload()},Br=Av,tr=`https://api.qrserver.com/v1/create-qr-code/?size=260x260&data=${encodeURIComponent(Br)}`;return s.jsx(s.Fragment,{children:s.jsxs("div",{className:"min-h-screen bg-indigo-50",children:[s.jsxs("div",{className:"sticky top-0 z-30",children:[me&&s.jsxs("div",{className:"bg-amber-100 border-b border-amber-300 text-amber-900 text-sm px-4 py-2 text-center",children:["Drive save paused while offline. Local saves only. Last sync:"," ",b?new Date(b).toLocaleTimeString():"none yet","."]}),!me&&Le&&s.jsxs("div",{className:"bg-emerald-50 border-b border-emerald-200 text-emerald-800 text-sm px-4 py-2 text-center",children:["Pending Drive sync will run shortly. Last sync:"," ",b?new Date(b).toLocaleTimeString():"none yet","."]}),s.jsxs("div",{className:"bg-emerald-50 border-b border-emerald-200 text-emerald-900 text-sm px-4 py-2 text-center",children:[s.jsx("span",{role:"img","aria-label":"lock",className:"mr-2",children:"🔒"}),s.jsx("span",{className:"font-semibold mr-2",children:"Privacy:"}),"Data stays on this computer and in your Google Drive. Use your school Google account. No data is sent to our servers."]}),s.jsx("div",{className:"w-full bg-white border-b border-slate-200 text-slate-800",children:s.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-2 flex flex-wrap items-center gap-3 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${me?"bg-rose-100 text-rose-800":"bg-emerald-100 text-emerald-800"}`,children:me?"Offline":"Online"}),s.jsx("span",{className:"font-semibold",children:"Cloud Sync (Google Drive):"}),s.jsx("span",{children:u.connected?((Wr=u.profile)==null?void 0:Wr.email)||"Signed in":"Not signed in"}),s.jsx("span",{className:"text-slate-500",children:"•"}),s.jsx("span",{children:(se==null?void 0:se.name)||(H==null?void 0:H.name)||"No file selected"}),b&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-slate-500",children:"•"}),s.jsxs("span",{children:["Last sync ",new Date(b).toLocaleTimeString()]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-1 justify-end",children:[me&&s.jsx("span",{className:"px-2 py-1 rounded-full bg-amber-100 text-amber-800 text-xs font-semibold",children:"Offline — Drive paused"}),Le&&!me&&s.jsx("span",{className:"px-2 py-1 rounded-full bg-emerald-100 text-emerald-800 text-xs font-semibold",children:"Pending sync"}),s.jsx("button",{className:"px-3 py-1 rounded bg-indigo-100 text-indigo-700 text-xs font-semibold hover:bg-indigo-200",onClick:()=>U(!0),children:"Mobile QR"}),s.jsx("button",{className:"px-3 py-1 rounded bg-sky-100 text-sky-700 text-xs font-semibold hover:bg-sky-200 disabled:opacity-60",onClick:()=>void rs(),disabled:!u.connected||!se||k||me,children:k?"Syncing…":"Sync Now"}),s.jsx("button",{className:"px-3 py-1 rounded bg-emerald-600 text-white text-xs font-semibold disabled:opacity-60",onClick:()=>u.connected?G(!0):Fe(),disabled:me,children:u.connected?"Manage Drive (Load/Save)":"Connect to Drive"}),u.connected&&s.jsx("button",{className:"px-3 py-1 rounded bg-rose-100 text-rose-700 text-xs font-semibold hover:bg-rose-200 disabled:opacity-60",onClick:()=>void Ie(),disabled:me,children:"Disconnect"}),j&&!me&&s.jsx("span",{className:"text-rose-600 text-xs",children:j})]})]})})]}),s.jsxs("div",{className:"fixed top-2 left-2 z-50 flex items-center gap-2",children:[s.jsxs("div",{className:"text-[11px] px-2 py-1 rounded bg-white/80 border border-slate-200 text-slate-700 shadow",children:["Rev ",Lv]}),s.jsx("button",{className:"text-[11px] px-3 py-1 rounded bg-rose-100 text-rose-800 border border-rose-300 shadow hover:bg-rose-200",onClick:Xe,children:"New File"})]}),re&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>ie(!1)}),s.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-lg font-semibold text-slate-900",children:"Create New File"}),s.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>ie(!1),children:"✕"})]}),s.jsx("p",{className:"text-sm text-slate-600",children:"Name your new ClassSeats file. Your current file will remain untouched."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"File name"}),s.jsx("input",{type:"text",className:"w-full rounded border border-slate-300 px-3 py-2 text-sm",value:we,onChange:T=>ee(T.target.value),placeholder:"e.g., Semester 2 24-25",autoFocus:!0}),ye&&s.jsx("p",{className:"text-xs text-rose-600",children:ye})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{className:"px-4 py-2 rounded bg-slate-200 text-slate-800 font-semibold",onClick:()=>ie(!1),disabled:ze,children:"Cancel"}),s.jsx("button",{className:"px-4 py-2 rounded bg-emerald-600 text-white font-semibold disabled:opacity-60",onClick:()=>void Qe(),disabled:ze,children:ze?"Creating…":"Create & Switch"})]})]})]}),M&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center px-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[80vh] flex flex-col",children:[s.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b border-slate-200 px-4 py-3 flex items-center justify-between gap-2",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-indigo-700",children:"Google Drive Files"}),s.jsx("p",{className:"text-sm text-slate-500",children:"Choose a cloud file (semester) or create a new one."})]}),s.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>G(!1),children:"✕"})]}),s.jsxs("div",{className:"px-4 pt-3 pb-2 border-b border-slate-200 bg-white flex flex-wrap gap-2",children:[s.jsx("button",{className:"rounded-lg px-3 py-1 text-sm font-semibold bg-slate-100 text-slate-700 hover:bg-slate-200 disabled:opacity-60",onClick:()=>void qe(),disabled:x,children:x?"Refreshing…":"Refresh"}),(se==null?void 0:se.id)&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"rounded-lg px-3 py-1 text-sm font-semibold bg-indigo-600 text-white hover:bg-indigo-500",onClick:vt,children:"Open in Drive"}),s.jsx("button",{className:"rounded-lg px-3 py-1 text-sm font-semibold bg-slate-200 text-slate-800 hover:bg-slate-300",onClick:Ft,children:"Clear Active File"})]}),s.jsx("button",{className:"rounded-lg px-3 py-1 text-sm font-semibold bg-rose-100 text-rose-700 hover:bg-rose-200",onClick:()=>void Ie(),children:"Disconnect"})]}),s.jsx("div",{className:"px-4 py-4 flex-1 overflow-y-auto space-y-4",children:u.connected?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"relative bg-slate-50 border border-slate-200 rounded-xl p-3 max-h-56 overflow-auto space-y-2 min-h-[10rem]",children:[x&&s.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center text-sm text-slate-600 font-semibold rounded-xl",children:"Loading files…"}),N.length===0&&!x?s.jsx("p",{className:"text-sm text-slate-500",children:"No cloud files yet. Create one below to start syncing."}):N.map(T=>{const V=(H==null?void 0:H.id)===T.id,de=(se==null?void 0:se.id)===T.id;return s.jsxs("button",{className:"w-full text-left rounded-lg border px-3 py-2 transition "+(V?"border-indigo-400 bg-indigo-50 text-indigo-900":de?"border-emerald-400 bg-emerald-50 text-emerald-900":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>xn(T),children:[s.jsx("p",{className:"font-semibold text-sm",children:T.name}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Updated ",T.modifiedTime?new Date(T.modifiedTime).toLocaleString():"—",T.size?` • ${(Number(T.size)/1024).toFixed(1)} KB`:""]}),de&&s.jsx("p",{className:"text-[11px] text-emerald-600 font-semibold",children:"Currently active"})]},T.id)})]}),s.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[s.jsx("p",{className:"text-xs text-slate-500",children:"Select a file above, then click load to replace the data on this computer."}),s.jsx("button",{className:"px-4 py-2 rounded bg-indigo-600 text-white text-sm font-semibold disabled:opacity-60",onClick:an,disabled:!H||ne,children:ne?"Loading…":H?`Load "${H.name}"`:"Load Selected File"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-700",children:"Create a new cloud file from current data"}),s.jsxs("div",{className:"flex flex-col gap-2 md:flex-row",children:[s.jsx("input",{type:"text",value:Y,onChange:T=>ce(T.target.value),placeholder:"e.g., Semester 2 24-25",className:"flex-1 rounded border border-slate-300 px-2 py-1 text-sm"}),s.jsx("button",{className:"px-4 py-2 rounded bg-emerald-600 text-white text-sm font-semibold disabled:opacity-60",onClick:Ts,disabled:$e,children:$e?"Creating…":"Create Cloud File"})]})]}),v&&s.jsx("p",{className:"text-sm text-rose-600",children:v})]}):s.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3 text-sm text-amber-900",children:"Connect to Google Drive first, then reopen this window to manage cloud files."})}),s.jsx("div",{className:"sticky bottom-0 z-10 bg-white border-t border-slate-200 px-4 py-3 flex justify-end",children:s.jsx("button",{className:"px-4 py-2 rounded bg-slate-200 text-slate-800 font-semibold",onClick:()=>G(!1),children:"Close"})})]})}),J&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>U(!1)}),s.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-lg font-semibold text-slate-900",children:"Open Mobile App"}),s.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>U(!1),children:"✕"})]}),s.jsx("p",{className:"text-sm text-slate-700",children:"1) Scan this code on your phone. 2) Tap “Open link” and add to your home screen for quick access. 3) Use the same Google Drive file on desktop and mobile."}),s.jsx("div",{className:"flex justify-center",children:s.jsx("div",{className:"bg-slate-100 rounded-xl p-3",children:s.jsx("img",{src:tr,alt:"Mobile QR",className:"w-48 h-48"})})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-xs text-slate-600 break-all",children:Br}),s.jsx("button",{className:"w-full rounded bg-emerald-600 text-white font-semibold py-2",onClick:()=>window.open(Br,"_blank"),children:"Open Mobile Link"})]})]})]}),s.jsx("header",{className:"w-full bg-gradient-to-r from-violet-600 to-indigo-600 text-white",children:s.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-4 flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[s.jsxs("h1",{className:"text-xl md:text-2xl font-extrabold tracking-wide",children:[s.jsx("span",{role:"img","aria-label":"class icon",children:"👥"})," ClassSeats: Smart Classroom Seating"]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("button",{className:"px-3 py-2 rounded bg-orange-500 hover:bg-orange-400 font-semibold",onClick:bn,children:"🧹 Start New Semester"})})]})}),s.jsx("div",{className:"w-full bg-white border-b border-slate-200",children:s.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-3 flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Local Backup (optional)"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Manual import/export of a JSON backup. Does not sync."})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("input",{ref:o,type:"file",accept:".json,application/json",className:"hidden",onChange:async T=>{var de;const V=(de=T.target.files)==null?void 0:de[0];if(V)try{const he=await V.text(),Ge=JSON.parse(he);Pt(Ge),l({tone:"success",message:"Local file imported."})}catch(he){alert("Failed to load file: "+((he==null?void 0:he.message)||String(he)))}}}),s.jsx("button",{className:"px-3 py-1 rounded bg-slate-900 text-white text-sm font-semibold hover:bg-slate-800",onClick:Ae,children:"Import Local File"}),s.jsx("button",{className:"px-3 py-1 rounded bg-slate-100 text-slate-800 text-sm font-semibold hover:bg-slate-200",onClick:fe,children:"Export Local Backup"})]})]})}),s.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[s.jsxs("div",{className:"mt-2 flex items-center justify-between bg-white rounded-b border-b border-slate-200",children:[s.jsx("nav",{className:"flex gap-2",children:_v.map(T=>s.jsxs("button",{onClick:()=>t(T),className:"px-4 py-2 border-b-2 "+(e===T?"border-indigo-600 text-indigo-700 font-semibold":"border-transparent text-slate-600 hover:bg-slate-50"),children:[T==="room"&&s.jsxs("span",{className:"inline-flex items-center gap-2",children:[s.jsx("span",{role:"img","aria-label":"room setup",children:"🧭"})," Room Setup"]}),T==="students"&&s.jsxs("span",{className:"inline-flex items-center gap-2",children:[s.jsx("span",{role:"img","aria-label":"students",children:"👥"})," Students"]}),T==="grouping"&&s.jsxs("span",{className:"inline-flex items-center gap-2",children:[s.jsx("span",{role:"img","aria-label":"groups",children:"▶️"})," Groups"]}),T==="attendance"&&s.jsxs("span",{className:"inline-flex items-center gap-2",children:[s.jsx("span",{role:"img","aria-label":"attendance",children:"📝"})," Attendance & Behavior"]}),T==="history"&&s.jsxs("span",{className:"inline-flex items-center gap-2",children:[s.jsx("span",{role:"img","aria-label":"history",children:"📊"})," History"]}),T==="reports"&&s.jsxs("span",{className:"inline-flex items-center gap-2",children:[s.jsx("span",{role:"img","aria-label":"reports",children:"📄"})," Reports"]})]},T))}),s.jsx("div",{className:"flex items-center gap-2"})]}),s.jsx("div",{className:"py-4",children:e==="room"?s.jsx(Vx,{}):e==="students"?s.jsx(r0,{}):e==="grouping"?s.jsx(E0,{}):e==="attendance"?s.jsx(B0,{},K):e==="history"?s.jsx(G0,{}):e==="reports"?s.jsx(V0,{}):s.jsxs("div",{className:"card p-6 text-slate-700",children:[s.jsx("p",{className:"mb-2 font-semibold",children:"PLACEHOLDER"}),s.jsx("p",{className:"text-sm",children:"This section will be implemented per REBUILD_PLAN.md phases."})]})},K)]})]})})}const Hu=!1,zv="201",bl="cs_mobile_last_drive_file";function Bv(){var xd,vd,bd;const e=Pm(),[t,n]=d.useState(null),[r,o]=d.useState([]),[l,i]=d.useState(!1),[a,c]=d.useState(null),[u,m]=d.useState(null),[E,S]=d.useState(!1),[j,L]=d.useState(null),[N,W]=d.useState(!1),[x,f]=d.useState([]),[v,D]=d.useState(""),[M,G]=d.useState(!1),[J,U]=d.useState(!1),[te,ae]=d.useState(null),[Y,ce]=d.useState(null),[$e,xe]=d.useState(!1),[H,ge]=d.useState(null),[ne,h]=d.useState(null),[k,_]=d.useState({}),[A,p]=d.useState({}),[P,w]=d.useState({}),[b,C]=d.useState({}),[I,q]=d.useState(null),[K,le]=d.useState({note:"",delta:0,reason:""}),[je,Te]=d.useState(""),[me,Pe]=d.useState({pointsEnabled:!1,startingPoints:50,currentPoints:0,predictedPoints:0}),[Le,Oe]=d.useState({}),[F,oe]=d.useState(null),[$,O]=d.useState(0),[y,R]=d.useState(null),[z,X]=d.useState(""),[re,ie]=d.useState(null),[we,ee]=d.useState([]),[ze,Ce]=d.useState(!1),[ye,Ee]=d.useState(null),[pe,se]=d.useState(!1),[B,fe]=d.useState(null),[Ae,Ke]=d.useState(null),[Qe,Xe]=d.useState(!1),[rt,it]=d.useState(null),[Fe,Ie]=d.useState(!1),[Ft,vt]=d.useState(null),[qe,Pt]=d.useState(!navigator.onLine),Ts=d.useRef(!1),xn=d.useRef(!1),an=d.useRef(!1),Ze=d.useRef(null),$t=()=>{const g=new Date,Q=g.getFullYear(),Z=String(g.getMonth()+1).padStart(2,"0"),ve=String(g.getDate()).padStart(2,"0");return`${Q}-${Z}-${ve}`},[Re,vn]=d.useState($t()),[Hn,er]=d.useState("table"),[wt,Xt]=d.useState(!1),Mn=d.useRef(0),Rt=d.useRef(null),zr=d.useRef({}),Zt=d.useRef(null),[Un,qt]=d.useState(!1),rs=d.useRef(0),bn=d.useRef(null),Br=1500,tr=d.useRef(null),Wr=d.useCallback(g=>g?zr.current[g]??null:null,[]),T=d.useCallback((g,Q)=>{g&&(zr.current[g]=Q||null)},[]),V=d.useRef(0),[de,he]=d.useState("unknown"),[Ge,at]=d.useState(0);d.useCallback(async()=>{const g=await No(t);return g&&n(g),g},[t]);const Ve=d.useCallback(g=>{const Q=`${new Date().toISOString()} ${g}`;f(Z=>[Q,...Z].slice(0,200))},[]),He=d.useCallback(async()=>{var Q;const g=await xv();if(L(g),Ve(`startup info: state=${g.state} sessionLoaded=${g.sessionLoaded} hasRefresh=${g.hasRefresh} expiresAt=${g.expiresAt} source=${g.source} lastWriteAt=${g.lastWriteAt} lastWriteReason=${g.lastWriteReason}`),g.state==="ok"){const Z=await Am();Z&&(n(Z),(Q=Z.profile)!=null&&Q.email&&m(null))}return g},[Ve]),Ye=d.useCallback(async g=>{const Q=(t==null?void 0:t.expiresAt)||null,Z=await No(t);return Ve(`${g}: ensureFreshDriveSession ok=${!!Z} before=${Q} new=${Z==null?void 0:Z.expiresAt} hasRefresh=${!!(Z!=null&&Z.refreshToken)}`),Z&&(n(Z),S(!1)),Z},[t,Ve]),cn=d.useCallback(()=>{rs.current+=1,bn.current&&window.clearTimeout(bn.current),bn.current=window.setTimeout(()=>{rs.current=0,bn.current=null},2e3),rs.current>=5&&(W(g=>!g),rs.current=0,bn.current&&(window.clearTimeout(bn.current),bn.current=null))},[]);d.useEffect(()=>()=>{bn.current&&window.clearTimeout(bn.current)},[]),d.useEffect(()=>{const g=()=>Pt(!navigator.onLine);return window.addEventListener("online",g),window.addEventListener("offline",g),()=>{window.removeEventListener("online",g),window.removeEventListener("offline",g)}},[]),d.useEffect(()=>{ne&&(_(ne.periods.reduce((g,Q)=>{var Z;return g[Q.id]=(Z=Q.attendance)!=null&&Z[Re]?{...Q.attendance[Re]}:{},g},{})),p(ne.periods.reduce((g,Q)=>(g[Q.id]=fd(Q.behaviorNotes,Re),g),{})))},[ne,Re]);const Vn=d.useCallback(g=>{const Q={};return!g||typeof g!="object"||Object.entries(g).forEach(([Z,ve])=>{if(!ve||typeof ve!="object")return;const ke={},We=ve.note&&typeof ve.note=="object"?ve.note:ve;Object.entries(We).forEach(([Me,De])=>{De&&typeof De=="object"&&typeof De.note=="string"&&(ke[String(Me)]={note:De.note,timestamp:De.timestamp||new Date().toISOString()})}),Object.keys(ke).length>0&&(Q[Z]=ke)}),Q},[]),en=g=>e({tone:"success",message:g}),nt=g=>e({tone:"error",message:g}),bt=g=>e({tone:"info",message:g}),os=["unmarked","absent","tardy","left_early","present"],Qo=g=>{switch(g){case"present":return"bg-emerald-50 border-emerald-100";case"absent":return"bg-rose-50 border-rose-100";case"tardy":return"bg-amber-50 border-amber-100";case"left_early":return"bg-blue-50 border-blue-100";default:return"bg-slate-50 border-slate-200"}},fd=(g,Q)=>{const Z=g==null?void 0:g[Q];if(!Z||typeof Z!="object")return{};const ve=Z.note&&typeof Z.note=="object"?Z.note:Z,ke={};return Object.entries(ve||{}).forEach(([We,Me])=>{Me&&typeof Me=="object"&&typeof Me.note=="string"&&(ke[String(We)]=Me.note)}),ke},pd=g=>{switch(g){case"present":return"Present";case"absent":return"Absent";case"tardy":return"Tardy";case"left_early":return"Left Early";default:return"Unmarked"}},Jo=g=>g>=45?"🟢":g>=35?"🟡":g>=25?"🟠":"🔴",Ds=d.useCallback((g,Q)=>{var Me,De;if(!((Me=g==null?void 0:g.periodsState)!=null&&Me.periods)||!(g!=null&&g.students))return!1;const Z=JSON.stringify((De=g.periodsState)==null?void 0:De.periods);Mn.current=0,xn.current=!1,an.current=!1,Xt(!1),Ie(!1),vt(null),qt(!1),Ze.current&&(window.clearTimeout(Ze.current),Ze.current=null);const ve=(g.layouts||[]).reduce((be,Be)=>(be[String(Be.id)]={id:String(Be.id),name:Be.name,tables:(Be.tables||[]).map(ot=>({id:String(ot.id),name:ot.name||"Table"}))},be),{}),ke=g.periodsState.periods.map(be=>({id:String(be.id),name:be.name,layoutId:be.layoutId||null,tableAssignments:be.tableAssignments||{},activeGrouping:be.activeGrouping||[],attendance:be.attendance||{},behaviorNotes:Vn(be.behaviorNotes),pointsByStudent:be.pointsByStudent||{},pointsEnabled:be.pointsEnabled??!1,startingPoints:be.startingPoints??50,pointsHistory:be.pointsHistory||[]})),We=(g.students||[]).map(be=>{var Be;return{id:String(be.id),fullName:be.fullName||be.name||"Student",periodIds:((Be=be.periodIds)==null?void 0:Be.map(ot=>String(ot)))||[]}});return h({periods:ke,students:We,layouts:ve}),ie(be=>{var ct;const Be=be?String(be):null,ot=g.periodsState.currentId?String(g.periodsState.currentId):null;return[Be,ot,((ct=ke[0])==null?void 0:ct.id)||null].filter(Boolean).find(dt=>ke.some(Kn=>String(Kn.id)===dt))||null}),_(ke.reduce((be,Be)=>{var ot;return be[Be.id]=(ot=Be.attendance)!=null&&ot[Re]?{...Be.attendance[Re]}:{},be},{})),p(ke.reduce((be,Be)=>(be[Be.id]=fd(Be.behaviorNotes,Re),be),{})),w(ke.reduce((be,Be)=>{var Ne;const ot=Be.pointsByStudent?{...Be.pointsByStudent}:{};return Be.pointsEnabled&&((Ne=Be.studentsIds)==null||Ne.forEach(_e=>{ot[_e]===void 0&&(ot[_e]=Be.startingPoints??50)})),be[Be.id]=ot,be},{})),Zt.current=Z,he((g==null?void 0:g.lastWriter)||"unknown"),Q?(Rt.current=Q.id,ce(Q),T(Q.id,Q.revisionId||null)):T(Rt.current,null),it(null),at(be=>be+1),!0},[Re,T]),Rn=d.useCallback(()=>{Mn.current+=1,tr.current=Date.now(),Xt(!0),Ie(!0)},[]),$i=d.useCallback((g,Q,Z)=>{_(ve=>{const ke={...ve||{}};return ke[g]={...ke[g]||{}},Z==="unmarked"?delete ke[g][Q]:ke[g][Q]=Z,ke}),Rn()},[Rn]);d.useCallback((g,Q)=>{var We;const Z=((We=k[g])==null?void 0:We[Q])||"unmarked",ve=os.indexOf(Z),ke=os[(ve+1)%os.length];$i(g,Q,ke)},[k,$i,os]);const Xo=d.useCallback((g,Q)=>{_(Z=>{const ve={...Z||{}};return ve[g]={...ve[g]||{}},Q.forEach(ke=>{ve[g][ke]||(ve[g][ke]="present")}),ve}),Rn()},[Rn]),Vm=d.useCallback((g,Q,Z,ve)=>{if(Z===0||Q.length===0)return;const ke=(ve==null?void 0:ve.trim())||"Bulk points update",We=ne==null?void 0:ne.periods.find(De=>De.id===g),Me=(We==null?void 0:We.startingPoints)??50;w(De=>{const be={...De||{}};return be[g]={...be[g]||{}},Q.forEach(Be=>{const ot=be[g][Be]??Me;be[g][Be]=Math.max(0,ot+Z)}),be}),C(De=>{const be={...De||{}},Be=be[g]?[...be[g]]:[];return Q.forEach(ot=>Be.push({studentId:ot,delta:Z,reason:ke,date:Re})),be[g]=Be,be}),Rn()},[ne==null?void 0:ne.periods,Re,Rn]),md=d.useCallback(g=>{_(Q=>{const Z={...Q||{}};return Z[g]={},Z}),bt("Reset attendance to unmarked for this date."),Rn()},[bt,Rn]),Km=d.useCallback(()=>{if(!I)return;const{periodId:g,studentId:Q}=I,{note:Z,delta:ve,reason:ke}=K,We=me;if(We.pointsEnabled&&ve!==0&&!ke.trim()){nt("Please provide a reason when changing points.");return}p(Me=>{const De={...Me||{}};return De[g]={...De[g]||{}},Z.trim()?De[g][Q]=Z.trim():delete De[g][Q],De}),We.pointsEnabled&&ve!==0&&(w(Me=>{const De={...Me||{}};De[g]={...De[g]||{}};const be=De[g][Q]??We.startingPoints??0,Be=Math.max(0,be+ve);return De[g][Q]=Be,De}),C(Me=>{const De={...Me||{}},be=De[g]?[...De[g]]:[];return be.push({studentId:Q,delta:ve,reason:ke||"Behavior note",date:Re}),De[g]=be,De})),Rn(),q(null),le({note:"",delta:0,reason:""})},[I,K,me,Rn,p,w,nt]),gd=d.useCallback((g,Q,Z)=>{var De,be;const ve=((De=A[g])==null?void 0:De[Q])||"",ke=ne==null?void 0:ne.periods.find(Be=>Be.id===g),We=(ke==null?void 0:ke.startingPoints)??50,Me=((be=P[g])==null?void 0:be[Q])??We;le({note:ve,delta:0,reason:""}),Pe({pointsEnabled:!!(ke!=null&&ke.pointsEnabled),startingPoints:We,currentPoints:Me,predictedPoints:Me}),q({periodId:g,studentId:Q,studentName:Z})},[A,P,ne]),Ym=d.useCallback((g,Q,Z)=>{gd(g,Q,Z)},[gd]);d.useEffect(()=>{let g=!0;return(async()=>{await He();const Z=await Bm().catch(()=>null);if(!Z||!g)return;const ve=await No(Z),ke=ve||Z;if(Ve(`startup refresh result: ok=${!!ve} expiresAt=${ve==null?void 0:ve.expiresAt}`),n(ke),!Ts.current){Ts.current=!0;try{const We=localStorage.getItem(bl);if(!We)return;const Me=JSON.parse(We);if(Me!=null&&Me.id&&(Me!=null&&Me.name)){const De={id:Me.id,name:Me.name,modifiedTime:Me.modifiedTime,size:Me.size,revisionId:Me.revisionId};ae(De),m(`Restoring ${De.name}…`);const be=await Sr(Z.accessToken,De.id),Be=typeof be=="string"?JSON.parse(be):be;Ds(Be,De)&&(ce(De),m(`Loaded ${De.name} from Drive.`),it(new Date().toISOString()))}}catch(We){console.error("[Drive] Restore failed",We),m("Google sign-in failed. Please try again.")}}})(),()=>{g=!1}},[Ds,He]),d.useEffect(()=>{const g=window.setInterval(async()=>{if(!t)return;const Q=await Ye("timer");Q&&n(Q)},3e5);return()=>window.clearInterval(g)},[t,Ye]),d.useEffect(()=>{const g=async()=>{if(!t)return;const Q=await Ye("visibility");Q&&n(Q)};return document.addEventListener("visibilitychange",g),()=>document.removeEventListener("visibilitychange",g)},[t,Ye]),d.useEffect(()=>{if(l){const g=window.setTimeout(()=>{i(!1),c("Still loading Drive files. Try “Sign in with Google” then tap Refresh Cloud Files.")},12e3);return ge(g),()=>window.clearTimeout(g)}H&&(window.clearTimeout(H),ge(null)),Ze.current&&(window.clearTimeout(Ze.current),Ze.current=null)},[l,H]);const zt=d.useCallback(async(g,Q="preflight")=>{if(qe)return m("Offline — will sync when back online."),S(!0),Ve(`${Q}: offline; skipping refresh`),null;try{const Z=await Ye(Q);if(Z)return Z}catch(Z){console.warn("[Drive] refresh failed",Z),Ve(`${Q}: refresh failed ${(Z==null?void 0:Z.message)||Z}`)}if(!g)return S(!0),m("Reconnect to Google Drive to continue syncing."),Ve(`${Q}: interactive=false; would trigger OAuth if allowed`),null;Ve(`triggerOAuth: reason=${Q} hadSession=${!!t} hasRefresh=${!!(t!=null&&t.refreshToken)}`);try{await Fm()}catch(Z){nt((Z==null?void 0:Z.message)||"Google sign-in was cancelled.")}return null},[t,nt,qe,Ve,Ye]),Qm=d.useCallback(()=>{Wm(),n(null),o([]),ae(null),ce(null),m(null),bt("Signed out of Google Drive.")},[bt]),Jm=d.useCallback(async()=>{var g;!Y||!((g=window.desktopBridge)!=null&&g.uploadDriveFile)||confirm(`Delete ${Y.name} from Drive? This cannot be undone.`)&&(await window.desktopBridge.uploadDriveFile({fileId:Y.id,content:JSON.stringify({deleted:!0,message:"File deleted by user."})}),h(null),_({}),p({}),w({}),C({}),ce(null),ie(null),m("Deleted active file from Drive."))},[Y]);d.useCallback(async()=>{},[Ds,ce,T]);const Xm=d.useCallback(async(g=!0,Q=!1)=>{if(!(l&&!Q)){i(!0),c(null);try{const Z=await zt(g,"refreshFiles");if(!Z){c("Sign in with Google to view cloud files.");return}const ve=await ic(Z.accessToken);o(ve),m(null)}catch(Z){const ve=(Z==null?void 0:Z.message)||"Unable to load Drive files.";c(ve),nt(ve)}finally{i(!1)}}},[zt,nt,l]);d.useCallback(async()=>{Ce(!0),Ee(null);try{const g=await zt(!0,"importList");if(!g){Ee("Sign in first to import.");return}const Q=await Um(g.accessToken);ee(Q)}catch(g){const Q=(g==null?void 0:g.message)||"Unable to list Drive files.";Ee(Q),nt(Q)}finally{Ce(!1)}},[zt,nt]);const Zm=d.useCallback(async()=>{if(!te){c("Select a cloud file first.");return}if(xn.current){c("Sync in progress. Please wait.");return}if(wt||Fe)if(window.confirm("You have unsynced changes. Sync them to Drive before switching files? Click OK to sync, Cancel to discard changes.")){if(await _n({silent:!0}),wt||Fe){c("Sync did not complete. Try again before switching files.");return}}else{if(!window.confirm("Discard unsynced changes and load the selected file?"))return;Mn.current=0,Xt(!1),Ie(!1),vt(null)}const g=await zt(!0,"loadSelected");if(g){U(!0);try{const Q=await Sr(g.accessToken,te.id),Z=typeof Q=="string"?JSON.parse(Q):Q;if(!Ds(Z,te))throw new Error("File could not be parsed.");m(`Loaded ${te.name}. Data available locally.`),localStorage.setItem(bl,JSON.stringify({id:te.id,name:te.name,modifiedTime:te.modifiedTime,size:te.size,revisionId:te.revisionId})),en(`Loaded ${te.name} from Drive.`)}catch(Q){const Z=(Q==null?void 0:Q.message)||"Unable to load Drive file.";c(Z),nt(Z)}finally{U(!1)}}},[zt,te,nt,en,Ds,wt,Fe]),qm=d.useCallback(async()=>{const g=v.trim();if(!g){c("Enter a file name first.");return}const Q=await zt(!0,"createFile");if(Q){G(!0),c(null);try{const Z=ar(),ve=await ud(Q.accessToken,g,JSON.stringify(Z,null,2));o(ke=>[ve,...ke]),ce(ve),Rt.current=ve.id,T(ve.id,ve.revisionId||null),ae(ve),D(""),localStorage.setItem(bl,JSON.stringify({id:ve.id,name:ve.name,modifiedTime:ve.modifiedTime,size:ve.size,revisionId:ve.revisionId})),en(`Created ${ve.name} in Drive.`)}catch(Z){const ve=(Z==null?void 0:Z.message)||"Unable to create Drive file.";c(ve),nt(ve)}finally{G(!1)}}},[v,zt,nt,en]),_n=d.useCallback(async g=>{var ve,ke,We,Me;if(xn.current||g!=null&&g.silent&&!wt)return;if(!((ve=ne==null?void 0:ne.periods)!=null&&ve.length)||!((ke=ne==null?void 0:ne.students)!=null&&ke.length)){m("Cannot sync until data is loaded. Open a file first.");return}if(qe){Ie(!0),vt("Offline - changes will sync when back online."),qt(!0);return}if(an.current){m("Sync already running.");return}an.current=!0;const Q=Mn.current,Z=await zt(!0,"syncUpload");if(!Z){an.current=!1;return}if(!Y){m("Select a cloud file before syncing."),an.current=!1;return}xn.current=!0,Xe(!0);try{const De=await Sr(Z.accessToken,Y.id),be=typeof De=="string"?JSON.parse(De):De;if(!((We=be==null?void 0:be.periodsState)!=null&&We.periods))throw new Error("Drive file missing periods.");const Be=(be.periodsState.periods||[]).map(ct=>{const dt=String(ct.id),Kn=k[dt]||{},yn=A[dt]||{},Ur=P[dt]||{},nr=Array.isArray(ct.pointsHistory)?[...ct.pointsHistory]:[],sr=b[dt]||[],Vr={...ct.attendance||{}};Vr[Re]=Kn;const Ms={...ct.behaviorNotes||{}};if(Object.keys(yn).length>0){const el=Ms[Re]?{...Ms[Re]}:{};Object.entries(yn).forEach(([yd,wd])=>{wd?el[yd]={note:wd,timestamp:new Date().toISOString()}:delete el[yd]}),Object.keys(el).length>0?Ms[Re]=el:delete Ms[Re]}return{...ct,attendance:Vr,behaviorNotes:Ms,pointsByStudent:Ur,pointsHistory:[...nr,...sr]}}),ot={...be,lastWriter:"mobile",lastEditedPeriodId:re?String(re):null,lastEditedDate:Re,updatedAt:new Date().toISOString(),periodsState:{...be.periodsState,periods:Be},students:be.students,tags:be.tags,layouts:be.layouts,constraintsState:be.constraintsState,historyState:be.historyState,groupingsState:be.groupingsState},Ne=JSON.stringify(ot,null,2),_e=await Hm(Z.accessToken,Y.id,Ne);C(ct=>{const dt={...ct||{}};return delete dt[re||""],dt}),_e&&(Zt.current=JSON.stringify(((Me=ot.periodsState)==null?void 0:Me.periods)||[]),T(_e.id,_e.revisionId||null),Rt.current=_e.id,ce(_e),V.current=Date.now()),he("mobile"),g!=null&&g.silent||(m("Synced with Google Drive."),en("Synced with Google Drive.")),it(new Date().toISOString()),Ie(!1),localStorage.setItem(bl,JSON.stringify({id:(_e==null?void 0:_e.id)||Y.id,name:(_e==null?void 0:_e.name)||Y.name,modifiedTime:(_e==null?void 0:_e.modifiedTime)||Y.modifiedTime,size:(_e==null?void 0:_e.size)||Y.size,revisionId:(_e==null?void 0:_e.revisionId)||Y.revisionId})),Mn.current===Q&&(Xt(!1),Ie(!1))}catch(De){const be=(De==null?void 0:De.message)||"Failed to sync with Drive.";m(be),nt(be)}finally{Xe(!1),xn.current=!1,an.current=!1}},[Y,zt,nt,en,k,A,P,Re,wt,qe,T]),Zo=d.useCallback(()=>{navigator.onLine&&wt&&Y&&t&&(Ie(!0),_n({silent:!0}))},[wt,Y,t,_n]);d.useEffect(()=>{const g=()=>{document.visibilityState==="visible"&&Zo()};return window.addEventListener("online",Zo),document.addEventListener("visibilitychange",g),()=>{window.removeEventListener("online",Zo),document.removeEventListener("visibilitychange",g)}},[Zo]),d.useEffect(()=>{if(qe){qt(!0);return}if(!Un||!Y||!t)return;(async()=>{Ie(!0),vt("Reconnected — refreshing data…"),await _n({silent:!0}),qt(!1),vt(null)})()},[qe,Un,Y,t,_n]),d.useEffect(()=>{if(!Y||!wt||xn.current)return;const g=window.setTimeout(()=>{_n({silent:!0})},1500);return()=>window.clearTimeout(g)},[wt,Y,_n]),d.useEffect(()=>{Y&&T(Y.id,Y.revisionId||null)},[Y,T]),d.useEffect(()=>{Rt.current=(Y==null?void 0:Y.id)||null},[Y]);const qo=d.useCallback(async()=>{var Z;const g=Rt.current;if(!g||xn.current||an.current)return;if(wt||Qe||Fe||qe){console.log("[Drive][Mobile] skip pull",{dirty:wt,autoSaving:Qe,pendingSync:Fe,isOffline:qe,syncLock:an.current});return}if(tr.current&&Date.now()-tr.current<Br){console.log("[Drive][Mobile] skip pull (recent local edits)",{lastLocalEditAt:tr.current});return}const Q=await zt(!1,"pull");if(Q&&Rt.current===g)try{const ve=await ic(Q.accessToken);if(Rt.current!==g)return;const ke=ve.find(We=>We.id===g);if(ke!=null&&ke.revisionId&&ke.revisionId!==Wr(g)){const We=await Sr(Q.accessToken,g);if(Rt.current!==g)return;const Me=typeof We=="string"?JSON.parse(We):We,De=JSON.stringify(((Z=Me==null?void 0:Me.periodsState)==null?void 0:Z.periods)||[]);if(Zt.current&&De===Zt.current){T(g,ke.revisionId||null),V.current=Date.now(),he((Me==null?void 0:Me.lastWriter)||"unknown");return}Ds(Me,ke)&&Rt.current===g&&(it(new Date().toISOString()),T(g,ke.revisionId||null),V.current=Date.now(),he((Me==null?void 0:Me.lastWriter)||"unknown"),at(Be=>Be+1),bt("Updated from Drive."))}}catch{}},[Ds,zt,bt,wt,Qe,Fe,qe,Wr,T]);d.useEffect(()=>{let g=null;const Q=async()=>{await qo(),g=window.setTimeout(Q,15e3)};return g=window.setTimeout(Q,15e3),()=>{g&&window.clearTimeout(g)}},[qo]),d.useEffect(()=>{if(Ze.current&&(window.clearTimeout(Ze.current),Ze.current=null),!(wt||Fe||Qe||qe||!Y))return Ze.current=window.setTimeout(()=>{qo()},5e3),()=>{Ze.current&&(window.clearTimeout(Ze.current),Ze.current=null)}},[wt,Fe,Qe,qe,Y,qo]);const hd=(j==null?void 0:j.state)??"unknown";let eg=hd==="ok"&&t?"Connected to Google Drive":"Google Drive Sync",Gr="Link Google Drive to save and sync. Files stay in your Drive.",Hr=t?"Manage Files":"Connect to Drive";switch(hd){case"no-session-yet":Hr=t?"Manage Files":"Connect to Google Drive",Gr="Store your seating data in a private folder in your Google Drive.";break;case"device-storage-wipe":Hr=t?"Manage Files":"Reconnect Google Drive",Gr="Your device cleared your Google connection. Tap below to reconnect; your files are still in your Drive.";break;case"oauth-failure":Hr=t?"Manage Files":"Reconnect Google Drive",Gr="There was a Google sign-in problem. Reconnect to continue syncing.";break;case"user-logged-out":Hr=t?"Manage Files":"Connect to Google Drive",Gr="You disconnected from Google Drive.";break}return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-violet-900 to-indigo-800 text-white flex flex-col relative",children:[s.jsxs("div",{className:"bg-emerald-50 text-emerald-900 text-xs px-4 py-1 text-center",children:[s.jsx("span",{role:"img","aria-label":"lock",className:"mr-1",children:"🔒"}),"Privacy: Data stays on this device and in your Google Drive. Use your school Google account. No data is sent to our servers."]}),qe&&s.jsx("div",{className:"bg-slate-900 text-white text-xs px-4 py-1 text-center",children:"Offline — edits are saved locally and will sync when you’re back online."}),s.jsx("div",{className:"px-4 pt-2",children:s.jsxs("button",{className:"text-[11px] px-2 py-1 rounded bg-white/80 text-slate-800 shadow",onClick:cn,title:"Version",type:"button",children:["Rev ",zv]})}),s.jsx("header",{className:"px-6 pt-10 pb-4 text-center",children:s.jsx("h1",{className:"text-3xl font-black tracking-wide drop-shadow",children:"ClassSeats Mobile"})}),Hu,ne&&re&&(()=>{const g=ne.periods.find(Ne=>Ne.id===re);if(!g)return null;const Q=ne.students.filter(Ne=>{var _e;return(_e=Ne.periodIds)==null?void 0:_e.includes(String(g.id))}),Z=k[g.id]||{},ve=Q.length||1,ke=Q.filter(Ne=>Z[Ne.id]==="present").length,We=Q.filter(Ne=>Z[Ne.id]==="absent").length,Me=Q.filter(Ne=>Z[Ne.id]==="tardy").length,De=Q.filter(Ne=>Z[Ne.id]==="left_early").length,be=ke+We+Me+De,Be=Math.round(be/ve*100),ot=Math.round(ke/ve*100);return s.jsx("div",{className:"fixed left-0 right-0 z-40 px-4 pt-2",style:{top:"64px"},children:s.jsxs("div",{className:"bg-white/95 border border-slate-200 rounded-2xl shadow px-3 py-2 flex flex-wrap items-center gap-2 text-xs text-slate-800",children:[s.jsxs("span",{className:"font-semibold",children:["Progress: ",Be,"% • Present: ",ot,"%"]}),s.jsxs("span",{className:"px-2 py-1 rounded-full bg-emerald-100 text-emerald-800 font-semibold",children:["✓ Present: ",ke]}),s.jsxs("span",{className:"px-2 py-1 rounded-full bg-rose-100 text-rose-800 font-semibold",children:["✕ Absent: ",We]}),s.jsxs("span",{className:"px-2 py-1 rounded-full bg-amber-100 text-amber-800 font-semibold",children:["⏰ Tardy: ",Me]}),s.jsxs("span",{className:"px-2 py-1 rounded-full bg-blue-100 text-blue-800 font-semibold",children:["⏮ Left Early: ",De]})]})})})(),s.jsxs("main",{className:"flex-1 overflow-y-auto px-4 pb-28 pt-20 space-y-6 relative",children:[s.jsx("section",{className:"max-w-2xl mx-auto bg-white/95 text-slate-900 rounded-3xl shadow-xl p-5",children:s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-base font-semibold text-slate-900",children:eg}),s.jsx("p",{className:"text-xs text-slate-600",children:Gr}),s.jsxs("p",{className:"text-[11px] text-slate-500",children:[t?((xd=t.profile)==null?void 0:xd.email)||"Signed in":"Not signed in"," •"," ",(Y==null?void 0:Y.name)||(te==null?void 0:te.name)||"No file selected",qe&&" • Offline"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[Fe&&s.jsx("span",{className:"text-[11px] px-2 py-1 rounded-full bg-amber-100 text-amber-800",children:"Pending sync"}),qe&&s.jsx("span",{className:"text-[11px] px-2 py-1 rounded-full bg-slate-200 text-slate-700",children:"Offline"}),s.jsx("button",{className:"rounded-full bg-slate-900 text-white font-semibold px-4 py-2 text-sm disabled:opacity-50",disabled:!t||!Y,onClick:()=>void _n(),children:"Sync Now"}),s.jsx("button",{className:"rounded-full bg-emerald-600 text-white font-semibold px-4 py-2 text-sm",onClick:()=>t?xe(!0):void zt(!0,"cta"),children:Hr})]})]})}),N&&s.jsxs("section",{className:"max-w-2xl mx-auto bg-slate-900 text-slate-100 rounded-2xl shadow-inner p-3 space-y-2 text-xs",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"font-semibold",children:"Drive Debug"}),s.jsx("button",{className:"text-slate-200 underline",onClick:()=>W(!1),children:"Close"})]}),s.jsx("button",{className:"text-slate-200 underline",onClick:()=>f([]),children:"Clear"})]}),s.jsxs("div",{className:"border border-slate-700 rounded p-2 h-48 overflow-y-auto space-y-1 bg-slate-800/70",children:[x.length===0&&s.jsx("div",{className:"text-slate-400",children:"No debug entries yet."}),x.map((g,Q)=>s.jsx("div",{className:"font-mono text-[11px] whitespace-pre-wrap break-all",children:g},Q))]})]}),s.jsxs("section",{className:"max-w-2xl mx-auto bg-white/95 text-slate-900 rounded-3xl shadow-xl p-6 space-y-6",children:[ne&&s.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 space-y-3 text-left",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsx("div",{children:s.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Attendance & Behavior"})}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[s.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Date:"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{className:"px-2 py-1 rounded border border-slate-300 bg-white text-slate-700 text-sm",onClick:()=>{const g=new Date(Re);g.setDate(g.getDate()-1),vn(g.toISOString().slice(0,10))},children:"◀"}),s.jsx("input",{type:"date",className:"rounded border border-slate-300 px-2 py-1 text-sm",value:Re,onChange:g=>vn(g.target.value||$t())}),s.jsx("button",{className:"px-2 py-1 rounded border border-slate-300 bg-white text-slate-700 text-sm",onClick:()=>{const g=new Date(Re);g.setDate(g.getDate()+1),vn(g.toISOString().slice(0,10))},children:"▶"}),s.jsx("button",{className:"px-2 py-1 rounded border border-emerald-200 bg-emerald-50 text-emerald-700 text-sm font-semibold",onClick:()=>vn($t()),children:"Today"})]}),s.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"View:"}),s.jsxs("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:Hn,onChange:g=>er(g.target.value),children:[s.jsx("option",{value:"table",children:"Table View"}),s.jsx("option",{value:"list-last-first",children:"List (Last, First)"}),s.jsx("option",{value:"list-first-last",children:"List (First Last)"})]}),ne.periods.length>0&&s.jsx("select",{className:"rounded border border-slate-300 px-2 py-1 text-sm",value:re||"",onChange:g=>ie(g.target.value||null),children:ne.periods.map(g=>s.jsx("option",{value:g.id,children:g.name},g.id))})]})]}),re?(()=>{const g=ne.periods.find(Ne=>Ne.id===re);if(!g)return s.jsx("p",{className:"text-sm text-slate-500",children:"Period not found."});const Q=g.layoutId?ne.layouts[g.layoutId]:null,Z=ne.students.filter(Ne=>{var _e;return(_e=Ne.periodIds)==null?void 0:_e.includes(String(g.id))}),ve=Z.reduce((Ne,_e)=>(Ne[String(_e.id)]=_e,Ne),{}),ke={};Q==null||Q.tables.forEach(Ne=>ke[Ne.id]={id:Ne.id,name:Ne.name,students:[]});const We=[],Me=g.tableAssignments||{};Array.isArray(g.activeGrouping)&&Object.keys(Me||{}).length>0?(g.activeGrouping.forEach((Ne,_e)=>{const ct=Me[String(_e)]||Me[_e],dt=ct?ke[ct]:null;Ne==null||Ne.forEach(Kn=>{const yn=ve[String(Kn)];yn&&(dt?dt.students.push(yn):We.push(yn))})}),Z.forEach(Ne=>{(g.activeGrouping||[]).some(ct=>ct==null?void 0:ct.some(dt=>String(dt)===String(Ne.id)))||We.push(Ne)})):Z.forEach(Ne=>{const _e=Me[String(Ne.id)]||Me[Ne.id];_e&&ke[_e]?ke[_e].students.push(Ne):We.push(Ne)});const De=Object.values(ke),be=k[g.id]||{};A[g.id];const Be=P[g.id]||{};Le[g.id];const ot=Ne=>{var Vr;const _e=be[Ne.id],ct=typeof Be[Ne.id]=="number"?Be[Ne.id]:g.startingPoints??50,[dt,...Kn]=Ne.fullName.split(" "),yn=Kn.join(" "),Ur=!!((Vr=A[g.id])!=null&&Vr[Ne.id]),nr=(()=>{switch(_e){case"present":return"✅";case"absent":return"🚫";case"tardy":return"⏰";case"left_early":return"⏮";default:return""}})(),sr=pd(_e);return s.jsx("div",{className:`w-full rounded-2xl border px-4 py-3 shadow-sm ${Qo(_e)}`,children:s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsxs("div",{className:"text-left min-w-0 flex-1",children:[s.jsx("div",{className:"text-base font-bold text-slate-900 leading-tight break-words",children:dt}),s.jsx("div",{className:"text-base font-bold text-slate-900 leading-tight break-words",children:yn||" "})]}),s.jsx("button",{className:"text-xl text-slate-600 px-3 py-2 rounded-full hover:bg-slate-200 flex-shrink-0",onClick:Ms=>{Ms.stopPropagation(),fe({id:Ne.id,name:Ne.fullName}),Ke(g.id)},children:"⋯"})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm px-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-lg",children:nr}),s.jsx("span",{className:"text-slate-700",children:sr})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[g.pointsEnabled&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-lg",children:Jo(ct)}),s.jsx("span",{className:"text-emerald-700 font-semibold",children:ct})]}),Ur&&s.jsx("span",{className:"text-indigo-600 text-lg",children:"📒"})]})]})]})},Ne.id)};if(Hn!=="table"){const Ne=[...Z].sort((_e,ct)=>{const[dt,...Kn]=_e.fullName.split(" "),[yn,...Ur]=ct.fullName.split(" "),nr=Kn.join(" "),sr=Ur.join(" ");return Hn==="list-last-first"?`${nr} ${dt}`.localeCompare(`${sr} ${yn}`):`${dt} ${nr}`.localeCompare(`${yn} ${sr}`)});return s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{className:"rounded bg-emerald-500 text-white text-xs font-semibold px-3 py-2",onClick:()=>Xo(g.id,Z.map(_e=>_e.id)),children:"Mark Rest Present (All)"}),s.jsx("button",{className:"rounded bg-rose-100 text-rose-800 text-xs font-semibold px-3 py-2 border border-rose-200",onClick:()=>md(g.id),children:"Reset Today"})]}),s.jsx("div",{className:"space-y-2",children:Ne.length===0?s.jsx("p",{className:"text-xs text-slate-500",children:"No students found."}):Ne.map(ot)})]})}return s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{className:"rounded bg-emerald-500 text-white text-xs font-semibold px-3 py-2",onClick:()=>Xo(g.id,Z.map(Ne=>Ne.id)),children:"Mark Rest Present (All)"}),s.jsx("button",{className:"rounded bg-rose-100 text-rose-800 text-xs font-semibold px-3 py-2 border border-rose-200",onClick:()=>md(g.id),children:"Reset Today"})]}),De.map(Ne=>{const _e=Ne.students.filter(dt=>be[dt.id]!=="absent").map(dt=>dt.id),ct=Ne.name.replace("Table","").trim()||Ne.name;return s.jsxs("div",{className:"rounded-xl border border-slate-200",children:[s.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-slate-50 border-b border-slate-200 gap-3",children:[s.jsxs("div",{className:"flex flex-col leading-tight text-center min-w-[54px]",children:[s.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Table"}),s.jsx("span",{className:"text-sm font-semibold text-slate-900",children:ct})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{className:"text-xs rounded bg-emerald-100 text-emerald-800 px-2 py-1",onClick:()=>Xo(g.id,Ne.students.map(dt=>dt.id)),children:"Mark Rest Present"}),g.pointsEnabled&&s.jsx("button",{className:"text-[11px] rounded bg-amber-600 text-white px-3 py-2 font-semibold",onClick:()=>{R(null),O(0),X(""),oe({periodId:g.id,tableName:Ne.name,studentIds:_e})},children:"Table Points"})]})]}),s.jsx("div",{className:"p-3 flex flex-wrap gap-2",children:Ne.students.length===0?s.jsx("p",{className:"text-xs text-slate-500",children:"No students assigned."}):Ne.students.map(ot)})]},Ne.id)}),s.jsxs("div",{className:"rounded-xl border border-slate-200",children:[s.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-slate-50 border-b border-slate-200",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Unassigned"}),s.jsx("button",{className:"text-xs rounded bg-emerald-100 text-emerald-800 px-2 py-1",onClick:()=>Xo(g.id,We.map(Ne=>Ne.id)),children:"Mark Rest Present"})]}),s.jsx("div",{className:"p-3 flex flex-wrap gap-2",children:We.length===0?s.jsx("p",{className:"text-xs text-slate-500",children:"No unassigned students."}):We.map(ot)})]})]})})():s.jsx("p",{className:"text-sm text-slate-500",children:"Load and select a period to begin."})]}),B&&s.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center px-4",onClick:()=>fe(null),children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-4 w-full max-w-sm space-y-3",onClick:g=>g.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-slate-800",children:B.name}),s.jsx("p",{className:"text-xs text-slate-500",children:"Actions"})]}),s.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>fe(null),children:"✕"})]}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:os.map(g=>s.jsx("button",{className:"rounded-lg border border-slate-200 px-2 py-2 text-xs text-left hover:bg-slate-50",onClick:()=>{Ae&&$i(Ae,B.id,g),fe(null)},children:pd(g)},g))}),s.jsx("div",{className:"space-y-2",children:s.jsx("button",{className:"w-full rounded-lg border border-slate-200 px-2 py-2 text-xs text-left hover:bg-slate-50",onClick:()=>{Ae&&Ym(Ae,B.id,B.name),fe(null)},children:"⭐ Notes and Points"})}),s.jsx("button",{className:"w-full rounded-lg bg-slate-900 text-white font-semibold py-2 text-sm",onClick:()=>fe(null),children:"Close"})]})}),I&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>q(null)}),s.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-semibold text-slate-800",children:["Behavior for ",I.studentName]}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Today · Points ",me.pointsEnabled?`${Jo(me.currentPoints)} ${me.currentPoints}`:"disabled"]})]}),s.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>q(null),children:"✕"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Note"}),s.jsx("textarea",{value:K.note,onChange:g=>le(Q=>({...Q,note:g.target.value})),className:"w-full border-2 border-slate-200 rounded-lg px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none",rows:4,placeholder:"Enter behavior note...",autoFocus:!0,onMouseDown:g=>g.stopPropagation(),onClick:g=>g.stopPropagation()}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["✅ Excellent participation","⚠️ Needs redirection","🎯 Academic progress","👥 Positive peer interactions"].map(g=>s.jsx("button",{onClick:()=>le(Q=>({...Q,note:Q.note?Q.note+" "+g:g})),className:"text-[11px] px-2.5 py-1 rounded-lg bg-slate-100 hover:bg-slate-200 border border-slate-200 text-slate-700",children:g},g))}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",className:"flex-1 border border-slate-300 rounded px-3 py-2 text-sm",placeholder:"Custom snippet",value:je,onChange:g=>Te(g.target.value)}),s.jsx("button",{className:"text-xs rounded bg-indigo-600 text-white px-3 py-2",onClick:()=>{je.trim()&&(le(g=>({...g,note:g.note?`${g.note} ${je}`:je})),Te(""))},children:"Insert"})]})]}),me.pointsEnabled&&s.jsxs("div",{className:"space-y-3 border border-slate-200 rounded-xl p-3 bg-slate-50",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Points"}),s.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[s.jsxs("span",{children:[Jo(me.currentPoints)," ",me.currentPoints]}),s.jsx("span",{className:"text-slate-400",children:"→"}),s.jsxs("span",{children:[Jo(Math.max(0,me.currentPoints+K.delta))," ",Math.max(0,me.currentPoints+K.delta)]})]})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:[2,1,0,-1,-2].map(g=>s.jsx("button",{onClick:()=>le(Q=>({...Q,delta:g,reason:Q.reason})),className:`px-3 py-1.5 rounded border text-sm font-semibold ${K.delta===g?"bg-indigo-600 text-white border-indigo-600":"bg-white text-slate-700 border-slate-300 hover:bg-indigo-50"}`,children:g>0?`+${g}`:g},g))}),K.delta!==0&&s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Reason (required)"}),s.jsx("input",{value:K.reason,onChange:g=>le(Q=>({...Q,reason:g.target.value})),className:"w-full border border-slate-300 rounded px-2 py-1 text-sm",placeholder:"Enter reason for point change"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{className:"flex-1 rounded-lg bg-indigo-600 text-white font-semibold py-2",onClick:Km,children:"Save"}),s.jsx("button",{className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>q(null),children:"Cancel"})]})]})]}),F&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>oe(null)}),s.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg p-5 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-slate-800",children:F.tableName}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Apply points to ",F.studentIds.length," present student",F.studentIds.length===1?"":"s"]})]}),s.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>oe(null),children:"✕"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Note (required)"}),s.jsx("textarea",{className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Describe why you’re adjusting points",value:z,onChange:g=>X(g.target.value),rows:3})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-xs font-semibold text-slate-700",children:"Choose points"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[[2,1,-1,-2].map(g=>{const Q=y===g;return s.jsxs("button",{className:`px-3 py-2 rounded-lg text-sm font-semibold border ${Q?"bg-amber-600 text-white border-amber-600":"bg-white text-amber-800 border-amber-300"}`,onClick:()=>{R(g),O(0)},children:[g>0?`+${g}`:g," pts"]},g)}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("input",{type:"number",className:"w-24 rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Custom",value:$,onFocus:()=>R(null),onChange:g=>O(Number(g.target.value)||0)})})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{className:"flex-1 rounded-lg bg-amber-600 text-white font-semibold py-2",onClick:()=>{const g=z.trim(),Q=y??$;if(!g){nt("Enter a note for the point change.");return}if(!Q){nt("Select a point value.");return}Vm(F.periodId,F.studentIds,Q,g),R(null),O(0),X(""),oe(null)},children:"Apply"}),s.jsx("button",{className:"flex-1 rounded-lg bg-slate-200 text-slate-800 font-semibold py-2",onClick:()=>oe(null),children:"Cancel"})]}),s.jsx("p",{className:"text-[11px] text-slate-500",children:"Only present students at this table receive the adjustment. Absent students are skipped."}),(()=>{const g=(b[F.periodId]||[]).filter(Z=>{var ve;return((ve=Z.date)==null?void 0:ve.startsWith(Re))&&F.studentIds.includes(String(Z.studentId))});if(g.length===0)return null;const Q=Z=>{var ve;return((ve=ne==null?void 0:ne.students.find(ke=>String(ke.id)===String(Z)))==null?void 0:ve.fullName)||`Student ${Z}`};return s.jsxs("div",{className:"border-t border-slate-200 pt-2 space-y-1",children:[s.jsx("p",{className:"text-xs font-semibold text-slate-700",children:"Today’s table adjustments"}),s.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:g.map((Z,ve)=>s.jsxs("div",{className:"text-xs text-slate-700 flex justify-between",children:[s.jsx("span",{className:"font-semibold",children:Q(Z.studentId)}),s.jsxs("span",{children:[Z.delta>0?"+":"",Z.delta," • ",Z.reason||"No note"]})]},`${Z.studentId}-${ve}`))})]})})()]})]})]}),$e&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>xe(!1)}),s.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto p-5 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-lg font-semibold text-slate-900",children:"Manage Files"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Sign in, load, create, or import ClassSeats files."})]}),s.jsx("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>xe(!1),children:"✕"})]}),t?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 text-xs text-slate-600",children:[s.jsxs("div",{children:[s.jsxs("p",{children:["Signed in as ",s.jsx("span",{className:"font-semibold text-slate-900",children:((vd=t.profile)==null?void 0:vd.email)||"your account"})]}),s.jsxs("p",{children:["Active file: ",s.jsx("span",{className:"font-semibold text-slate-900",children:(Y==null?void 0:Y.name)||(te==null?void 0:te.name)||"None selected"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[Y&&s.jsx("button",{className:"px-3 py-1 rounded bg-rose-600 text-white font-semibold",onClick:()=>void Jm(),children:"🗑️ Delete Active File"}),s.jsx("button",{className:"text-rose-600 underline",onClick:Qm,children:"Sign out"})]})]}),Hu,s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("button",{className:"w-full rounded-2xl bg-slate-900 text-white font-semibold py-2",onClick:()=>void Xm(!0),children:"📁 Refresh Cloud Files"}),s.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-2xl p-3 max-h-64 overflow-auto space-y-2",children:[l&&s.jsx("p",{className:"text-sm text-slate-500",children:"Loading Drive files…"}),a&&s.jsx("p",{className:"text-sm text-rose-600",children:a}),!l&&!a&&r.length===0&&s.jsx("p",{className:"text-sm text-slate-500",children:"No ClassSeats files found yet."}),!l&&!a&&r.length>0&&r.map(g=>{const Q=(te==null?void 0:te.id)===g.id,Z=(Y==null?void 0:Y.id)===g.id;return s.jsxs("button",{className:`w-full text-left rounded-xl border px-3 py-2 transition ${Q?"border-indigo-400 bg-indigo-50 text-indigo-900":Z?"border-emerald-400 bg-emerald-50 text-emerald-900":"border-slate-200 bg-white hover:bg-slate-100"}`,onClick:()=>ae(g),children:[s.jsx("p",{className:"text-sm font-semibold",children:g.name}),s.jsxs("p",{className:"text-[11px] text-slate-500",children:["Updated ",g.modifiedTime?new Date(g.modifiedTime).toLocaleString():"—",g.size?` • ${(Number(g.size)/1024).toFixed(1)} KB`:""]}),Z&&s.jsx("p",{className:"text-[11px] text-emerald-700 font-semibold",children:"Active"})]},g.id)})]}),s.jsx("button",{className:"w-full rounded-2xl bg-emerald-600 text-white font-semibold py-2 disabled:opacity-50",onClick:Zm,disabled:!te||J,children:J?"Loading…":te?`Load "${te.name}"`:"Load Selected File"}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("button",{className:"w-full rounded-2xl bg-emerald-600 text-white font-semibold py-2 disabled:opacity-50",onClick:()=>void _n(),disabled:!Y,children:"☁️ Sync (pull latest, then save)"}),s.jsx("p",{className:"text-[11px] text-slate-500 text-center",children:"Uses the selected cloud file. Select or create one first."})]})]}),s.jsx("div",{className:"space-y-3",children:s.jsxs("div",{className:"space-y-2 border-b border-slate-200 pb-3",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Create a new cloud file"}),s.jsx("input",{type:"text",className:"w-full rounded-xl border border-slate-300 px-3 py-2 text-sm",placeholder:"e.g., Semester 2 24-25",value:v,onChange:g=>D(g.target.value)}),s.jsx("button",{className:"w-full rounded-2xl bg-slate-900 text-white font-semibold py-2 disabled:opacity-50",onClick:qm,disabled:M,children:M?"Creating…":"Create Cloud File"})]})})]})]}):s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-sm text-slate-700",children:"Sign in with Google to access Drive."}),s.jsx("p",{className:"text-[11px] text-amber-700",children:"Use your school Google account. Files stay in your Drive (ClassSeats folder)."}),s.jsx("button",{className:"w-full rounded-2xl bg-indigo-600 text-white font-semibold py-2",onClick:()=>{xe(!1),zt(!0)},children:"🔐 Sign in with Google"})]})]})]})]})]}),s.jsx("div",{className:"fixed inset-x-0 bottom-0 px-4 pb-[env(safe-area-inset-bottom)]",children:s.jsxs("div",{className:"bg-white/95 border border-slate-200 rounded-2xl shadow-lg px-4 py-3 flex flex-wrap items-center gap-2 text-xs text-slate-700",children:[s.jsxs("div",{className:"flex-1 min-w-[180px]",children:[s.jsx("p",{className:"font-semibold text-slate-900",children:Qe?"Saving…":rt?`Synced ${new Date(rt).toLocaleTimeString()}`:"Ready"}),s.jsxs("p",{className:"text-[11px] text-slate-500 truncate",children:[t?((bd=t.profile)==null?void 0:bd.email)||"Signed in":"Not signed in"," •"," ",(Y==null?void 0:Y.name)||(te==null?void 0:te.name)||"No file selected",qe&&" • Offline"]}),Fe&&s.jsx("p",{className:"text-[11px] text-amber-700",children:"Pending sync"})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[s.jsx("button",{className:"rounded-full bg-emerald-600 text-white px-3 py-2 text-xs font-semibold disabled:opacity-50 flex-none",disabled:!t||!Y,onClick:()=>void _n(),children:"Sync Now"}),s.jsx("button",{className:"rounded-full bg-slate-900 text-white px-3 py-2 text-xs font-semibold flex-none",onClick:()=>t?xe(!0):void zt(!0,"cta"),children:"Manage Files"})]})]})})]}),qe&&s.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center px-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-sm w-full p-4 text-center space-y-2 text-slate-900",children:[s.jsx("p",{className:"text-base font-semibold",children:"Mobile paused while offline"}),s.jsx("p",{className:"text-sm text-slate-600",children:"Edits are disabled while offline. Reconnect to resume."}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Last sync: ",rt?new Date(rt).toLocaleTimeString():"No sync yet"]})]})})]})}const Wv=document.getElementById("root"),ca=window.location.pathname.replace(/\/+$/,""),Gv=ca==="/ClassSeatsMobile"||ca.endsWith("/ClassSeatsMobile")||ca.endsWith("/ClassSeats-Mobile/ClassSeatsMobile");da.createRoot(Wv).render(s.jsx(uo.StrictMode,{children:s.jsx(iv,{children:Gv?s.jsx(Bv,{}):s.jsx(Fv,{})})}));"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js").then(()=>console.info("[PWA] Service worker registered.")).catch(e=>console.warn("[PWA] Service worker registration failed",e));</script>
    <style rel="stylesheet" crossorigin>*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.visible{visibility:visible}.collapse{visibility:collapse}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{top:0;right:0;bottom:0;left:0}.inset-x-0{left:0;right:0}.bottom-0{bottom:0}.left-0{left:0}.left-1\/2{left:50%}.left-2{left:.5rem}.right-0{right:0}.top-0{top:0}.top-2{top:.5rem}.top-6{top:1.5rem}.top-full{top:100%}.z-10{z-index:10}.z-30{z-index:30}.z-40{z-index:40}.z-50{z-index:50}.z-\[1000\]{z-index:1000}.z-\[100\]{z-index:100}.z-\[120\]{z-index:120}.z-\[60\]{z-index:60}.z-\[70\]{z-index:70}.col-span-2{grid-column:span 2 / span 2}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-4{margin-left:1rem;margin-right:1rem}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:.25rem;margin-bottom:.25rem}.my-4{margin-top:1rem;margin-bottom:1rem}.mb-0\.5{margin-bottom:.125rem}.mb-1{margin-bottom:.25rem}.mb-2{margin-bottom:.5rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-4{margin-left:1rem}.ml-auto{margin-left:auto}.mr-1{margin-right:.25rem}.mr-2{margin-right:.5rem}.mt-0\.5{margin-top:.125rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-3{margin-top:.75rem}.mt-4{margin-top:1rem}.mt-5{margin-top:1.25rem}.mt-6{margin-top:1.5rem}.block{display:block}.flex{display:flex}.inline-flex{display:inline-flex}.\!table{display:table!important}.table{display:table}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-12{height:3rem}.h-2{height:.5rem}.h-3{height:.75rem}.h-4{height:1rem}.h-40{height:10rem}.h-48{height:12rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-7{height:1.75rem}.h-8{height:2rem}.h-full{height:100%}.max-h-32{max-height:8rem}.max-h-56{max-height:14rem}.max-h-64{max-height:16rem}.max-h-72{max-height:18rem}.max-h-80{max-height:20rem}.max-h-96{max-height:24rem}.max-h-\[80vh\]{max-height:80vh}.max-h-\[90vh\]{max-height:90vh}.max-h-\[92vh\]{max-height:92vh}.max-h-\[95vh\]{max-height:95vh}.min-h-\[100px\]{min-height:100px}.min-h-\[10rem\]{min-height:10rem}.min-h-\[280px\]{min-height:280px}.min-h-\[520px\]{min-height:520px}.min-h-\[74px\]{min-height:74px}.min-h-screen{min-height:100vh}.w-10{width:2.5rem}.w-12{width:3rem}.w-16{width:4rem}.w-2{width:.5rem}.w-20{width:5rem}.w-24{width:6rem}.w-3{width:.75rem}.w-4{width:1rem}.w-48{width:12rem}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-7{width:1.75rem}.w-8{width:2rem}.w-\[100px\]{width:100px}.w-\[140px\]{width:140px}.w-\[90px\]{width:90px}.w-\[95px\]{width:95px}.w-\[95vw\]{width:95vw}.w-full{width:100%}.w-px{width:1px}.min-w-0{min-width:0px}.min-w-\[100px\]{min-width:100px}.min-w-\[160px\]{min-width:160px}.min-w-\[180px\]{min-width:180px}.min-w-\[220px\]{min-width:220px}.min-w-\[280px\]{min-width:280px}.min-w-\[50px\]{min-width:50px}.min-w-\[54px\]{min-width:54px}.max-w-2xl{max-width:42rem}.max-w-3xl{max-width:48rem}.max-w-6xl{max-width:72rem}.max-w-\[1100px\]{max-width:1100px}.max-w-\[200px\]{max-width:200px}.max-w-\[600px\]{max-width:600px}.max-w-\[980px\]{max-width:980px}.max-w-\[98vw\]{max-width:98vw}.max-w-full{max-width:100%}.max-w-lg{max-width:32rem}.max-w-md{max-width:28rem}.max-w-sm{max-width:24rem}.flex-1{flex:1 1 0%}.flex-none{flex:none}.flex-shrink-0,.shrink-0{flex-shrink:0}.border-collapse{border-collapse:collapse}.-translate-x-1\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-move{cursor:move}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.resize{resize:both}.list-disc{list-style-type:disc}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-0\.5{gap:.125rem}.gap-1{gap:.25rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.25rem * var(--tw-space-y-reverse))}.space-y-6>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-visible{overflow:visible}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-pre-wrap{white-space:pre-wrap}.break-words{overflow-wrap:break-word}.break-all{word-break:break-all}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-3xl{border-radius:1.5rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-xl{border-radius:.75rem}.rounded-b{border-bottom-right-radius:.25rem;border-bottom-left-radius:.25rem}.rounded-b-lg{border-bottom-right-radius:.5rem;border-bottom-left-radius:.5rem}.rounded-t-lg{border-top-left-radius:.5rem;border-top-right-radius:.5rem}.border{border-width:1px}.border-0{border-width:0px}.border-2{border-width:2px}.border-4{border-width:4px}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-t{border-top-width:1px}.border-t-2{border-top-width:2px}.border-dashed{border-style:dashed}.border-amber-100{--tw-border-opacity: 1;border-color:rgb(254 243 199 / var(--tw-border-opacity, 1))}.border-amber-200{--tw-border-opacity: 1;border-color:rgb(253 230 138 / var(--tw-border-opacity, 1))}.border-amber-300{--tw-border-opacity: 1;border-color:rgb(252 211 77 / var(--tw-border-opacity, 1))}.border-amber-400{--tw-border-opacity: 1;border-color:rgb(251 191 36 / var(--tw-border-opacity, 1))}.border-amber-600{--tw-border-opacity: 1;border-color:rgb(217 119 6 / var(--tw-border-opacity, 1))}.border-blue-100{--tw-border-opacity: 1;border-color:rgb(219 234 254 / var(--tw-border-opacity, 1))}.border-blue-200{--tw-border-opacity: 1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1))}.border-blue-300{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.border-blue-600{--tw-border-opacity: 1;border-color:rgb(37 99 235 / var(--tw-border-opacity, 1))}.border-cyan-200{--tw-border-opacity: 1;border-color:rgb(165 243 252 / var(--tw-border-opacity, 1))}.border-cyan-300{--tw-border-opacity: 1;border-color:rgb(103 232 249 / var(--tw-border-opacity, 1))}.border-cyan-400{--tw-border-opacity: 1;border-color:rgb(34 211 238 / var(--tw-border-opacity, 1))}.border-emerald-100{--tw-border-opacity: 1;border-color:rgb(209 250 229 / var(--tw-border-opacity, 1))}.border-emerald-200{--tw-border-opacity: 1;border-color:rgb(167 243 208 / var(--tw-border-opacity, 1))}.border-emerald-400{--tw-border-opacity: 1;border-color:rgb(52 211 153 / var(--tw-border-opacity, 1))}.border-emerald-500{--tw-border-opacity: 1;border-color:rgb(16 185 129 / var(--tw-border-opacity, 1))}.border-gray-200{--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-300{--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-green-200{--tw-border-opacity: 1;border-color:rgb(187 247 208 / var(--tw-border-opacity, 1))}.border-green-300{--tw-border-opacity: 1;border-color:rgb(134 239 172 / var(--tw-border-opacity, 1))}.border-green-500{--tw-border-opacity: 1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.border-green-600{--tw-border-opacity: 1;border-color:rgb(22 163 74 / var(--tw-border-opacity, 1))}.border-indigo-100{--tw-border-opacity: 1;border-color:rgb(224 231 255 / var(--tw-border-opacity, 1))}.border-indigo-200{--tw-border-opacity: 1;border-color:rgb(199 210 254 / var(--tw-border-opacity, 1))}.border-indigo-300{--tw-border-opacity: 1;border-color:rgb(165 180 252 / var(--tw-border-opacity, 1))}.border-indigo-400{--tw-border-opacity: 1;border-color:rgb(129 140 248 / var(--tw-border-opacity, 1))}.border-indigo-500{--tw-border-opacity: 1;border-color:rgb(99 102 241 / var(--tw-border-opacity, 1))}.border-indigo-600{--tw-border-opacity: 1;border-color:rgb(79 70 229 / var(--tw-border-opacity, 1))}.border-orange-200{--tw-border-opacity: 1;border-color:rgb(254 215 170 / var(--tw-border-opacity, 1))}.border-orange-300{--tw-border-opacity: 1;border-color:rgb(253 186 116 / var(--tw-border-opacity, 1))}.border-orange-400{--tw-border-opacity: 1;border-color:rgb(251 146 60 / var(--tw-border-opacity, 1))}.border-orange-500{--tw-border-opacity: 1;border-color:rgb(249 115 22 / var(--tw-border-opacity, 1))}.border-orange-600{--tw-border-opacity: 1;border-color:rgb(234 88 12 / var(--tw-border-opacity, 1))}.border-purple-100{--tw-border-opacity: 1;border-color:rgb(243 232 255 / var(--tw-border-opacity, 1))}.border-purple-200{--tw-border-opacity: 1;border-color:rgb(233 213 255 / var(--tw-border-opacity, 1))}.border-purple-300{--tw-border-opacity: 1;border-color:rgb(216 180 254 / var(--tw-border-opacity, 1))}.border-red-200{--tw-border-opacity: 1;border-color:rgb(254 202 202 / var(--tw-border-opacity, 1))}.border-red-300{--tw-border-opacity: 1;border-color:rgb(252 165 165 / var(--tw-border-opacity, 1))}.border-red-600{--tw-border-opacity: 1;border-color:rgb(220 38 38 / var(--tw-border-opacity, 1))}.border-rose-100{--tw-border-opacity: 1;border-color:rgb(255 228 230 / var(--tw-border-opacity, 1))}.border-rose-200{--tw-border-opacity: 1;border-color:rgb(254 205 211 / var(--tw-border-opacity, 1))}.border-rose-300{--tw-border-opacity: 1;border-color:rgb(253 164 175 / var(--tw-border-opacity, 1))}.border-rose-500{--tw-border-opacity: 1;border-color:rgb(244 63 94 / var(--tw-border-opacity, 1))}.border-slate-100{--tw-border-opacity: 1;border-color:rgb(241 245 249 / var(--tw-border-opacity, 1))}.border-slate-200{--tw-border-opacity: 1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.border-slate-300{--tw-border-opacity: 1;border-color:rgb(203 213 225 / var(--tw-border-opacity, 1))}.border-slate-400{--tw-border-opacity: 1;border-color:rgb(148 163 184 / var(--tw-border-opacity, 1))}.border-slate-600{--tw-border-opacity: 1;border-color:rgb(71 85 105 / var(--tw-border-opacity, 1))}.border-slate-700{--tw-border-opacity: 1;border-color:rgb(51 65 85 / var(--tw-border-opacity, 1))}.border-teal-400{--tw-border-opacity: 1;border-color:rgb(45 212 191 / var(--tw-border-opacity, 1))}.border-teal-500{--tw-border-opacity: 1;border-color:rgb(20 184 166 / var(--tw-border-opacity, 1))}.border-transparent{border-color:transparent}.border-yellow-200{--tw-border-opacity: 1;border-color:rgb(254 240 138 / var(--tw-border-opacity, 1))}.border-yellow-300{--tw-border-opacity: 1;border-color:rgb(253 224 71 / var(--tw-border-opacity, 1))}.border-yellow-400{--tw-border-opacity: 1;border-color:rgb(250 204 21 / var(--tw-border-opacity, 1))}.border-yellow-500{--tw-border-opacity: 1;border-color:rgb(234 179 8 / var(--tw-border-opacity, 1))}.border-yellow-600{--tw-border-opacity: 1;border-color:rgb(202 138 4 / var(--tw-border-opacity, 1))}.bg-amber-100{--tw-bg-opacity: 1;background-color:rgb(254 243 199 / var(--tw-bg-opacity, 1))}.bg-amber-200{--tw-bg-opacity: 1;background-color:rgb(253 230 138 / var(--tw-bg-opacity, 1))}.bg-amber-50{--tw-bg-opacity: 1;background-color:rgb(255 251 235 / var(--tw-bg-opacity, 1))}.bg-amber-500{--tw-bg-opacity: 1;background-color:rgb(245 158 11 / var(--tw-bg-opacity, 1))}.bg-amber-600{--tw-bg-opacity: 1;background-color:rgb(217 119 6 / var(--tw-bg-opacity, 1))}.bg-black\/40{background-color:#0006}.bg-black\/50{background-color:#00000080}.bg-black\/60{background-color:#0009}.bg-blue-100{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.bg-blue-50{--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-blue-500{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-blue-600{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-cyan-100{--tw-bg-opacity: 1;background-color:rgb(207 250 254 / var(--tw-bg-opacity, 1))}.bg-cyan-50{--tw-bg-opacity: 1;background-color:rgb(236 254 255 / var(--tw-bg-opacity, 1))}.bg-cyan-600{--tw-bg-opacity: 1;background-color:rgb(8 145 178 / var(--tw-bg-opacity, 1))}.bg-emerald-100{--tw-bg-opacity: 1;background-color:rgb(209 250 229 / var(--tw-bg-opacity, 1))}.bg-emerald-50{--tw-bg-opacity: 1;background-color:rgb(236 253 245 / var(--tw-bg-opacity, 1))}.bg-emerald-500{--tw-bg-opacity: 1;background-color:rgb(16 185 129 / var(--tw-bg-opacity, 1))}.bg-emerald-600{--tw-bg-opacity: 1;background-color:rgb(5 150 105 / var(--tw-bg-opacity, 1))}.bg-emerald-700{--tw-bg-opacity: 1;background-color:rgb(4 120 87 / var(--tw-bg-opacity, 1))}.bg-gray-100{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.bg-gray-200{--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.bg-gray-400{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-green-200{--tw-bg-opacity: 1;background-color:rgb(187 247 208 / var(--tw-bg-opacity, 1))}.bg-green-400{--tw-bg-opacity: 1;background-color:rgb(74 222 128 / var(--tw-bg-opacity, 1))}.bg-green-50{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-indigo-100{--tw-bg-opacity: 1;background-color:rgb(224 231 255 / var(--tw-bg-opacity, 1))}.bg-indigo-50{--tw-bg-opacity: 1;background-color:rgb(238 242 255 / var(--tw-bg-opacity, 1))}.bg-indigo-600{--tw-bg-opacity: 1;background-color:rgb(79 70 229 / var(--tw-bg-opacity, 1))}.bg-orange-100{--tw-bg-opacity: 1;background-color:rgb(255 237 213 / var(--tw-bg-opacity, 1))}.bg-orange-200{--tw-bg-opacity: 1;background-color:rgb(254 215 170 / var(--tw-bg-opacity, 1))}.bg-orange-400{--tw-bg-opacity: 1;background-color:rgb(251 146 60 / var(--tw-bg-opacity, 1))}.bg-orange-50{--tw-bg-opacity: 1;background-color:rgb(255 247 237 / var(--tw-bg-opacity, 1))}.bg-orange-500{--tw-bg-opacity: 1;background-color:rgb(249 115 22 / var(--tw-bg-opacity, 1))}.bg-orange-600{--tw-bg-opacity: 1;background-color:rgb(234 88 12 / var(--tw-bg-opacity, 1))}.bg-pink-500{--tw-bg-opacity: 1;background-color:rgb(236 72 153 / var(--tw-bg-opacity, 1))}.bg-purple-100{--tw-bg-opacity: 1;background-color:rgb(243 232 255 / var(--tw-bg-opacity, 1))}.bg-purple-50{--tw-bg-opacity: 1;background-color:rgb(250 245 255 / var(--tw-bg-opacity, 1))}.bg-purple-500{--tw-bg-opacity: 1;background-color:rgb(168 85 247 / var(--tw-bg-opacity, 1))}.bg-purple-600{--tw-bg-opacity: 1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1))}.bg-red-100{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.bg-red-200{--tw-bg-opacity: 1;background-color:rgb(254 202 202 / var(--tw-bg-opacity, 1))}.bg-red-400{--tw-bg-opacity: 1;background-color:rgb(248 113 113 / var(--tw-bg-opacity, 1))}.bg-red-50{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-red-600{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.bg-rose-100{--tw-bg-opacity: 1;background-color:rgb(255 228 230 / var(--tw-bg-opacity, 1))}.bg-rose-50{--tw-bg-opacity: 1;background-color:rgb(255 241 242 / var(--tw-bg-opacity, 1))}.bg-rose-600{--tw-bg-opacity: 1;background-color:rgb(225 29 72 / var(--tw-bg-opacity, 1))}.bg-sky-100{--tw-bg-opacity: 1;background-color:rgb(224 242 254 / var(--tw-bg-opacity, 1))}.bg-slate-100{--tw-bg-opacity: 1;background-color:rgb(241 245 249 / var(--tw-bg-opacity, 1))}.bg-slate-200{--tw-bg-opacity: 1;background-color:rgb(226 232 240 / var(--tw-bg-opacity, 1))}.bg-slate-300{--tw-bg-opacity: 1;background-color:rgb(203 213 225 / var(--tw-bg-opacity, 1))}.bg-slate-400{--tw-bg-opacity: 1;background-color:rgb(148 163 184 / var(--tw-bg-opacity, 1))}.bg-slate-50{--tw-bg-opacity: 1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}.bg-slate-500{--tw-bg-opacity: 1;background-color:rgb(100 116 139 / var(--tw-bg-opacity, 1))}.bg-slate-600{--tw-bg-opacity: 1;background-color:rgb(71 85 105 / var(--tw-bg-opacity, 1))}.bg-slate-700{--tw-bg-opacity: 1;background-color:rgb(51 65 85 / var(--tw-bg-opacity, 1))}.bg-slate-800{--tw-bg-opacity: 1;background-color:rgb(30 41 59 / var(--tw-bg-opacity, 1))}.bg-slate-800\/70{background-color:#1e293bb3}.bg-slate-900{--tw-bg-opacity: 1;background-color:rgb(15 23 42 / var(--tw-bg-opacity, 1))}.bg-teal-200{--tw-bg-opacity: 1;background-color:rgb(153 246 228 / var(--tw-bg-opacity, 1))}.bg-teal-50{--tw-bg-opacity: 1;background-color:rgb(240 253 250 / var(--tw-bg-opacity, 1))}.bg-teal-600{--tw-bg-opacity: 1;background-color:rgb(13 148 136 / var(--tw-bg-opacity, 1))}.bg-violet-600{--tw-bg-opacity: 1;background-color:rgb(124 58 237 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\/70{background-color:#ffffffb3}.bg-white\/80{background-color:#fffc}.bg-white\/95{background-color:#fffffff2}.bg-yellow-100{--tw-bg-opacity: 1;background-color:rgb(254 249 195 / var(--tw-bg-opacity, 1))}.bg-yellow-200{--tw-bg-opacity: 1;background-color:rgb(254 240 138 / var(--tw-bg-opacity, 1))}.bg-yellow-400{--tw-bg-opacity: 1;background-color:rgb(250 204 21 / var(--tw-bg-opacity, 1))}.bg-yellow-50{--tw-bg-opacity: 1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.bg-yellow-500{--tw-bg-opacity: 1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.bg-gradient-to-b{background-image:linear-gradient(to bottom,var(--tw-gradient-stops))}.bg-gradient-to-br{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.from-green-600{--tw-gradient-from: #16a34a var(--tw-gradient-from-position);--tw-gradient-to: rgb(22 163 74 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-indigo-50{--tw-gradient-from: #eef2ff var(--tw-gradient-from-position);--tw-gradient-to: rgb(238 242 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-indigo-500{--tw-gradient-from: #6366f1 var(--tw-gradient-from-position);--tw-gradient-to: rgb(99 102 241 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-600{--tw-gradient-from: #9333ea var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-violet-600{--tw-gradient-from: #7c3aed var(--tw-gradient-from-position);--tw-gradient-to: rgb(124 58 237 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-violet-900{--tw-gradient-from: #4c1d95 var(--tw-gradient-from-position);--tw-gradient-to: rgb(76 29 149 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.to-emerald-600{--tw-gradient-to: #059669 var(--tw-gradient-to-position)}.to-indigo-600{--tw-gradient-to: #4f46e5 var(--tw-gradient-to-position)}.to-indigo-800{--tw-gradient-to: #3730a3 var(--tw-gradient-to-position)}.to-purple-500{--tw-gradient-to: #a855f7 var(--tw-gradient-to-position)}.to-white{--tw-gradient-to: #fff var(--tw-gradient-to-position)}.p-1{padding:.25rem}.p-10{padding:2.5rem}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-1\.5{padding-left:.375rem;padding-right:.375rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-2\.5{padding-left:.625rem;padding-right:.625rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-0\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-1\.5{padding-top:.375rem;padding-bottom:.375rem}.py-12{padding-top:3rem;padding-bottom:3rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.pb-2{padding-bottom:.5rem}.pb-28{padding-bottom:7rem}.pb-3{padding-bottom:.75rem}.pb-4{padding-bottom:1rem}.pb-\[env\(safe-area-inset-bottom\)\]{padding-bottom:env(safe-area-inset-bottom)}.pl-4{padding-left:1rem}.pr-2{padding-right:.5rem}.pt-10{padding-top:2.5rem}.pt-2{padding-top:.5rem}.pt-20{padding-top:5rem}.pt-3{padding-top:.75rem}.pt-4{padding-top:1rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-5xl{font-size:3rem;line-height:1}.text-6xl{font-size:3.75rem;line-height:1}.text-\[10px\]{font-size:10px}.text-\[11px\]{font-size:11px}.text-\[13px\]{font-size:13px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-black{font-weight:900}.font-bold{font-weight:700}.font-extrabold{font-weight:800}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-none{line-height:1}.leading-tight{line-height:1.25}.tracking-wide{letter-spacing:.025em}.text-amber-100{--tw-text-opacity: 1;color:rgb(254 243 199 / var(--tw-text-opacity, 1))}.text-amber-700{--tw-text-opacity: 1;color:rgb(180 83 9 / var(--tw-text-opacity, 1))}.text-amber-800{--tw-text-opacity: 1;color:rgb(146 64 14 / var(--tw-text-opacity, 1))}.text-amber-900{--tw-text-opacity: 1;color:rgb(120 53 15 / var(--tw-text-opacity, 1))}.text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.text-blue-200{--tw-text-opacity: 1;color:rgb(191 219 254 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-blue-700{--tw-text-opacity: 1;color:rgb(29 78 216 / var(--tw-text-opacity, 1))}.text-blue-800{--tw-text-opacity: 1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.text-blue-900{--tw-text-opacity: 1;color:rgb(30 58 138 / var(--tw-text-opacity, 1))}.text-cyan-100{--tw-text-opacity: 1;color:rgb(207 250 254 / var(--tw-text-opacity, 1))}.text-emerald-600{--tw-text-opacity: 1;color:rgb(5 150 105 / var(--tw-text-opacity, 1))}.text-emerald-700{--tw-text-opacity: 1;color:rgb(4 120 87 / var(--tw-text-opacity, 1))}.text-emerald-800{--tw-text-opacity: 1;color:rgb(6 95 70 / var(--tw-text-opacity, 1))}.text-emerald-900{--tw-text-opacity: 1;color:rgb(6 78 59 / var(--tw-text-opacity, 1))}.text-gray-200{--tw-text-opacity: 1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity: 1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-green-100{--tw-text-opacity: 1;color:rgb(220 252 231 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-green-700{--tw-text-opacity: 1;color:rgb(21 128 61 / var(--tw-text-opacity, 1))}.text-green-800{--tw-text-opacity: 1;color:rgb(22 101 52 / var(--tw-text-opacity, 1))}.text-green-900{--tw-text-opacity: 1;color:rgb(20 83 45 / var(--tw-text-opacity, 1))}.text-indigo-600{--tw-text-opacity: 1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.text-indigo-700{--tw-text-opacity: 1;color:rgb(67 56 202 / var(--tw-text-opacity, 1))}.text-indigo-900{--tw-text-opacity: 1;color:rgb(49 46 129 / var(--tw-text-opacity, 1))}.text-orange-600{--tw-text-opacity: 1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.text-orange-700{--tw-text-opacity: 1;color:rgb(194 65 12 / var(--tw-text-opacity, 1))}.text-orange-800{--tw-text-opacity: 1;color:rgb(154 52 18 / var(--tw-text-opacity, 1))}.text-orange-900{--tw-text-opacity: 1;color:rgb(124 45 18 / var(--tw-text-opacity, 1))}.text-purple-100{--tw-text-opacity: 1;color:rgb(243 232 255 / var(--tw-text-opacity, 1))}.text-purple-600{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.text-purple-700{--tw-text-opacity: 1;color:rgb(126 34 206 / var(--tw-text-opacity, 1))}.text-purple-800{--tw-text-opacity: 1;color:rgb(107 33 168 / var(--tw-text-opacity, 1))}.text-purple-900{--tw-text-opacity: 1;color:rgb(88 28 135 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-red-700{--tw-text-opacity: 1;color:rgb(185 28 28 / var(--tw-text-opacity, 1))}.text-red-800{--tw-text-opacity: 1;color:rgb(153 27 27 / var(--tw-text-opacity, 1))}.text-red-900{--tw-text-opacity: 1;color:rgb(127 29 29 / var(--tw-text-opacity, 1))}.text-rose-200{--tw-text-opacity: 1;color:rgb(254 205 211 / var(--tw-text-opacity, 1))}.text-rose-600{--tw-text-opacity: 1;color:rgb(225 29 72 / var(--tw-text-opacity, 1))}.text-rose-700{--tw-text-opacity: 1;color:rgb(190 18 60 / var(--tw-text-opacity, 1))}.text-rose-800{--tw-text-opacity: 1;color:rgb(159 18 57 / var(--tw-text-opacity, 1))}.text-sky-700{--tw-text-opacity: 1;color:rgb(3 105 161 / var(--tw-text-opacity, 1))}.text-slate-100{--tw-text-opacity: 1;color:rgb(241 245 249 / var(--tw-text-opacity, 1))}.text-slate-200{--tw-text-opacity: 1;color:rgb(226 232 240 / var(--tw-text-opacity, 1))}.text-slate-300{--tw-text-opacity: 1;color:rgb(203 213 225 / var(--tw-text-opacity, 1))}.text-slate-400{--tw-text-opacity: 1;color:rgb(148 163 184 / var(--tw-text-opacity, 1))}.text-slate-500{--tw-text-opacity: 1;color:rgb(100 116 139 / var(--tw-text-opacity, 1))}.text-slate-600{--tw-text-opacity: 1;color:rgb(71 85 105 / var(--tw-text-opacity, 1))}.text-slate-700{--tw-text-opacity: 1;color:rgb(51 65 85 / var(--tw-text-opacity, 1))}.text-slate-800{--tw-text-opacity: 1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.text-slate-900{--tw-text-opacity: 1;color:rgb(15 23 42 / var(--tw-text-opacity, 1))}.text-teal-700{--tw-text-opacity: 1;color:rgb(15 118 110 / var(--tw-text-opacity, 1))}.text-teal-900{--tw-text-opacity: 1;color:rgb(19 78 74 / var(--tw-text-opacity, 1))}.text-violet-100{--tw-text-opacity: 1;color:rgb(237 233 254 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-yellow-600{--tw-text-opacity: 1;color:rgb(202 138 4 / var(--tw-text-opacity, 1))}.text-yellow-800{--tw-text-opacity: 1;color:rgb(133 77 14 / var(--tw-text-opacity, 1))}.text-yellow-900{--tw-text-opacity: 1;color:rgb(113 63 18 / var(--tw-text-opacity, 1))}.underline{text-decoration-line:underline}.opacity-45{opacity:.45}.opacity-50{opacity:.5}.opacity-60{opacity:.6}.opacity-70{opacity:.7}.opacity-75{opacity:.75}.opacity-80{opacity:.8}.shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-2xl{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-inner{--tw-shadow: inset 0 2px 4px 0 rgb(0 0 0 / .05);--tw-shadow-colored: inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-amber-400\/40{--tw-shadow-color: rgb(251 191 36 / .4);--tw-shadow: var(--tw-shadow-colored)}.shadow-emerald-500\/40{--tw-shadow-color: rgb(16 185 129 / .4);--tw-shadow: var(--tw-shadow-colored)}.shadow-indigo-200{--tw-shadow-color: #c7d2fe;--tw-shadow: var(--tw-shadow-colored)}.shadow-rose-500\/40{--tw-shadow-color: rgb(244 63 94 / .4);--tw-shadow: var(--tw-shadow-colored)}.shadow-slate-900\/40{--tw-shadow-color: rgb(15 23 42 / .4);--tw-shadow: var(--tw-shadow-colored)}.ring-2{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-indigo-400{--tw-ring-opacity: 1;--tw-ring-color: rgb(129 140 248 / var(--tw-ring-opacity, 1))}.ring-indigo-500{--tw-ring-opacity: 1;--tw-ring-color: rgb(99 102 241 / var(--tw-ring-opacity, 1))}.ring-yellow-400{--tw-ring-opacity: 1;--tw-ring-color: rgb(250 204 21 / var(--tw-ring-opacity, 1))}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow{--tw-drop-shadow: drop-shadow(0 1px 2px rgb(0 0 0 / .1)) drop-shadow(0 1px 1px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.\!filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-sm{--tw-backdrop-blur: blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.card{border-radius:.5rem;border-width:1px;--tw-border-opacity: 1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1));--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}@media print{.card{border-radius:4px}}.btn{border-radius:.25rem;border-width:1px;--tw-border-opacity: 1;border-color:rgb(203 213 225 / var(--tw-border-opacity, 1));padding:.25rem .75rem;--tw-text-opacity: 1;color:rgb(51 65 85 / var(--tw-text-opacity, 1))}@media print{.btn{border-radius:4px}}@keyframes pulse-unmarked{0%,to{box-shadow:0 0 #9ca3afb3}50%{box-shadow:0 0 0 8px #9ca3af00}}.animate-pulse-slow{animation:pulse-unmarked 2s infinite}@media print{@page{margin:.5in;size:letter landscape}body>*:not(.seating-chart-print){display:none!important}button,.print-hide{display:none!important}.fixed.inset-0.bg-black\/50{position:static!important;background:transparent!important}.fixed.inset-0>div{max-width:100%!important;max-height:100%!important;width:100%!important;box-shadow:none!important;border:none!important;overflow:visible!important}.overflow-y-auto,.p-6{padding:0!important;overflow:visible!important}.grid{page-break-inside:avoid!important;-moz-column-break-inside:avoid!important;break-inside:avoid!important}.grid>div{page-break-inside:avoid!important;-moz-column-break-inside:avoid!important;break-inside:avoid!important;margin-bottom:10px!important}.rounded-xl,.rounded-lg,.rounded{border-radius:4px!important}.shadow-xl,.shadow-md,.shadow{box-shadow:none!important;border:1px solid #ddd!important}*,[style*=backgroundColor],[style*=background-color]{-webkit-print-color-adjust:exact!important;print-color-adjust:exact!important}.sticky{position:static!important}}.hover\:border-indigo-200:hover{--tw-border-opacity: 1;border-color:rgb(199 210 254 / var(--tw-border-opacity, 1))}.hover\:border-orange-600:hover{--tw-border-opacity: 1;border-color:rgb(234 88 12 / var(--tw-border-opacity, 1))}.hover\:border-slate-500:hover{--tw-border-opacity: 1;border-color:rgb(100 116 139 / var(--tw-border-opacity, 1))}.hover\:border-teal-400:hover{--tw-border-opacity: 1;border-color:rgb(45 212 191 / var(--tw-border-opacity, 1))}.hover\:border-teal-600:hover{--tw-border-opacity: 1;border-color:rgb(13 148 136 / var(--tw-border-opacity, 1))}.hover\:bg-amber-600:hover{--tw-bg-opacity: 1;background-color:rgb(217 119 6 / var(--tw-bg-opacity, 1))}.hover\:bg-amber-700:hover{--tw-bg-opacity: 1;background-color:rgb(180 83 9 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-100:hover{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-200:hover{--tw-bg-opacity: 1;background-color:rgb(191 219 254 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-700:hover{--tw-bg-opacity: 1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.hover\:bg-emerald-700:hover{--tw-bg-opacity: 1;background-color:rgb(4 120 87 / var(--tw-bg-opacity, 1))}.hover\:bg-emerald-800:hover{--tw-bg-opacity: 1;background-color:rgb(6 95 70 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-100:hover{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.hover\:bg-green-100:hover{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.hover\:bg-green-200:hover{--tw-bg-opacity: 1;background-color:rgb(187 247 208 / var(--tw-bg-opacity, 1))}.hover\:bg-green-50:hover{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.hover\:bg-green-600:hover{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.hover\:bg-green-700:hover{--tw-bg-opacity: 1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\:bg-indigo-100:hover{--tw-bg-opacity: 1;background-color:rgb(224 231 255 / var(--tw-bg-opacity, 1))}.hover\:bg-indigo-200:hover{--tw-bg-opacity: 1;background-color:rgb(199 210 254 / var(--tw-bg-opacity, 1))}.hover\:bg-indigo-50:hover{--tw-bg-opacity: 1;background-color:rgb(238 242 255 / var(--tw-bg-opacity, 1))}.hover\:bg-indigo-500:hover{--tw-bg-opacity: 1;background-color:rgb(99 102 241 / var(--tw-bg-opacity, 1))}.hover\:bg-indigo-700:hover{--tw-bg-opacity: 1;background-color:rgb(67 56 202 / var(--tw-bg-opacity, 1))}.hover\:bg-orange-100:hover{--tw-bg-opacity: 1;background-color:rgb(255 237 213 / var(--tw-bg-opacity, 1))}.hover\:bg-orange-200:hover{--tw-bg-opacity: 1;background-color:rgb(254 215 170 / var(--tw-bg-opacity, 1))}.hover\:bg-orange-400:hover{--tw-bg-opacity: 1;background-color:rgb(251 146 60 / var(--tw-bg-opacity, 1))}.hover\:bg-orange-50:hover{--tw-bg-opacity: 1;background-color:rgb(255 247 237 / var(--tw-bg-opacity, 1))}.hover\:bg-orange-600:hover{--tw-bg-opacity: 1;background-color:rgb(234 88 12 / var(--tw-bg-opacity, 1))}.hover\:bg-orange-700:hover{--tw-bg-opacity: 1;background-color:rgb(194 65 12 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-100:hover{--tw-bg-opacity: 1;background-color:rgb(243 232 255 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-200:hover{--tw-bg-opacity: 1;background-color:rgb(233 213 255 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-700:hover{--tw-bg-opacity: 1;background-color:rgb(126 34 206 / var(--tw-bg-opacity, 1))}.hover\:bg-red-100:hover{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.hover\:bg-red-600:hover{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.hover\:bg-rose-200:hover{--tw-bg-opacity: 1;background-color:rgb(254 205 211 / var(--tw-bg-opacity, 1))}.hover\:bg-rose-50:hover{--tw-bg-opacity: 1;background-color:rgb(255 241 242 / var(--tw-bg-opacity, 1))}.hover\:bg-rose-700:hover{--tw-bg-opacity: 1;background-color:rgb(190 18 60 / var(--tw-bg-opacity, 1))}.hover\:bg-sky-200:hover{--tw-bg-opacity: 1;background-color:rgb(186 230 253 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-100:hover{--tw-bg-opacity: 1;background-color:rgb(241 245 249 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-200:hover{--tw-bg-opacity: 1;background-color:rgb(226 232 240 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-300:hover{--tw-bg-opacity: 1;background-color:rgb(203 213 225 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-400:hover{--tw-bg-opacity: 1;background-color:rgb(148 163 184 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-50:hover{--tw-bg-opacity: 1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-600:hover{--tw-bg-opacity: 1;background-color:rgb(71 85 105 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-700:hover{--tw-bg-opacity: 1;background-color:rgb(51 65 85 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-800:hover{--tw-bg-opacity: 1;background-color:rgb(30 41 59 / var(--tw-bg-opacity, 1))}.hover\:bg-teal-700:hover{--tw-bg-opacity: 1;background-color:rgb(15 118 110 / var(--tw-bg-opacity, 1))}.hover\:bg-white:hover{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.hover\:bg-yellow-100:hover{--tw-bg-opacity: 1;background-color:rgb(254 249 195 / var(--tw-bg-opacity, 1))}.hover\:bg-yellow-200:hover{--tw-bg-opacity: 1;background-color:rgb(254 240 138 / var(--tw-bg-opacity, 1))}.hover\:bg-yellow-50:hover{--tw-bg-opacity: 1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.hover\:bg-opacity-20:hover{--tw-bg-opacity: .2}.hover\:text-blue-100:hover{--tw-text-opacity: 1;color:rgb(219 234 254 / var(--tw-text-opacity, 1))}.hover\:text-blue-800:hover{--tw-text-opacity: 1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.hover\:text-indigo-600:hover{--tw-text-opacity: 1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.hover\:text-indigo-700:hover{--tw-text-opacity: 1;color:rgb(67 56 202 / var(--tw-text-opacity, 1))}.hover\:text-purple-800:hover{--tw-text-opacity: 1;color:rgb(107 33 168 / var(--tw-text-opacity, 1))}.hover\:text-purple-900:hover{--tw-text-opacity: 1;color:rgb(88 28 135 / var(--tw-text-opacity, 1))}.hover\:text-rose-100:hover{--tw-text-opacity: 1;color:rgb(255 228 230 / var(--tw-text-opacity, 1))}.hover\:text-rose-600:hover{--tw-text-opacity: 1;color:rgb(225 29 72 / var(--tw-text-opacity, 1))}.hover\:text-rose-700:hover{--tw-text-opacity: 1;color:rgb(190 18 60 / var(--tw-text-opacity, 1))}.hover\:text-rose-800:hover{--tw-text-opacity: 1;color:rgb(159 18 57 / var(--tw-text-opacity, 1))}.hover\:text-slate-700:hover{--tw-text-opacity: 1;color:rgb(51 65 85 / var(--tw-text-opacity, 1))}.hover\:text-slate-900:hover{--tw-text-opacity: 1;color:rgb(15 23 42 / var(--tw-text-opacity, 1))}.hover\:underline:hover{text-decoration-line:underline}.hover\:opacity-100:hover{opacity:1}.hover\:opacity-70:hover{opacity:.7}.hover\:shadow-md:hover{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:brightness-110:hover{--tw-brightness: brightness(1.1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.focus\:border-green-500:focus{--tw-border-opacity: 1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.focus\:border-indigo-400:focus{--tw-border-opacity: 1;border-color:rgb(129 140 248 / var(--tw-border-opacity, 1))}.focus\:border-indigo-500:focus{--tw-border-opacity: 1;border-color:rgb(99 102 241 / var(--tw-border-opacity, 1))}.focus\:border-red-500:focus{--tw-border-opacity: 1;border-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-1:focus{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus\:ring-2:focus{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus\:ring-indigo-300:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(165 180 252 / var(--tw-ring-opacity, 1))}.disabled\:opacity-50:disabled{opacity:.5}.disabled\:opacity-60:disabled{opacity:.6}@media (min-width: 640px){.sm\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (min-width: 768px){.md\:col-span-4{grid-column:span 4 / span 4}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.md\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.md\:flex-row{flex-direction:row}.md\:items-center{align-items:center}.md\:justify-between{justify-content:space-between}.md\:text-2xl{font-size:1.5rem;line-height:2rem}}@media (min-width: 1024px){.lg\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.lg\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.lg\:grid-cols-\[220px_minmax\(0\,1fr\)_260px\]{grid-template-columns:220px minmax(0,1fr) 260px}.lg\:grid-cols-\[220px_minmax\(0\,1fr\)_360px\]{grid-template-columns:220px minmax(0,1fr) 360px}.lg\:flex-row{flex-direction:row}.lg\:items-center{align-items:center}.lg\:justify-between{justify-content:space-between}}</style>
  </head>
  <body>
    <div id="root"></div>
  </body>
  </html>
